(()=>{var e={};e.id=4195,e.ids=[4195],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},79636:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>n}),t(31655),t(9785),t(46366),t(96560);var a=t(23191),r=t(88716),d=t(37922),i=t.n(d),l=t(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let n=["",{children:["customer-portal",{children:["usage",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,31655)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/customer-portal/usage/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9785)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/customer-portal/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],c=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/customer-portal/usage/page.tsx"],x="/customer-portal/usage/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/customer-portal/usage/page",pathname:"/customer-portal/usage",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},18606:(e,s,t)=>{Promise.resolve().then(t.bind(t,4250))},4250:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>q,dynamic:()=>T,dynamicParams:()=>k});var a=t(10326),r=t(17577),d=t(48723),i=t(30660),l=t(49844),o=t(18423),n=t(62637),c=t(9997),x=t(42559),m=t(52735),p=t(8564),u=t(14958),h=t(74390),g=t(77506),j=t(31540),f=t(76464),y=t(63685),b=t(37358),N=t(66697),w=t(17069),v=t(29163),_=t(41291),C=t(45091),D=t(34041),U=t(24704),P=t(74250);!function(){var e=Error("Cannot find module '../../../../../shared/utils/operatorAuth'");throw e.code="MODULE_NOT_FOUND",e}();let T="force-dynamic",k=!0;function q(){let[e,s]=(0,r.useState)("7d"),{usage:t,loading:T}=(0,U._6)(),{toast:k}=(0,d.useToast)(),{apiBaseUrl:q}=(0,P.L)(),[O,S]=(0,r.useState)(null);if(T)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(g.Z,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading usage data..."})]})});let F=t?{upload_gb:t.upload_gb,download_gb:t.download_gb,total_gb:t.total_gb,limit_gb:t.limit_gb,days_remaining:Math.ceil((new Date(t.period_end).getTime()-new Date().getTime())/864e5)}:{upload_gb:0,download_gb:0,total_gb:0,limit_gb:1e3,days_remaining:0},G=F.limit_gb>0?F.total_gb/F.limit_gb*100:0,E=O?.dailyUsage||[],B=O?.hourlyUsage||[],M=E.length>0||B.length>0,A=async()=>{try{let s={period:{start:t?.period_start,end:t?.period_end},summary:{total_gb:F.total_gb,download_gb:F.download_gb,upload_gb:F.upload_gb,limit_gb:F.limit_gb,usage_percentage:G,days_remaining:F.days_remaining},daily_usage:E,hourly_usage:B,time_range:e},a=new URLSearchParams(window.location.search).get("token"),r=Object(function(){var e=Error("Cannot find module '../../../../../shared/utils/operatorAuth'");throw e.code="MODULE_NOT_FOUND",e}())({tokenKey:Object(function(){var e=Error("Cannot find module '../../../../../shared/utils/operatorAuth'");throw e.code="MODULE_NOT_FOUND",e}()),required:!1}),d=a||r;if(!d)throw Error("Customer session expired");let i=await fetch(`${q}/api/isp/v1/portal/customer/usage/report`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(s)});if(a&&Object(function(){var e=Error("Cannot find module '../../../../../shared/utils/operatorAuth'");throw e.code="MODULE_NOT_FOUND",e}())(a,Object(function(){var e=Error("Cannot find module '../../../../../shared/utils/operatorAuth'");throw e.code="MODULE_NOT_FOUND",e}())),!i.ok)throw Error(`Failed to generate report: ${i.statusText}`);let l=await i.blob(),o=(0,D.WU)(new Date,"yyyy-MM-dd"),n=`usage-report-${o}.pdf`,c=window.URL.createObjectURL(l),x=document.createElement("a");x.href=c,x.download=n,document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(c),k({title:"Report Downloaded",description:"Your usage report has been downloaded successfully."})}catch(e){console.error("Error downloading usage report:",e),k({title:"Download Failed",description:e instanceof Error?e.message:"Failed to download usage report",variant:"destructive"})}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Usage & Bandwidth"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Monitor your internet usage"})]}),(0,a.jsxs)(d.Button,{variant:"outline",onClick:A,children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Download Report"]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Usage"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[F.total_gb.toFixed(1)," GB"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[G.toFixed(1),"% of limit"]})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Downloaded"}),(0,a.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-500",children:[F.download_gb.toFixed(1)," GB"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"This billing period"})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Uploaded"}),(0,a.jsx)(y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-500",children:[F.upload_gb.toFixed(1)," GB"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"This billing period"})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Days Remaining"}),(0,a.jsx)(b.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:F.days_remaining}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Until next billing cycle"})]})]})]}),(O?.highestUsageDayGb||O?.usageTrendPercent!==void 0)&&(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5"}),"Usage Insights"]}),(0,a.jsx)(d.CardDescription,{children:"Trends and patterns in your data usage"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[O?.highestUsageDayGb&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Highest Usage Day"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-500",children:[O.highestUsageDayGb.toFixed(1)," GB"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:O.highestUsageDate?(0,D.WU)(new Date(O.highestUsageDate),"MMM dd, yyyy"):"N/A"})]}),O?.usageTrendPercent!==void 0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Usage Trend (7 days)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("p",{className:`text-2xl font-bold ${O.usageTrendPercent>0?"text-red-500":"text-green-500"}`,children:[O.usageTrendPercent>0?"+":"",O.usageTrendPercent.toFixed(1),"%"]}),O.usageTrendPercent>0?(0,a.jsx)(w.Z,{className:"h-5 w-5 text-red-500"}):(0,a.jsx)(v.Z,{className:"h-5 w-5 text-green-500"})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[O.usageTrendPercent>0?"Increasing":"Decreasing"," compared to prior week"]})]}),O?.overageGb!==void 0&&O.overageGb>0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Overage"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-orange-500",children:[O.overageGb.toFixed(1)," GB"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Exceeds plan limit"})]})]})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5"}),"Data Cap Usage"]}),(0,a.jsx)(d.CardDescription,{children:"Your usage against the monthly data cap"})]}),(0,a.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"font-medium",children:[F.total_gb.toFixed(1)," GB used of ",F.limit_gb," GB"]}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[G.toFixed(1),"%"]})]}),(0,a.jsx)(d.Progress,{value:G,className:"h-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Used"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[F.total_gb.toFixed(1)," GB"]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-500",children:[(F.limit_gb-F.total_gb).toFixed(1)," GB"]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Daily Average"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[(F.total_gb/(30-F.days_remaining)).toFixed(1)," GB"]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Projected"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-500",children:[(F.total_gb/(30-F.days_remaining)*30).toFixed(1)," GB"]})]})]}),G>80&&(0,a.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5 text-yellow-500 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-yellow-500",children:"Usage Alert"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["You've used ",G.toFixed(0),"% of your monthly data cap. Consider upgrading your plan if you frequently exceed your limit."]})]})]})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsx)(d.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5"}),"Usage History"]}),(0,a.jsx)(d.CardDescription,{children:"Daily bandwidth usage"})]}),(0,a.jsxs)(d.Select,{value:e,onValueChange:s,children:[(0,a.jsx)(d.SelectTrigger,{className:"w-[150px]",children:(0,a.jsx)(d.SelectValue,{})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"7d",children:"Last 7 days"}),(0,a.jsx)(d.SelectItem,{value:"30d",children:"Last 30 days"}),(0,a.jsx)(d.SelectItem,{value:"90d",children:"Last 90 days"})]})]})]})}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"h-[400px]",children:M?(0,a.jsx)(i.h,{width:"100%",height:"100%",children:(0,a.jsxs)(l.v,{data:E,children:[(0,a.jsx)(o.q,{strokeDasharray:"3 3",className:"stroke-muted"}),(0,a.jsx)(n.K,{dataKey:"date",className:"text-xs",tick:{fontSize:10}}),(0,a.jsx)(c.B,{className:"text-xs",tick:{fontSize:10}}),(0,a.jsx)(x.u,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"6px"}}),(0,a.jsx)(m.D,{}),(0,a.jsx)(p.$,{dataKey:"download",stackId:"a",fill:"hsl(217, 91%, 60%)",name:"Download (GB)"}),(0,a.jsx)(p.$,{dataKey:"upload",stackId:"a",fill:"hsl(142, 76%, 36%)",name:"Upload (GB)"})]})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[(0,a.jsx)(f.Z,{className:"h-16 w-16 text-muted-foreground/40 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Usage History Coming Soon"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground max-w-md",children:"Detailed usage history charts will be available once we implement the telemetry API endpoint."})]})})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(C.Z,{className:"h-5 w-5"}),"Today's Usage Pattern"]}),(0,a.jsx)(d.CardDescription,{children:"Bandwidth usage by hour (last 24 hours)"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"h-[300px]",children:M?(0,a.jsx)(i.h,{width:"100%",height:"100%",children:(0,a.jsxs)(u.w,{data:B,children:[(0,a.jsx)(o.q,{strokeDasharray:"3 3",className:"stroke-muted"}),(0,a.jsx)(n.K,{dataKey:"hour",className:"text-xs",tick:{fontSize:10}}),(0,a.jsx)(c.B,{className:"text-xs",tick:{fontSize:10}}),(0,a.jsx)(x.u,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"6px"}}),(0,a.jsx)(m.D,{}),(0,a.jsx)(h.x,{type:"monotone",dataKey:"download",stroke:"hsl(217, 91%, 60%)",strokeWidth:2,dot:!1,name:"Download (Mbps)"}),(0,a.jsx)(h.x,{type:"monotone",dataKey:"upload",stroke:"hsl(142, 76%, 36%)",strokeWidth:2,dot:!1,name:"Upload (Mbps)"})]})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[(0,a.jsx)(C.Z,{className:"h-16 w-16 text-muted-foreground/40 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Hourly Pattern Coming Soon"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground max-w-md",children:"Hourly usage patterns will be available once we implement the telemetry API endpoint."})]})})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsx)(d.CardHeader,{children:(0,a.jsx)(d.CardTitle,{children:"Tips to Manage Your Data Usage"})}),(0,a.jsx)(d.CardContent,{children:(0,a.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary",children:"•"}),(0,a.jsx)("span",{children:"Stream videos in standard definition instead of HD to save data"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary",children:"•"}),(0,a.jsx)("span",{children:"Download large files during off-peak hours"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary",children:"•"}),(0,a.jsx)("span",{children:"Enable auto-updates only when connected to WiFi"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary",children:"•"}),(0,a.jsx)("span",{children:"Consider upgrading to an unlimited plan if you consistently exceed your cap"})]})]})})]})]})}},74250:(e,s,t)=>{"use strict";t.d(s,{L:()=>r});var a=t(93158);function r(){let{api:e}=(0,a.M)(),s=e.baseUrl||"";return{api:e,apiBaseUrl:s,buildApiUrl:e.buildUrl}}},31655:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i,dynamic:()=>r,dynamicParams:()=>d});var a=t(68570);let r=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/customer-portal/usage/page.tsx#dynamic`),d=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/customer-portal/usage/page.tsx#dynamicParams`),i=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/customer-portal/usage/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6032,6392,4704],()=>t(79636));module.exports=a})();