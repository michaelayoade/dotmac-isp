(()=>{var e={};e.id=7011,e.ids=[7011],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},9447:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>d}),s(11306),s(13321),s(46366),s(96560);var a=s(23191),r=s(88716),i=s(37922),n=s.n(i),l=s(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let d=["",{children:["dashboard",{children:["time-tracking",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,11306)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/time-tracking/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/time-tracking/page.tsx"],x="/dashboard/time-tracking/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/time-tracking/page",pathname:"/dashboard/time-tracking",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},64467:(e,t,s)=>{Promise.resolve().then(s.bind(s,10148))},10148:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var a=s(10326),r=s(17577),i=s(48723),n=s(48998),l=s(94893),c=s(77636),d=s(21608),o=s(64471),x=s(71821),m=s(66307),u=s(69669),p=s(41291),h=s(87075),j=s(97635),g=s(58516),v=s(34041);function f({technicianId:e,activeEntry:t}){let[s,o]=(0,r.useState)(j.D6.REGULAR),[x,m]=(0,r.useState)(""),[u,p]=(0,r.useState)("0"),f=(0,h._1)(),y=(0,h.r$)(),[N,C]=(0,r.useState)(null),b=()=>new Promise((e,t)=>{if(!navigator.geolocation){t(Error("Geolocation not supported"));return}navigator.geolocation.getCurrentPosition(t=>{let s={latitude:t.coords.latitude,longitude:t.coords.longitude};C(s),e(s)},e=>{console.error("Error getting location:",e),t(e)})}),w=async()=>{try{let t=await b();await f.mutateAsync({technicianId:e,entryType:s,...x?{description:x}:{},latitude:t.latitude,longitude:t.longitude}),m("")}catch(e){console.error("Clock in failed:",e)}},k=async()=>{if(t)try{let e=await b();await y.mutateAsync({id:t.id,data:{breakDurationMinutes:parseFloat(u)||0,latitude:e.latitude,longitude:e.longitude}}),p("0")}catch(e){console.error("Clock out failed:",e)}};return(0,a.jsxs)(i.Card,{className:"border-2",children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)(i.CardTitle,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.Z,{className:"h-5 w-5"}),"Time Clock"]}),t&&(0,a.jsx)(i.Badge,{variant:"default",className:"text-lg font-mono",children:(()=>{if(!t?.clockIn)return"00:00:00";let e=new Date(t.clockIn),s=new Date,a=(0,g.y)({start:e,end:s}),r=String(a.hours||0).padStart(2,"0"),i=String(a.minutes||0).padStart(2,"0"),n=String(a.seconds||0).padStart(2,"0");return`${r}:${i}:${n}`})()})]})}),(0,a.jsx)(i.CardContent,{className:"space-y-4",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"rounded-lg bg-green-50 p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-green-900",children:"Clocked In"}),(0,a.jsx)(i.Badge,{variant:"outline",className:"bg-green-100 text-green-800 border-green-300",children:t.entryType})]}),(0,a.jsxs)("div",{className:"text-sm text-green-700",children:["Started: ",(0,v.WU)(new Date(t.clockIn),"h:mm a")]}),t.description&&(0,a.jsx)("div",{className:"text-sm text-green-700",children:t.description})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Break Duration (minutes)"}),(0,a.jsx)(i.Input,{type:"number",min:"0",value:u,onChange:e=>p(e.target.value),placeholder:"0"})]}),(0,a.jsxs)(i.Button,{className:"w-full",size:"lg",variant:"destructive",onClick:k,disabled:y.isPending,children:[(0,a.jsx)(d.Z,{className:"mr-2 h-5 w-5"}),y.isPending?"Clocking Out...":"Clock Out"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Entry Type"}),(0,a.jsxs)("select",{className:"w-full rounded-md border border-gray-300 px-3 py-2",value:s,onChange:e=>o(e.target.value),children:[(0,a.jsx)("option",{value:j.D6.REGULAR,children:"Regular"}),(0,a.jsx)("option",{value:j.D6.OVERTIME,children:"Overtime"}),(0,a.jsx)("option",{value:j.D6.TRAVEL,children:"Travel"}),(0,a.jsx)("option",{value:j.D6.TRAINING,children:"Training"}),(0,a.jsx)("option",{value:j.D6.ADMINISTRATIVE,children:"Administrative"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Description (Optional)"}),(0,a.jsx)(i.Input,{placeholder:"What are you working on?",value:x,onChange:e=>m(e.target.value)})]}),(0,a.jsxs)(i.Button,{className:"w-full",size:"lg",onClick:w,disabled:f.isPending,children:[(0,a.jsx)(l.Z,{className:"mr-2 h-5 w-5"}),f.isPending?"Clocking In...":"Clock In"]}),N&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),"Location: ",N.latitude.toFixed(4),", ",N.longitude.toFixed(4)]})]})})]})}function y({entries:e,onApprove:t,onReject:s,onSubmit:n,showActions:l=!1}){let[d,p]=(0,r.useState)(""),[h,j]=(0,r.useState)(null),g=e=>(0,a.jsx)(i.Badge,{variant:{draft:{variant:"secondary",color:"gray"},submitted:{variant:"outline",color:"blue"},approved:{variant:"default",color:"green"},rejected:{variant:"destructive",color:"red"},invoiced:{variant:"outline",color:"purple"}}[e].variant,children:e.charAt(0).toUpperCase()+e.slice(1)}),f=e=>e?`${Math.floor(e/60)}h ${e%60}m`:"—";return(0,a.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.WU)(new Date(e.clockIn),"MMM d, yyyy")}),g(e.status),(0,a.jsx)(i.Badge,{variant:"outline",children:e.entryType})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"In:"})," ",(0,v.WU)(new Date(e.clockIn),"h:mm a")]}),e.clockOut&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Out:"})," ",(0,v.WU)(new Date(e.clockOut),"h:mm a")]}),e.durationMinutes&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Duration:"})," ",f(e.durationMinutes)]}),e.totalCost&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:e.totalCost.toLocaleString()})]})]}),e.description&&(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e.description}),(e.clockInLat||e.clockOutLat)&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex gap-4",children:[e.clockInLat&&e.clockInLng&&(0,a.jsxs)("div",{children:[(0,a.jsx)(c.Z,{className:"inline h-3 w-3 mr-1"}),"In: ",e.clockInLat.toFixed(4),", ",e.clockInLng.toFixed(4)]}),e.clockOutLat&&e.clockOutLng&&(0,a.jsxs)("div",{children:[(0,a.jsx)(c.Z,{className:"inline h-3 w-3 mr-1"}),"Out: ",e.clockOutLat.toFixed(4),", ",e.clockOutLng.toFixed(4)]})]}),"rejected"===e.status&&e.rejectionReason&&(0,a.jsxs)("div",{className:"rounded-md bg-red-50 p-2 text-sm text-red-700",children:[(0,a.jsx)("strong",{children:"Rejected:"})," ",e.rejectionReason]})]}),l&&(0,a.jsxs)("div",{className:"flex gap-2",children:["draft"===e.status&&n&&(0,a.jsx)(i.Button,{size:"sm",onClick:()=>n(e.id),children:"Submit"}),"submitted"===e.status&&t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.Button,{size:"sm",variant:"default",onClick:()=>t(e.id),children:[(0,a.jsx)(m.Z,{className:"mr-1 h-4 w-4"}),"Approve"]}),(0,a.jsxs)(i.Button,{size:"sm",variant:"destructive",onClick:()=>j(e.id),children:[(0,a.jsx)(u.Z,{className:"mr-1 h-4 w-4"}),"Reject"]})]})]})]}),h===e.id&&(0,a.jsxs)("div",{className:"mt-3 space-y-2 border-t pt-3",children:[(0,a.jsx)(i.Input,{placeholder:"Reason for rejection...",value:d,onChange:e=>p(e.target.value)}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.Button,{size:"sm",variant:"destructive",onClick:()=>{s&&d&&(s(e.id,d),j(null),p(""))},disabled:!d,children:"Confirm Rejection"}),(0,a.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>{j(null),p("")},children:"Cancel"})]})]})]})},e.id))})}function N(){let[e,t]=(0,r.useState)({dateFrom:(0,v.WU)(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd"),dateTo:(0,v.WU)(new Date,"yyyy-MM-dd")}),{user:s,isLoading:l}=Object(function(){var e=Error("Cannot find module '@shared/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(),c=s?.technician_id??null,d=(0,r.useMemo)(()=>{if(c)return{...e,technicianId:c}},[e,c]),{data:o,isLoading:u,isError:j}=(0,h.cs)(d,{enabled:!!d}),g=(0,h.YN)(),N=(0,h.Cm)(),C=(0,h.v8)(),b=o?.entries||[],w=b.find(e=>e.isActive),k={totalHours:b.reduce((e,t)=>e+(t.totalHours||0),0),totalCost:b.reduce((e,t)=>e+(t.totalCost||0),0),submitted:b.filter(e=>"submitted"===e.status).length,approved:b.filter(e=>"approved"===e.status).length},D=async e=>{await g.mutateAsync(e)},P=async e=>{await N.mutateAsync(e)},I=async(e,t)=>{await C.mutateAsync({id:e,reason:t})};return l?(0,a.jsx)("div",{className:"container mx-auto py-8",children:(0,a.jsx)(i.Card,{children:(0,a.jsx)(i.CardContent,{className:"py-12 text-center text-gray-500",children:"Loading time tracking…"})})}):c?(0,a.jsxs)("div",{className:"container mx-auto py-8 space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Time Tracking"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Track your work hours and manage timesheets"})]})}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsx)(i.Card,{children:(0,a.jsx)(i.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Hours"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:k.totalHours.toFixed(1)})]}),(0,a.jsx)(n.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,a.jsx)(i.Card,{children:(0,a.jsx)(i.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Cost"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["₦",k.totalCost.toLocaleString()]})]}),(0,a.jsx)(x.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(i.Card,{children:(0,a.jsx)(i.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Submitted"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:k.submitted})]}),(0,a.jsx)(p.Z,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,a.jsx)(i.Card,{children:(0,a.jsx)(i.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:k.approved})]}),(0,a.jsx)(m.Z,{className:"h-8 w-8 text-green-500"})]})})})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)(f,{technicianId:c,activeEntry:w})}),(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsx)(i.CardTitle,{children:"Time Entries"})}),(0,a.jsx)(i.CardContent,{children:u?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):j?(0,a.jsx)("div",{className:"text-center py-8 text-red-500",children:"Error loading time entries"}):0===b.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No time entries found"}):(0,a.jsx)(y,{entries:b,onSubmit:D,onApprove:P,onReject:I,showActions:!0})})]})})]})]}):(0,a.jsx)("div",{className:"container mx-auto py-8 space-y-4",children:(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsx)(i.CardTitle,{children:"Technician Profile Required"})}),(0,a.jsx)(i.CardContent,{className:"text-gray-600 space-y-2",children:(0,a.jsx)("p",{children:"We couldn't find a technician profile for your account. Contact an administrator to link your user before using the time tracking tools."})})]})})}!function(){var e=Error("Cannot find module '@shared/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}()},11306:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/time-tracking/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[2793,1009,6226,657,6032,4218,7075],()=>s(9447));module.exports=a})();