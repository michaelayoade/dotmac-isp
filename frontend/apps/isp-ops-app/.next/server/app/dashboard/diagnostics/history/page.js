(()=>{var e={};e.id=4382,e.ids=[4382],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},25242:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>o,routeModule:()=>h,tree:()=>d}),t(31052),t(13321),t(46366),t(96560);var r=t(23191),a=t(88716),l=t(37922),i=t.n(l),n=t(95231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["dashboard",{children:["diagnostics",{children:["history",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,31052)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/diagnostics/history/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/diagnostics/history/page.tsx"],u="/dashboard/diagnostics/history/page",x={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/diagnostics/history/page",pathname:"/dashboard/diagnostics/history",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},96590:(e,s,t)=>{Promise.resolve().then(t.bind(t,1815))},1815:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>D});var r,a,l,i=t(10326),n=t(17577),c=t(48324),d=t(48723),o=t(20892),u=t(93158),x=t(48998),h=t(77506),m=t(30361),p=t(69669),j=t(41291),g=t(18019),b=t(50949),f=t(61056),C=t(21405),v=t(66697),N=t(17069),T=t(88307),_=t(12714),S=t(11890),y=t(39183),w=t(90434),I=t(34041);(function(e){e.CONNECTIVITY_CHECK="connectivity_check",e.PING_TEST="ping_test",e.TRACEROUTE="traceroute",e.RADIUS_SESSION="radius_session",e.ONU_STATUS="onu_status",e.CPE_STATUS="cpe_status",e.IP_VERIFICATION="ip_verification",e.BANDWIDTH_TEST="bandwidth_test",e.LATENCY_TEST="latency_test",e.PACKET_LOSS_TEST="packet_loss_test",e.CPE_RESTART="cpe_restart",e.ONU_REBOOT="onu_reboot",e.HEALTH_CHECK="health_check",e.SERVICE_PATH_TRACE="service_path_trace"})(r||(r={})),function(e){e.PENDING="pending",e.RUNNING="running",e.COMPLETED="completed",e.FAILED="failed",e.TIMEOUT="timeout"}(a||(a={})),function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error",e.CRITICAL="critical"}(l||(l={}));let P=e=>{let s={pending:{icon:x.Z,color:"bg-yellow-100 text-yellow-800",label:"Pending"},running:{icon:h.Z,color:"bg-blue-100 text-blue-800",label:"Running"},completed:{icon:m.Z,color:"bg-green-100 text-green-800",label:"Completed"},failed:{icon:p.Z,color:"bg-red-100 text-red-800",label:"Failed"},timeout:{icon:j.Z,color:"bg-orange-100 text-orange-800",label:"Timeout"}},t=s[e]||s.pending,r=t.icon;return(0,i.jsxs)(d.Badge,{className:t.color,children:[(0,i.jsx)(r,{className:`h-3 w-3 mr-1 ${"running"===e?"animate-spin":""}`}),t.label]})},E=e=>{if(!e)return null;let s={info:{icon:g.Z,color:"bg-blue-100 text-blue-800",label:"Info"},warning:{icon:b.Z,color:"bg-yellow-100 text-yellow-800",label:"Warning"},error:{icon:p.Z,color:"bg-red-100 text-red-800",label:"Error"},critical:{icon:f.Z,color:"bg-red-600 text-white",label:"Critical"}}[e];if(!s)return null;let t=s.icon;return(0,i.jsxs)(d.Badge,{className:s.color,children:[(0,i.jsx)(t,{className:"h-3 w-3 mr-1"}),s.label]})},R=e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());function A(){let[e,s]=(0,n.useState)(""),[t,r]=(0,n.useState)("all"),[a,l]=(0,n.useState)("all"),[o,m]=(0,n.useState)(0),[p,j]=(0,n.useState)(""),g=50*o,{api:b}=(0,u.M)(),f=b.baseUrl,{data:A,isLoading:D}=(0,c.a)({queryKey:["diagnostics-history",f,e,t,a,g],queryFn:async()=>{let s=new URLSearchParams;e&&s.append("subscriber_id",e),"all"!==t&&s.append("diagnostic_type",t),"all"!==a&&s.append("status",a),s.append("limit","50"),s.append("offset",g.toString());let r=await fetch(`${f}/api/v1/diagnostics/runs?${s.toString()}`,{credentials:"include"});if(!r.ok)throw Error("Failed to fetch diagnostic runs");return r.json()},refetchInterval:15e3}),q=A?.items||[],H=A?.total||0,U=Math.ceil(H/50),Z={total:q.length,running:q.filter(e=>"running"===e.status||"pending"===e.status).length,successRate:q.length>0?Math.round(q.filter(e=>e.success).length/q.length*100):0,avgDuration:q.length>0?Math.round(q.reduce((e,s)=>e+(s.duration_ms||0),0)/q.length):0},k=()=>{s(p),m(0)};return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:"Diagnostic History"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"View and analyze all diagnostic runs across subscribers"})]}),(0,i.jsxs)(d.Button,{variant:"outline",children:[(0,i.jsx)(C.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,i.jsxs)(d.Card,{children:[(0,i.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Runs"}),(0,i.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,i.jsxs)(d.CardContent,{children:[(0,i.jsx)("div",{className:"text-2xl font-bold",children:H}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"All diagnostic runs"})]})]}),(0,i.jsxs)(d.Card,{children:[(0,i.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Running Count"}),(0,i.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground animate-spin"})]}),(0,i.jsxs)(d.CardContent,{children:[(0,i.jsx)("div",{className:"text-2xl font-bold",children:Z.running}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently running or pending"})]})]}),(0,i.jsxs)(d.Card,{children:[(0,i.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Success Rate"}),(0,i.jsx)(N.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,i.jsxs)(d.CardContent,{children:[(0,i.jsxs)("div",{className:"text-2xl font-bold",children:[Z.successRate,"%"]}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Successful completions"})]})]}),(0,i.jsxs)(d.Card,{children:[(0,i.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Average Duration"}),(0,i.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,i.jsxs)(d.CardContent,{children:[(0,i.jsxs)("div",{className:"text-2xl font-bold",children:[Z.avgDuration,"ms"]}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per diagnostic run"})]})]})]}),(0,i.jsxs)(d.Card,{children:[(0,i.jsx)(d.CardHeader,{children:(0,i.jsx)(d.CardTitle,{children:"Filters"})}),(0,i.jsxs)(d.CardContent,{children:[(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,i.jsxs)("div",{className:"relative md:col-span-2",children:[(0,i.jsx)(T.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,i.jsx)(d.Input,{placeholder:"Search by Subscriber ID...",value:p,onChange:e=>j(e.target.value),onKeyDown:e=>{"Enter"===e.key&&k()},className:"pl-10"})]}),(0,i.jsxs)(d.Select,{value:t,onValueChange:r,children:[(0,i.jsx)(d.SelectTrigger,{children:(0,i.jsx)(d.SelectValue,{placeholder:"All Types"})}),(0,i.jsxs)(d.SelectContent,{children:[(0,i.jsx)(d.SelectItem,{value:"all",children:"All Types"}),(0,i.jsx)(d.SelectItem,{value:"connectivity_check",children:"Connectivity Check"}),(0,i.jsx)(d.SelectItem,{value:"radius_session",children:"RADIUS Session"}),(0,i.jsx)(d.SelectItem,{value:"onu_status",children:"ONU Status"}),(0,i.jsx)(d.SelectItem,{value:"cpe_status",children:"CPE Status"}),(0,i.jsx)(d.SelectItem,{value:"ip_verification",children:"IP Verification"}),(0,i.jsx)(d.SelectItem,{value:"health_check",children:"Health Check"}),(0,i.jsx)(d.SelectItem,{value:"cpe_restart",children:"CPE Restart"}),(0,i.jsx)(d.SelectItem,{value:"ping_test",children:"Ping Test"}),(0,i.jsx)(d.SelectItem,{value:"traceroute",children:"Traceroute"}),(0,i.jsx)(d.SelectItem,{value:"bandwidth_test",children:"Bandwidth Test"}),(0,i.jsx)(d.SelectItem,{value:"latency_test",children:"Latency Test"}),(0,i.jsx)(d.SelectItem,{value:"packet_loss_test",children:"Packet Loss Test"})]})]}),(0,i.jsxs)(d.Select,{value:a,onValueChange:l,children:[(0,i.jsx)(d.SelectTrigger,{children:(0,i.jsx)(d.SelectValue,{placeholder:"All Statuses"})}),(0,i.jsxs)(d.SelectContent,{children:[(0,i.jsx)(d.SelectItem,{value:"all",children:"All Statuses"}),(0,i.jsx)(d.SelectItem,{value:"pending",children:"Pending"}),(0,i.jsx)(d.SelectItem,{value:"running",children:"Running"}),(0,i.jsx)(d.SelectItem,{value:"completed",children:"Completed"}),(0,i.jsx)(d.SelectItem,{value:"failed",children:"Failed"}),(0,i.jsx)(d.SelectItem,{value:"timeout",children:"Timeout"})]})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,i.jsxs)(d.Button,{onClick:k,children:[(0,i.jsx)(T.Z,{className:"h-4 w-4 mr-2"}),"Search"]}),(0,i.jsx)(d.Button,{variant:"outline",onClick:()=>{s(""),r("all"),l("all"),j(""),m(0)},children:"Clear Filters"})]})]})]}),(0,i.jsxs)(d.Card,{children:[(0,i.jsx)(d.CardHeader,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)(d.CardTitle,{children:["Diagnostic Runs (",H,")"]}),(0,i.jsx)(d.CardDescription,{children:"Recent diagnostic executions"})]}),(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",o+1," of ",U||1]})]})}),(0,i.jsx)(d.CardContent,{children:D?(0,i.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,i.jsx)(h.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===q.length?(0,i.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No diagnostic runs found"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)(d.Table,{children:[(0,i.jsx)(d.TableHeader,{children:(0,i.jsxs)(d.TableRow,{children:[(0,i.jsx)(d.TableHead,{children:"Run ID"}),(0,i.jsx)(d.TableHead,{children:"Type"}),(0,i.jsx)(d.TableHead,{children:"Subscriber ID"}),(0,i.jsx)(d.TableHead,{children:"Status"}),(0,i.jsx)(d.TableHead,{children:"Severity"}),(0,i.jsx)(d.TableHead,{children:"Duration"}),(0,i.jsx)(d.TableHead,{children:"Created At"}),(0,i.jsx)(d.TableHead,{children:"Actions"})]})}),(0,i.jsx)(d.TableBody,{children:q.map(e=>(0,i.jsxs)(d.TableRow,{children:[(0,i.jsx)(d.TableCell,{className:"font-mono text-xs",children:e.id.substring(0,8)}),(0,i.jsx)(d.TableCell,{className:"font-medium",children:R(e.diagnostic_type)}),(0,i.jsx)(d.TableCell,{children:e.subscriber_id?(0,i.jsx)(w.default,{href:`/dashboard/diagnostics/subscriber/${e.subscriber_id}`,className:"font-mono text-xs text-blue-600 hover:underline",children:e.subscriber_id}):(0,i.jsx)("span",{className:"text-muted-foreground",children:"N/A"})}),(0,i.jsx)(d.TableCell,{children:P(e.status)}),(0,i.jsx)(d.TableCell,{children:E(e.severity)}),(0,i.jsx)(d.TableCell,{children:e.duration_ms?`${e.duration_ms}ms`:"N/A"}),(0,i.jsx)(d.TableCell,{children:(0,i.jsx)("div",{className:"text-sm",children:(0,I.WU)(new Date(e.created_at),"PPp")})}),(0,i.jsx)(d.TableCell,{children:(0,i.jsx)(d.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,i.jsxs)(w.default,{href:`/dashboard/diagnostics/runs/${e.id}`,children:[(0,i.jsx)(_.Z,{className:"h-4 w-4 mr-2"}),"View"]})})})]},e.id))})]})}),(0,i.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",g+1," to ",Math.min(g+50,H)," of ",H," results"]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>m(e=>Math.max(0,e-1)),disabled:0===o,children:[(0,i.jsx)(S.Z,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,i.jsxs)("div",{className:"text-sm",children:["Page ",o+1," of ",U||1]}),(0,i.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:()=>m(e=>Math.min(U-1,e+1)),disabled:o>=U-1,children:["Next",(0,i.jsx)(y.Z,{className:"h-4 w-4 ml-1"})]})]})]})]})})]})]})}function D(){return(0,i.jsx)(o.eu,{permission:"isp.diagnostics.read",children:(0,i.jsx)(A,{})})}},31052:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/diagnostics/history/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(25242));module.exports=r})();