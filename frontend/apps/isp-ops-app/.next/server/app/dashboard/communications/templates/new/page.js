(()=>{var e={};e.id=883,e.ids=[883],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},38346:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>o,routeModule:()=>h,tree:()=>d}),t(35531),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),l=t(37922),i=t.n(l),n=t(95231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["dashboard",{children:["communications",{children:["templates",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,35531)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/communications/templates/new/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/communications/templates/new/page.tsx"],m="/dashboard/communications/templates/new/page",p={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/communications/templates/new/page",pathname:"/dashboard/communications/templates/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7618:(e,s,t)=>{Promise.resolve().then(t.bind(t,18396))},18396:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var a=t(10326),r=t(17577),l=t(35047),i=t(90434),n=t(16996),c=t(48723),d=t(86333),o=t(94019),m=t(83855),p=t(77506),h=t(31215),x=t(82671);function u(){let e=(0,l.useRouter)(),{toast:s}=(0,c.useToast)(),t=(0,n.eD)(),[u,j]=(0,r.useState)({name:"",channel:x.FB.EMAIL,is_active:!0}),[b,g]=(0,r.useState)([]),[v,y]=(0,r.useState)({}),[f,C]=(0,r.useState)(!1),[N,S]=(0,r.useState)([]),T=()=>{let e={};return u.name&&0!==u.name.trim().length||(e.name="Template name is required"),u.channel!==x.FB.EMAIL||u.subject&&0!==u.subject.trim().length||(e.subject="Subject is required for email templates"),u.body_text||u.body_html||(e.body_text="Template body is required"),y(e),0===Object.keys(e).length},_=e=>{let s={name:e||"",type:x.Lq.STRING,required:!1};g(e=>[...e,s])},q=e=>{g(s=>s.filter((s,t)=>t!==e))},w=(e,s,t)=>{g(a=>a.map((a,r)=>r===e?{...a,[s]:t}:a))},P=async a=>{if(a.preventDefault(),!T()){s({title:"Validation Error",description:"Please fix the errors in the form",variant:"destructive"});return}let r={...u,variables:b.filter(e=>e.name.trim().length>0)};t.mutate(r,{onSuccess:t=>{s({title:"Template Created",description:`Template "${t.name}" has been created successfully`}),e.push(`/dashboard/communications/templates/${t.id}`)},onError:e=>{s({title:"Creation Failed",description:e.response?.data?.detail||"Failed to create template",variant:"destructive"})}})},L=(e,s)=>{j(t=>({...t,[e]:s})),v[e]&&y(s=>{let t={...s};return delete t[e],t})};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,a.jsx)(i.default,{href:"/dashboard/communications/templates",children:(0,a.jsxs)(c.Button,{variant:"ghost",size:"sm",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Back to Templates"]})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Create Template"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Create a reusable communication template"})]})}),(0,a.jsx)("form",{onSubmit:P,children:(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{children:[(0,a.jsx)(c.CardTitle,{children:"Template Information"}),(0,a.jsx)(c.CardDescription,{children:"Basic template details"})]}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(c.Label,{htmlFor:"name",children:["Template Name ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(c.Input,{id:"name",value:u.name,onChange:e=>L("name",e.target.value),placeholder:"e.g., Welcome Email"}),v.name&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:v.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"description",children:"Description"}),(0,a.jsx)(c.Textarea,{id:"description",value:u.description||"",onChange:e=>L("description",e.target.value),placeholder:"What is this template for?",rows:2})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"channel",children:"Channel"}),(0,a.jsxs)(c.Select,{value:u.channel,onValueChange:e=>L("channel",e),children:[(0,a.jsx)(c.SelectTrigger,{id:"channel",children:(0,a.jsx)(c.SelectValue,{})}),(0,a.jsxs)(c.SelectContent,{children:[(0,a.jsx)(c.SelectItem,{value:x.FB.EMAIL,children:"Email"}),(0,a.jsx)(c.SelectItem,{value:x.FB.SMS,children:"SMS"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"is_active",children:"Status"}),(0,a.jsxs)(c.Select,{value:u.is_active?"active":"inactive",onValueChange:e=>L("is_active","active"===e),children:[(0,a.jsx)(c.SelectTrigger,{id:"is_active",children:(0,a.jsx)(c.SelectValue,{})}),(0,a.jsxs)(c.SelectContent,{children:[(0,a.jsx)(c.SelectItem,{value:"active",children:"Active"}),(0,a.jsx)(c.SelectItem,{value:"inactive",children:"Inactive"})]})]})]})]})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{children:[(0,a.jsx)(c.CardTitle,{children:"Template Content"}),(0,a.jsxs)(c.CardDescription,{children:["Use ","{{ variable_name }}"," for dynamic content"]})]}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[u.channel===x.FB.EMAIL&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(c.Label,{htmlFor:"subject",children:["Subject ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(c.Input,{id:"subject",value:u.subject||"",onChange:e=>L("subject",e.target.value),placeholder:"Email subject with {{ variables }}"}),v.subject&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:v.subject})]}),(0,a.jsxs)(c.Tabs,{defaultValue:"text",children:[(0,a.jsxs)(c.TabsList,{children:[(0,a.jsx)(c.TabsTrigger,{value:"text",children:"Plain Text"}),(0,a.jsx)(c.TabsTrigger,{value:"html",children:"HTML"})]}),(0,a.jsxs)(c.TabsContent,{value:"text",className:"space-y-2",children:[(0,a.jsxs)(c.Label,{htmlFor:"body_text",children:["Text Body ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(c.Textarea,{id:"body_text",value:u.body_text||"",onChange:e=>L("body_text",e.target.value),placeholder:"Hello {{ name }}, welcome to our service!",rows:12}),v.body_text&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:v.body_text})]}),(0,a.jsxs)(c.TabsContent,{value:"html",className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"body_html",children:"HTML Body"}),(0,a.jsx)(c.Textarea,{id:"body_html",value:u.body_html||"",onChange:e=>L("body_html",e.target.value),placeholder:"<html><body>Hello {{ name }}</body></html>",rows:12,className:"font-mono text-sm"})]})]}),(0,a.jsx)(c.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=[...new Set([...(0,x.cA)(u.body_text||""),...(0,x.cA)(u.body_html||""),...(0,x.cA)(u.subject||"")])];S(e),e.forEach(e=>{b.find(s=>s.name===e)||_(e)})},children:"Detect Variables"}),N.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:N.map(e=>(0,a.jsx)(c.Badge,{variant:"secondary",children:e},e))})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{children:[(0,a.jsx)(c.CardTitle,{children:"Template Variables"}),(0,a.jsx)(c.CardDescription,{children:"Define variables that can be used in the template"})]}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[b.map((e,s)=>(0,a.jsxs)("div",{className:"flex gap-3 items-start p-3 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex-1 grid gap-3 md:grid-cols-3",children:[(0,a.jsx)(c.Input,{placeholder:"Variable name",value:e.name,onChange:e=>w(s,"name",e.target.value)}),(0,a.jsxs)(c.Select,{value:e.type,onValueChange:e=>w(s,"type",e),children:[(0,a.jsx)(c.SelectTrigger,{children:(0,a.jsx)(c.SelectValue,{})}),(0,a.jsxs)(c.SelectContent,{children:[(0,a.jsx)(c.SelectItem,{value:x.Lq.STRING,children:"String"}),(0,a.jsx)(c.SelectItem,{value:x.Lq.NUMBER,children:"Number"}),(0,a.jsx)(c.SelectItem,{value:x.Lq.DATE,children:"Date"}),(0,a.jsx)(c.SelectItem,{value:x.Lq.EMAIL,children:"Email"}),(0,a.jsx)(c.SelectItem,{value:x.Lq.URL,children:"URL"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.required||!1,onChange:e=>w(s,"required",e.target.checked),className:"h-4 w-4 rounded border-gray-300"}),(0,a.jsx)("span",{className:"text-sm",children:"Required"})]})]}),(0,a.jsx)(c.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>q(s),children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})]},s)),(0,a.jsxs)(c.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>_(),children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(c.Button,{type:"submit",disabled:t.isPending,children:t.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Create Template"]})}),(0,a.jsx)(i.default,{href:"/dashboard/communications/templates",children:(0,a.jsx)(c.Button,{type:"button",variant:"outline",children:"Cancel"})})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Variable Syntax"})}),(0,a.jsxs)(c.CardContent,{className:"space-y-2 text-sm",children:[(0,a.jsx)("p",{children:"Use Jinja2 template syntax:"}),(0,a.jsx)("code",{className:"block bg-muted p-2 rounded text-xs",children:"{{ variable_name }}"}),(0,a.jsx)("p",{className:"pt-2",children:"Examples:"}),(0,a.jsxs)("ul",{className:"space-y-1 text-xs text-muted-foreground",children:[(0,a.jsxs)("li",{children:["• ","{{ name }}"," - User name"]}),(0,a.jsxs)("li",{children:["• ","{{ email }}"," - Email address"]}),(0,a.jsxs)("li",{children:["• ","{{ company }}"," - Company name"]}),(0,a.jsxs)("li",{children:["• ","{{ url }}"," - Custom URL"]})]})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Best Practices"})}),(0,a.jsxs)(c.CardContent,{className:"space-y-2 text-sm text-muted-foreground",children:[(0,a.jsx)("p",{children:"• Use clear, descriptive variable names"}),(0,a.jsx)("p",{children:"• Test templates before activating"}),(0,a.jsx)("p",{children:"• Keep subject lines concise"}),(0,a.jsx)("p",{children:"• Provide both text and HTML versions"}),(0,a.jsx)("p",{children:"• Mark required variables"})]})]})]})]})})]})}},35531:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/communications/templates/new/page.tsx#default`)}};var s=require("../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218,6996],()=>t(38346));module.exports=a})();