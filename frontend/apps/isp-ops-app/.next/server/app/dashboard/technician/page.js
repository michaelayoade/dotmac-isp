(()=>{var e={};e.id=6275,e.ids=[6275],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},22192:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>d}),t(15593),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),n=t(37922),i=t.n(n),l=t(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let d=["",{children:["dashboard",{children:["technician",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,15593)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/technician/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/technician/page.tsx"],m="/dashboard/technician/page",x={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/technician/page",pathname:"/dashboard/technician",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2081:(e,s,t)=>{Promise.resolve().then(t.bind(t,17607))},17607:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(10326),r=t(17577),n=t(48723),i=t(48998),l=t(94893),c=t(21608),d=t(77636),o=t(87650),m=t(66307),x=t(48705),p=t(81536),h=t(41291),u=t(87075),g=t(97635),j=t(34041),f=t(94629);function y({entry:e,onClockIn:s,onClockOut:t}){let[d,o]=(0,r.useState)("00:00:00");return(0,a.jsxs)(n.Card,{className:"border-2 border-blue-500",children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.Z,{className:"h-5 w-5"}),"Time Clock"]}),e&&(0,a.jsx)(n.Badge,{variant:"default",className:"text-lg font-mono bg-blue-600",children:d})]})}),(0,a.jsx)(n.CardContent,{children:e?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"rounded-lg bg-green-50 p-3",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-green-900",children:["Clocked in at ",(0,j.WU)((0,f.D)(e.clockIn),"h:mm a")]}),e.description&&(0,a.jsx)("div",{className:"text-sm text-green-700 mt-1",children:e.description})]}),(0,a.jsxs)(n.Button,{className:"w-full",size:"lg",variant:"destructive",onClick:t,children:[(0,a.jsx)(c.Z,{className:"mr-2 h-5 w-5"}),"Clock Out"]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Ready to start your shift?"}),(0,a.jsxs)(n.Button,{className:"w-full",size:"lg",onClick:s,children:[(0,a.jsx)(l.Z,{className:"mr-2 h-5 w-5"}),"Clock In"]})]})})]})}function N({assignments:e,onStartTask:s,onCompleteTask:t}){let r=new Date,c=e=>{let s=(0,f.D)(e.scheduledStart),t=(0,f.D)(e.scheduledEnd);return"completed"===e.status?"completed":"in_progress"===e.status?"in_progress":"cancelled"===e.status?"cancelled":r>t?"overdue":r>=s&&r<=t?"current":"upcoming"},x=e=>{let s={completed:{className:"bg-green-100 text-green-800",label:"Completed"},in_progress:{className:"bg-blue-100 text-blue-800",label:"In Progress"},cancelled:{className:"bg-gray-100 text-gray-800",label:"Cancelled"},overdue:{className:"bg-red-100 text-red-800",label:"Overdue"},current:{className:"bg-yellow-100 text-yellow-800",label:"Current"},upcoming:{className:"bg-gray-100 text-gray-600",label:"Upcoming"}}[e];if(!s)return null;let{className:t,label:r}=s;return(0,a.jsx)(n.Badge,{className:t,children:r})},p=(e,s,t)=>{e&&s?window.open(`https://www.google.com/maps/dir/?api=1&destination=${e},${s}`,"_blank"):t&&window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(t)}`,"_blank")};return(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsx)(n.CardTitle,{children:"Today's Schedule"})}),(0,a.jsx)(n.CardContent,{children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No tasks scheduled for today"}):(0,a.jsx)("div",{className:"space-y-3",children:e.map(e=>{let r=c(e);return(0,a.jsx)(n.Card,{className:"current"===r?"border-2 border-blue-500":"",children:(0,a.jsx)(n.CardContent,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.task?.name||`Task ${e.taskId.slice(0,8)}`}),x(r)]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,j.WU)((0,f.D)(e.scheduledStart),"h:mm a")," -"," ",(0,j.WU)((0,f.D)(e.scheduledEnd),"h:mm a")]}),e.taskLocationAddress&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate max-w-[200px]",children:e.taskLocationAddress})]})]}),e.task?.description&&(0,a.jsx)("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:e.task.description})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(e.taskLocationLat||e.taskLocationAddress)&&(0,a.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>p(e.taskLocationLat,e.taskLocationLng,e.taskLocationAddress),children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})}),"current"===r&&"in_progress"!==e.status&&(0,a.jsxs)(n.Button,{size:"sm",variant:"default",onClick:()=>s(e.id),children:[(0,a.jsx)(l.Z,{className:"mr-1 h-4 w-4"}),"Start"]}),"in_progress"===e.status&&(0,a.jsxs)(n.Button,{size:"sm",variant:"default",onClick:()=>t(e.id),children:[(0,a.jsx)(m.Z,{className:"mr-1 h-4 w-4"}),"Complete"]})]})]})})},e.id)})})})]})}function v({technicianId:e}){let{data:s,isLoading:t}=(0,u.XD)(e??void 0,{enabled:!!e});if(!e)return(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5"}),"Assigned Resources"]})}),(0,a.jsx)(n.CardContent,{children:(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Sign in with a technician account to view assigned equipment."})})]});let r=s?.filter(e=>!e.returnedAt)||[];return(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5"}),"Assigned Resources"]})}),(0,a.jsx)(n.CardContent,{children:t?(0,a.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm",children:"Loading assignments…"}):0===r.length?(0,a.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm",children:"No resources currently assigned"}):(0,a.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"flex items-center gap-3",children:e.equipment?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.equipment.name}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:e.equipment.assetTag||e.equipment.category})]})]}):e.vehicle?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.vehicle.name}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:e.vehicle.licensePlate})]})]}):null}),e.expectedReturnAt&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Due: ",(0,j.WU)((0,f.D)(e.expectedReturnAt),"MMM d")]})]},e.id))})})]})}function b(){let{user:e,isLoading:s}=Object(function(){var e=Error("Cannot find module '@shared/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(),t=e?.technician_id??null,c=(0,r.useMemo)(()=>(0,j.WU)(new Date,"yyyy-MM-dd"),[]),{toast:d}=(0,n.useToast)(),o=(0,r.useMemo)(()=>{if(t)return{technicianId:t,dateFrom:c,dateTo:c}},[t,c]),x=(0,r.useMemo)(()=>{if(t)return{technicianId:t,dateFrom:c,dateTo:c}},[t,c]),{data:p,isLoading:f}=(0,u.wS)(o,{enabled:!!o}),{data:b,isLoading:C}=(0,u.cs)(x,{enabled:!!x}),w=(0,u._1)(),k=(0,u.r$)(),_=(0,u.KN)(),q=(0,u.js)(),P=p?.assignments||[],T=b?.entries.find(e=>e.isActive),D={totalTasks:P.length,completed:P.filter(e=>"completed"===e.status).length,inProgress:P.filter(e=>"in_progress"===e.status).length,upcoming:P.filter(e=>"scheduled"===e.status||"confirmed"===e.status).length},A=async()=>{if(!t){console.warn("Cannot clock in without an associated technician ID");return}try{await w.mutateAsync({technicianId:t,entryType:g.D6.REGULAR})}catch(e){console.error("Clock in failed:",e)}},U=async()=>{if(T)try{await k.mutateAsync({id:T.id,data:{}})}catch(e){console.error("Clock out failed:",e)}},L=async e=>{try{await _.mutateAsync({id:e}),d({title:"Task started",description:"Assignment is now in progress."})}catch(e){console.error("Failed to start task:",e),d({title:"Start failed",description:e instanceof Error?e.message:"Unable to start assignment",variant:"destructive"})}},Z=async e=>{try{await q.mutateAsync({id:e}),d({title:"Task completed",description:"Assignment marked as complete."})}catch(e){console.error("Failed to complete task:",e),d({title:"Completion failed",description:e instanceof Error?e.message:"Unable to complete assignment",variant:"destructive"})}};return s?(0,a.jsx)("div",{className:"container mx-auto py-8",children:(0,a.jsx)(n.Card,{children:(0,a.jsx)(n.CardContent,{className:"py-12 text-center text-gray-500",children:"Loading dashboard…"})})}):t?(0,a.jsxs)("div",{className:"container mx-auto py-8 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"My Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Welcome back! Here's your schedule for today."})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsx)(n.Card,{children:(0,a.jsx)(n.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Tasks"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:D.totalTasks})]}),(0,a.jsx)(i.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,a.jsx)(n.Card,{children:(0,a.jsx)(n.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"In Progress"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:D.inProgress})]}),(0,a.jsx)(l.Z,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,a.jsx)(n.Card,{children:(0,a.jsx)(n.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:D.completed})]}),(0,a.jsx)(m.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(n.Card,{children:(0,a.jsx)(n.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:D.upcoming})]}),(0,a.jsx)(h.Z,{className:"h-8 w-8 text-gray-500"})]})})})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(y,{entry:T,onClockIn:A,onClockOut:U}),(0,a.jsx)(v,{technicianId:t})]}),(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(N,{assignments:P,onStartTask:L,onCompleteTask:Z})})]})]}):(0,a.jsx)("div",{className:"container mx-auto py-8",children:(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsx)(n.CardTitle,{children:"Technician Profile Required"})}),(0,a.jsx)(n.CardContent,{className:"text-gray-600 space-y-2",children:(0,a.jsx)("p",{children:"This dashboard is available only to technician accounts. Contact your administrator to link your user profile to a technician record."})})]})})}!function(){var e=Error("Cannot find module '@shared/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}()},15593:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/technician/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218,7075],()=>t(22192));module.exports=a})();