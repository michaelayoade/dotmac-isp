(()=>{var e={};e.id=7181,e.ids=[7181],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},68058:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>r.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>o}),t(85671),t(13321),t(46366),t(96560);var a=t(23191),n=t(88716),i=t(37922),r=t.n(i),c=t(95231),l={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>c[e]);t.d(s,l);let o=["",{children:["dashboard",{children:["settings",{children:["integrations",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,85671)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/settings/integrations/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],d=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/settings/integrations/page.tsx"],u="/dashboard/settings/integrations/page",p={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/dashboard/settings/integrations/page",pathname:"/dashboard/settings/integrations",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},99157:(e,s,t)=>{Promise.resolve().then(t.bind(t,6136))},6136:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var a=t(10326),n=t(17577),i=t(48723),r=t(77506),c=t(96489),l=t(15919),o=t(88378),d=t(21405),u=t(68466),p=t(41291),h=t(66307),x=t(83855),m=t(3634),g=t(71059),j=t(94893),b=t(98091),v=t(59341);let f={listAvailablePlugins:async function(){return(await v.x1.get("/plugins/available")).data},listPluginInstances:async function(){return(await v.x1.get("/plugins/instances")).data},createPluginInstance:async function(e){return(await v.x1.post("/plugins/instances",e)).data},deletePluginInstance:async function(e){await v.x1.delete(`/plugins/instances/${e}`)},refreshPluginInstance:async function(e){await v.x1.post(`/plugins/instances/${e}/refresh`)},getStatusColor:function(e){return({active:"bg-green-500",inactive:"bg-gray-500",error:"bg-red-500",pending:"bg-yellow-500"})[e.toLowerCase()]||"bg-gray-500"}},w={listSubscriptions:async function(){return(await v.x1.get("/webhooks/subscriptions")).data},createSubscription:async function(e){return(await v.x1.post("/webhooks/subscriptions",e)).data},pauseSubscription:async function(e){await v.x1.post(`/webhooks/subscriptions/${e}/pause`)},activateSubscription:async function(e){await v.x1.post(`/webhooks/subscriptions/${e}/activate`)},deleteSubscription:async function(e){await v.x1.delete(`/webhooks/subscriptions/${e}`)},testWebhook:async function(e){await v.x1.post(`/webhooks/subscriptions/${e}/test`)},getActiveStatusColor:function(e){return e?"bg-green-500":"bg-gray-500"},formatSuccessRate:function(e){return`${(100*e).toFixed(1)}%`},needsAttention:function(e){return e.success_rate<.9},getAvailableEventTypes:function(){return["customer.created","customer.updated","subscription.created","subscription.updated","invoice.created","invoice.paid","payment.succeeded","payment.failed"]}};function y(){let{toast:e}=(0,i.useToast)(),[s,t]=(0,n.useState)(!0),[v,y]=(0,n.useState)(!1),[N,C]=(0,n.useState)([]),[k,S]=(0,n.useState)([]),[D,_]=(0,n.useState)([]),[T,P]=(0,n.useState)(null),[E,q]=(0,n.useState)(null),[I,Z]=(0,n.useState)(!1),[F,A]=(0,n.useState)(!1),[M,B]=(0,n.useState)(!1),[L,$]=(0,n.useState)(""),[H,W]=(0,n.useState)(""),[R,U]=(0,n.useState)({url:"",events:[]}),O=(0,n.useCallback)(async()=>{try{t(!0);let[e,s,a]=await Promise.all([f.listAvailablePlugins(),f.listPluginInstances(),w.listSubscriptions()]);C(e),S(s.plugins),_(a)}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to load data",variant:"destructive"})}finally{t(!1)}},[e]),G=e=>{P(e),W(`${e.name} Instance`),A(!0)},z=async()=>{if(T&&H)try{y(!0),await f.createPluginInstance({plugin_name:T.name,instance_name:H,configuration:{}}),await O(),A(!1),W(""),e({title:"Success",description:`Connected to ${T.name}`})}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to connect plugin",variant:"destructive"})}finally{y(!1)}},V=async s=>{try{y(!0),await f.deletePluginInstance(s),await O(),e({title:"Success",description:"Plugin disconnected"})}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to disconnect plugin",variant:"destructive"})}finally{y(!1)}},X=async s=>{try{y(!0),await f.refreshPluginInstance(s),await O(),e({title:"Success",description:"Plugin refreshed"})}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to refresh plugin",variant:"destructive"})}finally{y(!1)}},J=async()=>{if(R.url&&0!==R.events.length)try{y(!0),await w.createSubscription({url:R.url,event_types:R.events,is_active:!0}),await O(),B(!1),U({url:"",events:[]}),e({title:"Success",description:"Webhook created successfully"})}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to create webhook",variant:"destructive"})}finally{y(!1)}},K=async(s,t)=>{try{y(!0),t?await w.pauseSubscription(s):await w.activateSubscription(s),await O(),e({title:"Success",description:`Webhook ${t?"paused":"activated"}`})}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to toggle webhook",variant:"destructive"})}finally{y(!1)}},Q=async s=>{try{y(!0),await w.deleteSubscription(s),await O(),e({title:"Success",description:"Webhook deleted"})}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to delete webhook",variant:"destructive"})}finally{y(!1)}},Y=async s=>{try{y(!0),await w.testWebhook(s),e({title:"Success",description:"Test webhook sent"})}catch(s){e({title:"Error",description:s instanceof Error?s.message:"Failed to test webhook",variant:"destructive"})}finally{y(!1)}},ee=e=>{let s=f.getStatusColor(e);return(0,a.jsx)(i.Badge,{className:s,children:e.charAt(0).toUpperCase()+e.slice(1)})},es=e=>k.some(s=>s.plugin_name===e),et=L.toLowerCase(),ea=N.filter(e=>e.name.toLowerCase().includes(et)||(e.description?.toLowerCase()??"").includes(et));return s?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)(r.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Integrations"}),(0,a.jsx)("p",{className:"text-muted-foreground dark:text-muted-foreground mt-2",children:"Connect your favorite tools and services"})]}),(0,a.jsxs)(i.Tabs,{defaultValue:"connected",className:"space-y-4",children:[(0,a.jsxs)(i.TabsList,{children:[(0,a.jsxs)(i.TabsTrigger,{value:"connected",children:["Connected (",k.length,")"]}),(0,a.jsxs)(i.TabsTrigger,{value:"available",children:["Available (",N.length,")"]}),(0,a.jsxs)(i.TabsTrigger,{value:"webhooks",children:["Webhooks (",D.length,")"]})]}),(0,a.jsx)(i.TabsContent,{value:"connected",className:"space-y-4",children:0===k.length?(0,a.jsx)(i.Card,{children:(0,a.jsxs)(i.CardContent,{className:"text-center py-8",children:[(0,a.jsx)(c.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No integrations connected yet"}),(0,a.jsx)(i.Button,{variant:"outline",className:"mt-4",onClick:()=>document.querySelector('[value="available"]')?.click(),children:"Browse Integrations"})]})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.map(e=>(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.CardTitle,{className:"text-base",children:e.instance_name}),(0,a.jsx)(i.CardDescription,{className:"text-xs mt-1",children:e.plugin_name})]}),(0,a.jsxs)(i.DropdownMenu,{children:[(0,a.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(i.Button,{variant:"ghost",className:"h-8 w-8 p-0","aria-label":`Open actions for ${e.instance_name}`,title:`Open actions for ${e.instance_name}`,children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(i.DropdownMenuContent,{children:[(0,a.jsx)(i.DropdownMenuLabel,{children:"Actions"}),(0,a.jsxs)(i.DropdownMenuItem,{onClick:()=>{q(e),Z(!0)},children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Configure"]}),(0,a.jsxs)(i.DropdownMenuItem,{onClick:()=>X(e.id),children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,a.jsxs)(i.DropdownMenuItem,{onClick:()=>V(e.id),className:"text-red-600 dark:text-red-400",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Disconnect"]})]})]})]})}),(0,a.jsxs)(i.CardContent,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Status"}),ee(e.status)]}),e.error_message&&(0,a.jsxs)("div",{className:"flex items-start gap-2 p-2 bg-red-100 dark:bg-red-950/20 rounded-md",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 text-red-600 dark:text-red-400 mt-0.5"}),(0,a.jsx)("p",{className:"text-xs text-red-600 dark:text-red-400",children:e.error_message})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Created"}),(0,a.jsx)("span",{className:"text-sm",children:new Date(e.created_at).toLocaleDateString()})]}),e.last_health_check&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Last Check"}),(0,a.jsx)("span",{className:"text-sm",children:new Date(e.last_health_check).toLocaleString()})]})]})]},e.id))})}),(0,a.jsxs)(i.TabsContent,{value:"available",className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,a.jsx)(i.Input,{placeholder:"Search integrations...",value:L,onChange:e=>$(e.target.value),className:"pl-8"}),(0,a.jsx)(c.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:ea.map(e=>{let s=es(e.name);return(0,a.jsxs)(i.Card,{className:s?"opacity-50":"",children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,a.jsx)(c.Z,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(i.CardTitle,{className:"text-base",children:e.name}),(0,a.jsx)(i.CardDescription,{className:"text-xs mt-1",children:e.description})]})]})}),(0,a.jsx)(i.CardContent,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:e.category}),(0,a.jsx)(i.Button,{size:"sm",onClick:()=>G(e),disabled:s,children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),"Connected"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"h-3 w-3 mr-1"}),"Connect"]})})]})})]},e.name)})})]}),(0,a.jsx)(i.TabsContent,{value:"webhooks",className:"space-y-4",children:(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.CardTitle,{children:"Webhooks"}),(0,a.jsx)(i.CardDescription,{children:"Manage webhook endpoints for real-time events"})]}),(0,a.jsxs)(i.Button,{onClick:()=>B(!0),children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Add Webhook"]})]})}),(0,a.jsx)(i.CardContent,{children:0===D.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No webhooks configured"})]}):(0,a.jsxs)(i.Table,{children:[(0,a.jsx)(i.TableHeader,{children:(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableHead,{children:"Endpoint URL"}),(0,a.jsx)(i.TableHead,{children:"Events"}),(0,a.jsx)(i.TableHead,{children:"Status"}),(0,a.jsx)(i.TableHead,{children:"Success Rate"}),(0,a.jsx)(i.TableHead,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(i.TableBody,{children:D.map(e=>(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableCell,{className:"font-mono text-sm",children:e.url}),(0,a.jsx)(i.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-1 flex-wrap",children:[e.event_types.slice(0,2).map((e,s)=>(0,a.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:e},s)),e.event_types.length>2&&(0,a.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:["+",e.event_types.length-2]})]})}),(0,a.jsx)(i.TableCell,{children:(0,a.jsx)(i.Badge,{className:w.getActiveStatusColor(e.is_active),children:e.is_active?"Active":"Paused"})}),(0,a.jsx)(i.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm",children:w.formatSuccessRate(e.success_rate)}),w.needsAttention(e)&&(0,a.jsx)(p.Z,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})]})}),(0,a.jsx)(i.TableCell,{className:"text-right",children:(0,a.jsxs)(i.DropdownMenu,{children:[(0,a.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(i.Button,{variant:"ghost",className:"h-8 w-8 p-0","aria-label":`Open actions for webhook ${e.description??e.url}`,title:`Open actions for webhook ${e.description??e.url}`,children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(i.DropdownMenuContent,{children:[(0,a.jsx)(i.DropdownMenuItem,{onClick:()=>K(e.id,e.is_active),children:e.is_active?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Pause"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Activate"]})}),(0,a.jsxs)(i.DropdownMenuItem,{onClick:()=>Y(e.id),children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Test Webhook"]}),(0,a.jsxs)(i.DropdownMenuItem,{onClick:()=>Q(e.id),className:"text-red-600 dark:text-red-400",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})]},e.id))})]})})]})})]}),(0,a.jsx)(i.Dialog,{open:F,onOpenChange:A,children:(0,a.jsxs)(i.DialogContent,{children:[(0,a.jsxs)(i.DialogHeader,{children:[(0,a.jsxs)(i.DialogTitle,{children:["Connect to ",T?.name]}),(0,a.jsx)(i.DialogDescription,{children:"Create a new instance of this integration"})]}),(0,a.jsx)("div",{className:"space-y-4 py-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{htmlFor:"instance-name",children:"Instance Name"}),(0,a.jsx)(i.Input,{id:"instance-name",value:H,onChange:e=>W(e.target.value),placeholder:"e.g., My GitHub Integration"})]})}),(0,a.jsxs)(i.DialogFooter,{children:[(0,a.jsx)(i.Button,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),(0,a.jsx)(i.Button,{onClick:z,disabled:!H||v,children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):"Connect"})]})]})}),(0,a.jsx)(i.Dialog,{open:M,onOpenChange:B,children:(0,a.jsxs)(i.DialogContent,{children:[(0,a.jsxs)(i.DialogHeader,{children:[(0,a.jsx)(i.DialogTitle,{children:"Create Webhook"}),(0,a.jsx)(i.DialogDescription,{children:"Configure a new webhook endpoint"})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{htmlFor:"webhook-url",children:"Endpoint URL"}),(0,a.jsx)(i.Input,{id:"webhook-url",value:R.url,onChange:e=>U({...R,url:e.target.value}),placeholder:"https://api.example.com/webhooks"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.Label,{children:"Events"}),(0,a.jsx)("div",{className:"space-y-2",children:w.getAvailableEventTypes().map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:e,checked:R.events.includes(e),onChange:s=>{s.target.checked?U({...R,events:[...R.events,e]}):U({...R,events:R.events.filter(s=>s!==e)})},className:"rounded border-border"}),(0,a.jsx)(i.Label,{htmlFor:e,className:"text-sm font-normal",children:e})]},e))})]})]}),(0,a.jsxs)(i.DialogFooter,{children:[(0,a.jsx)(i.Button,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),(0,a.jsx)(i.Button,{onClick:J,disabled:!R.url||0===R.events.length||v,children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Webhook"})]})]})})]})}},85671:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/settings/integrations/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(68058));module.exports=a})();