(()=>{var e={};e.id=9698,e.ids=[9698],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},38685:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),a(28131),a(13321),a(46366),a(96560);var t=a(23191),r=a(88716),i=a(37922),n=a.n(i),o=a(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(s,l);let d=["",{children:["dashboard",{children:["settings",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,28131)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/settings/profile/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],c=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/settings/profile/page.tsx"],u="/dashboard/settings/profile/page",p={require:a,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/settings/profile/page",pathname:"/dashboard/settings/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},82019:(e,s,a)=>{Promise.resolve().then(a.bind(a,10497))},10497:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>k});var t=a(10326),r=a(17577),i=a(46226),n=a(48723),o=a(79635),l=a(94019),d=a(31215),c=a(51896),u=a(58038),p=a(83495),h=a(48998),m=a(71810),x=a(31540),f=a(98091),j=a(91216),g=a(12714),v=a(41291),y=a(44976),w=a(17010),b=a(48324),N=a(29771),C=a(59341);function k(){var e,s;let{toast:a}=(0,n.useToast)(),{user:k,refreshUser:E}=Object(function(){var e=Error("Cannot find module '@shared/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(),{data:F,isLoading:P}=(0,b.a)({queryKey:["auth","sessions"],queryFn:async()=>{N.k.info("Fetching active sessions");let e=await C.ZP.get("/auth/me/sessions");if(e.status<200||e.status>=300)throw Error("Failed to fetch sessions");return e.data},refetchInterval:3e4}),D=function(){let e=(0,y.NL)();return(0,w.D)({mutationFn:async e=>{N.k.info("Revoking session",{sessionId:e});let s=await C.ZP.delete(`/auth/me/sessions/${e}`);if(s.status<200||s.status>=300)throw Error("Failed to revoke session");return s.data},onSuccess:()=>{e.invalidateQueries({queryKey:["auth","sessions"]}),N.k.info("Session revoked successfully")},onError:e=>{N.k.error("Failed to revoke session",e)}})}(),S=function(){let e=(0,y.NL)();return(0,w.D)({mutationFn:async()=>{N.k.info("Revoking all sessions");let e=await C.ZP.delete("/auth/me/sessions");if(e.status<200||e.status>=300)throw Error("Failed to revoke sessions");return e.data},onSuccess:()=>{e.invalidateQueries({queryKey:["auth","sessions"]}),N.k.info("All sessions revoked successfully")},onError:e=>{N.k.error("Failed to revoke all sessions",e)}})}(),A=function(){let e=(0,y.NL)();return(0,w.D)({mutationFn:async e=>(N.k.info("Updating profile",{fields:Object.keys(e)}),(await C.ZP.patch("/auth/profile",e)).data),onSuccess:s=>{e.invalidateQueries({queryKey:["auth","me"]}),N.k.info("Profile updated successfully",{userId:s?.id})},onError:e=>{N.k.error("Failed to update profile",e)}})}(),L=(0,w.D)({mutationFn:async e=>{N.k.info("Changing password");let s=await C.ZP.post("/auth/change-password",e);if(s.status<200||s.status>=300)throw Error("Failed to change password");return s.data},onSuccess:()=>{N.k.info("Password changed successfully")},onError:e=>{N.k.error("Failed to change password",e)}}),T=function(){let e=(0,y.NL)();return(0,w.D)({mutationFn:async e=>{N.k.info("Verifying phone number");let s=await C.ZP.post("/auth/verify-phone",{phone:e});if(s.status<200||s.status>=300)throw Error("Failed to verify phone");return s.data},onSuccess:()=>{e.invalidateQueries({queryKey:["auth","me"]}),N.k.info("Phone verified successfully")},onError:e=>{N.k.error("Failed to verify phone",e)}})}(),_=(0,w.D)({mutationFn:async e=>{if("DELETE"!==e.confirmation)throw Error("Please type DELETE to confirm");N.k.warn("Deleting account");let s=await C.ZP.delete("/auth/me",{headers:{"X-Password":e.password}});if(s.status<200||s.status>=300)throw Error("Failed to delete account");return s.data},onSuccess:()=>{N.k.info("Account deleted successfully"),window.location.href="/login?deleted=true"},onError:e=>{N.k.error("Failed to delete account",e)}}),q=(0,w.D)({mutationFn:async()=>{N.k.info("Exporting user data");let e=await C.ZP.get("/auth/me/export");if(e.status<200||e.status>=300)throw Error("Failed to export data");return e.data},onSuccess:e=>{let s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download=`profile-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a),N.k.info("Profile data exported successfully")},onError:e=>{N.k.error("Failed to export data",e)}}),U=(0,w.D)({mutationFn:async e=>{N.k.info("Enabling 2FA");let s=await C.ZP.post("/auth/2fa/enable",e);if(s.status<200||s.status>=300)throw Error("Failed to enable 2FA");return s.data},onSuccess:()=>{N.k.info("2FA setup initiated successfully")},onError:e=>{N.k.error("Failed to enable 2FA",e)}}),I=function(){let e=(0,y.NL)();return(0,w.D)({mutationFn:async e=>{N.k.info("Verifying 2FA token");let s=await C.ZP.post("/auth/2fa/verify",e);if(s.status<200||s.status>=300)throw Error("Failed to verify 2FA");return s.data},onSuccess:()=>{e.invalidateQueries({queryKey:["auth","me"]}),N.k.info("2FA enabled successfully")},onError:e=>{N.k.error("Failed to verify 2FA",e)}})}(),B=function(){let e=(0,y.NL)();return(0,w.D)({mutationFn:async e=>{N.k.info("Disabling 2FA");let s=await C.ZP.post("/auth/2fa/disable",e);if(s.status<200||s.status>=300)throw Error("Failed to disable 2FA");return s.data},onSuccess:()=>{e.invalidateQueries({queryKey:["auth","me"]}),N.k.info("2FA disabled successfully")},onError:e=>{N.k.error("Failed to disable 2FA",e)}})}(),Z=function(){let e=(0,y.NL)();return(0,w.D)({mutationFn:async e=>{N.k.info("Uploading avatar",{fileName:e.name,size:e.size});let s=new FormData;return s.append("avatar",e),(await C.ZP.post("/auth/profile/avatar",s,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:()=>{e.invalidateQueries({queryKey:["auth","me"]}),N.k.info("Avatar uploaded successfully")},onError:e=>{N.k.error("Failed to upload avatar",e)}})}(),[M,O]=(0,r.useState)(!1),[z,R]=(0,r.useState)(null),[G,Q]=(0,r.useState)(null),[H,K]=(0,r.useState)(!1),[V,$]=(0,r.useState)(!1),[J,W]=(0,r.useState)(!1),[Y,X]=(0,r.useState)(!1),[ee,es]=(0,r.useState)(!1),[ea,et]=(0,r.useState)(!1),[er,ei]=(0,r.useState)(!!k?.mfa_enabled),[en,eo]=(0,r.useState)({step:"password",password:"",token:"",qrCode:"",secret:"",backupCodes:[],provisioningUri:""}),[el,ed]=(0,r.useState)({password:"",token:""}),[ec,eu]=(0,r.useState)({first_name:k?.first_name||"",last_name:k?.last_name||"",email:k?.email||"",username:k?.username||"",phone:"",location:"",timezone:"America/Los_Angeles",language:"en-US",bio:"",website:""}),[ep,eh]=(0,r.useState)({current:"",new:"",confirm:""}),em=async()=>{et(!0);try{if(N.k.info("Saving profile",{formData:ec}),z)try{await Z.mutateAsync(z),N.k.info("Avatar uploaded successfully")}catch(e){N.k.error("Failed to upload avatar",e instanceof Error?e:Error(String(e))),a({title:"Avatar upload failed",description:"Your profile was updated but the avatar upload failed. Please try again.",variant:"destructive"})}await A.mutateAsync(ec),await E(),R(null),Q(null),O(!1),a({title:"Success",description:"Profile updated successfully"})}catch(e){N.k.error("Failed to save profile",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Failed to update profile",variant:"destructive"})}finally{et(!1)}},ex=async()=>{if(ep.new!==ep.confirm){a({title:"Error",description:"New passwords do not match",variant:"destructive"});return}et(!0);try{N.k.info("Changing password"),await L.mutateAsync({current_password:ep.current,new_password:ep.new}),$(!1),eh({current:"",new:"",confirm:""}),a({title:"Success",description:"Password changed successfully"})}catch(e){N.k.error("Failed to change password",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Failed to change password",variant:"destructive"})}finally{et(!1)}},ef=async()=>{let e=en.password.trim();if(!e){a({title:"Password required",description:"Enter your current password to continue.",variant:"destructive"});return}try{let s=await U.mutateAsync({password:e});eo(a=>({...a,step:"verify",qrCode:s.qr_code,secret:s.secret,backupCodes:s.backup_codes,provisioningUri:s.provisioning_uri,token:"",password:e})),a({title:"Verification required",description:"Scan the QR code and enter the code from your authenticator app."})}catch(e){N.k.error("Failed to initiate 2FA setup",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Unable to start 2FA setup",variant:"destructive"})}},ej=async()=>{if(6!==en.token.trim().length){a({title:"Invalid code",description:"Enter the 6-digit code from your authenticator app.",variant:"destructive"});return}try{await I.mutateAsync({token:en.token.trim()}),a({title:"Success",description:"Two-factor authentication enabled"}),ei(!0),X(!1),await E()}catch(e){N.k.error("Failed to verify 2FA",e instanceof Error?e:Error(String(e))),a({title:"Verification failed",description:e instanceof Error?e.message:"Invalid verification code",variant:"destructive"})}},eg=async()=>{if(!el.password||6!==el.token.trim().length){a({title:"Incomplete form",description:"Enter your password and a valid 6-digit code.",variant:"destructive"});return}try{await B.mutateAsync({password:el.password,token:el.token.trim()}),a({title:"Success",description:"Two-factor authentication disabled"}),ei(!1),es(!1),await E()}catch(e){N.k.error("Failed to disable 2FA",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Unable to disable 2FA",variant:"destructive"})}},ev=async()=>{if(en.backupCodes.length&&"undefined"!=typeof navigator&&navigator.clipboard)try{await navigator.clipboard.writeText(en.backupCodes.join("\n")),a({title:"Copied",description:"Backup codes copied to clipboard"})}catch(e){N.k.error("Failed to copy backup codes",e instanceof Error?e:Error(String(e))),a({title:"Copy failed",description:"Unable to copy backup codes. Copy them manually instead.",variant:"destructive"})}},ey=async()=>{try{N.k.info("Verifying phone number",{phone:ec.phone}),await T.mutateAsync(ec.phone),await E(),a({title:"Success",description:"Phone number verified successfully"})}catch(e){N.k.error("Failed to verify phone",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Failed to verify phone",variant:"destructive"})}},ew=async e=>{try{await D.mutateAsync(e),a({title:"Success",description:"Session revoked successfully"})}catch(e){N.k.error("Failed to revoke session",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Failed to revoke session",variant:"destructive"})}},eb=async()=>{try{await S.mutateAsync(),a({title:"Success",description:"All other sessions revoked successfully"})}catch(e){N.k.error("Failed to revoke all sessions",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Failed to revoke sessions",variant:"destructive"})}},eN=async()=>{try{await q.mutateAsync(),a({title:"Success",description:"Profile data exported successfully"})}catch(e){N.k.error("Failed to export data",e instanceof Error?e:Error(String(e))),a({title:"Error",description:e instanceof Error?e.message:"Failed to export data",variant:"destructive"})}};return k?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Profile Settings"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2",children:"Manage your personal information and account settings"})]}),(0,t.jsxs)(n.Tabs,{defaultValue:"profile",className:"space-y-4",children:[(0,t.jsxs)(n.TabsList,{children:[(0,t.jsx)(n.TabsTrigger,{value:"profile",children:"Profile"}),(0,t.jsx)(n.TabsTrigger,{value:"security",children:"Security"}),(0,t.jsx)(n.TabsTrigger,{value:"sessions",children:"Sessions"}),(0,t.jsx)(n.TabsTrigger,{value:"privacy",children:"Privacy"})]}),(0,t.jsx)(n.TabsContent,{value:"profile",className:"space-y-4",children:(0,t.jsxs)(n.Card,{children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(n.CardTitle,{children:"Personal Information"}),(0,t.jsx)(n.CardDescription,{children:"Update your personal details and public profile"})]}),M?(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.Button,{variant:"outline",onClick:()=>{k&&eu({first_name:k.first_name||"",last_name:k.last_name||"",email:k.email||"",username:k.username||"",phone:"",location:"",timezone:"America/Los_Angeles",language:"en-US",bio:"",website:""}),R(null),Q(null),O(!1)},children:[(0,t.jsx)(l.Z,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,t.jsxs)(n.Button,{onClick:em,disabled:ea,children:[(0,t.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}):(0,t.jsxs)(n.Button,{onClick:()=>O(!0),children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})]})}),(0,t.jsxs)(n.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(n.Avatar,{className:"h-20 w-20",children:[(0,t.jsx)(n.AvatarImage,{src:G||void 0}),(0,t.jsx)(n.AvatarFallback,{children:(e=k.first_name,s=k.last_name,e&&s?`${e[0]}${s[0]}`.toUpperCase():"U")})]}),M&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("input",{type:"file",id:"avatar-upload",className:"hidden",accept:"image/jpeg,image/png,image/gif",onChange:e=>{let s=e.target.files?.[0];if(!s)return;if(!s.type.startsWith("image/")){a({title:"Invalid file",description:"Please select an image file (JPG, PNG, or GIF)",variant:"destructive"});return}if(s.size>2097152){a({title:"File too large",description:"Please select an image smaller than 2MB",variant:"destructive"});return}R(s);let t=new FileReader;t.onloadend=()=>{Q(t.result)},t.readAsDataURL(s)}}),(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>document.getElementById("avatar-upload")?.click(),type:"button",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),G?"Change Photo":"Upload Photo"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"JPG, PNG or GIF, max 2MB"})]})]}),(0,t.jsx)(n.Separator,{}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"firstName",children:"First Name"}),(0,t.jsx)(n.Input,{id:"firstName",value:ec.first_name,onChange:e=>eu({...ec,first_name:e.target.value}),disabled:!M})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"lastName",children:"Last Name"}),(0,t.jsx)(n.Input,{id:"lastName",value:ec.last_name,onChange:e=>eu({...ec,last_name:e.target.value}),disabled:!M})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"username",children:"Username"}),(0,t.jsx)(n.Input,{id:"username",value:ec.username,onChange:e=>eu({...ec,username:e.target.value}),disabled:!M})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"email",children:"Email"}),(0,t.jsx)(n.Input,{id:"email",type:"email",value:ec.email,onChange:e=>eu({...ec,email:e.target.value}),disabled:!M})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Contact Information"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"phone",children:"Phone Number"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Input,{id:"phone",type:"tel",value:ec.phone,onChange:e=>eu({...ec,phone:e.target.value}),disabled:!M,placeholder:"Enter phone number"}),M&&ec.phone&&(0,t.jsx)(n.Button,{size:"sm",variant:"outline",onClick:ey,children:"Verify"})]})]})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Additional Information"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"bio",children:"Bio"}),(0,t.jsx)(n.Textarea,{id:"bio",value:ec.bio,onChange:e=>eu({...ec,bio:e.target.value}),disabled:!M,rows:3,placeholder:"Tell us about yourself..."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"location",children:"Location"}),(0,t.jsx)(n.Input,{id:"location",value:ec.location,onChange:e=>eu({...ec,location:e.target.value}),disabled:!M,placeholder:"City, Country"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"website",children:"Website"}),(0,t.jsx)(n.Input,{id:"website",type:"url",value:ec.website,onChange:e=>eu({...ec,website:e.target.value}),disabled:!M,placeholder:"https://example.com"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"timezone",children:"Timezone"}),(0,t.jsxs)("select",{id:"timezone",value:ec.timezone,onChange:e=>eu({...ec,timezone:e.target.value}),disabled:!M,className:"h-10 w-full rounded-md border border-border bg-accent px-3 text-sm text-white",children:[(0,t.jsx)("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),(0,t.jsx)("option",{value:"America/Denver",children:"Mountain Time (MT)"}),(0,t.jsx)("option",{value:"America/Chicago",children:"Central Time (CT)"}),(0,t.jsx)("option",{value:"America/New_York",children:"Eastern Time (ET)"}),(0,t.jsx)("option",{value:"Europe/London",children:"London (GMT)"}),(0,t.jsx)("option",{value:"Europe/Paris",children:"Paris (CET)"}),(0,t.jsx)("option",{value:"Asia/Tokyo",children:"Tokyo (JST)"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"language",children:"Language"}),(0,t.jsxs)("select",{id:"language",value:ec.language,onChange:e=>eu({...ec,language:e.target.value}),disabled:!M,className:"h-10 w-full rounded-md border border-border bg-accent px-3 text-sm text-white",children:[(0,t.jsx)("option",{value:"en-US",children:"English (US)"}),(0,t.jsx)("option",{value:"en-GB",children:"English (UK)"}),(0,t.jsx)("option",{value:"es-ES",children:"Espa\xf1ol"}),(0,t.jsx)("option",{value:"fr-FR",children:"Fran\xe7ais"}),(0,t.jsx)("option",{value:"de-DE",children:"Deutsch"}),(0,t.jsx)("option",{value:"ja-JP",children:"日本語"}),(0,t.jsx)("option",{value:"zh-CN",children:"中文"})]})]})]})]})]})]})]})}),(0,t.jsxs)(n.TabsContent,{value:"security",className:"space-y-4",children:[(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Password"}),(0,t.jsx)(n.CardDescription,{children:"Manage your password and authentication settings"})]}),(0,t.jsx)(n.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Password"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Last changed 3 months ago"})]}),(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>$(!0),children:"Change Password"})]})})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Two-Factor Authentication"}),(0,t.jsx)(n.CardDescription,{children:"Add an extra layer of security to your account"})]}),(0,t.jsx)(n.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`p-2 rounded-full ${er?"bg-emerald-100 dark:bg-emerald-950/20":"bg-muted"}`,children:(0,t.jsx)(u.Z,{className:`h-5 w-5 ${er?"text-emerald-500":"text-muted-foreground"}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:er?"2FA is enabled":"2FA is not enabled"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:er?`Backup codes remaining: ${k?.mfa_backup_codes_remaining??0}`:"Secure your account with two-factor authentication"})]})]}),er?(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>{ed({password:"",token:""}),es(!0)},children:"Disable 2FA"}):(0,t.jsx)(n.Button,{onClick:()=>{eo({step:"password",password:"",token:"",qrCode:"",secret:"",backupCodes:[],provisioningUri:""}),X(!0)},children:"Enable 2FA"})]})})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Account Security"}),(0,t.jsx)(n.CardDescription,{children:"Additional security options"})]}),(0,t.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(n.Label,{children:"Login alerts"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Get notified of new sign-ins"})]}),(0,t.jsx)(n.Switch,{defaultChecked:!0})]}),(0,t.jsx)(n.Separator,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(n.Label,{children:"Require password for sensitive actions"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Ask for password when changing critical settings"})]}),(0,t.jsx)(n.Switch,{defaultChecked:!0})]})]})]})]}),(0,t.jsx)(n.TabsContent,{value:"sessions",className:"space-y-4",children:(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Active Sessions"}),(0,t.jsx)(n.CardDescription,{children:"Manage your active sessions across devices"})]}),(0,t.jsx)(n.CardContent,{className:"space-y-4",children:P?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Loading sessions..."}):F?.sessions&&F.sessions.length>0?(0,t.jsxs)(t.Fragment,{children:[F.sessions.map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-start p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-muted rounded-full",children:(0,t.jsx)(p.Z,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.user_agent||"Unknown Device"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.ip_address||"Unknown IP"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3 inline mr-1"}),"Created ",new Date(e.created_at).toLocaleString()]}),e.last_accessed&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Last active ",new Date(e.last_accessed).toLocaleString()]})]})]}),(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>ew(e.session_id),disabled:D.isPending,children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Revoke"]})]},e.session_id)),(0,t.jsx)("div",{className:"pt-4",children:(0,t.jsxs)(n.Button,{variant:"outline",className:"w-full",onClick:eb,disabled:S.isPending,children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Sign Out All Other Sessions"]})})]}):(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No active sessions found"})})]})}),(0,t.jsxs)(n.TabsContent,{value:"privacy",className:"space-y-4",children:[(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Privacy Settings"}),(0,t.jsx)(n.CardDescription,{children:"Control your privacy and data sharing preferences"})]}),(0,t.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(n.Label,{children:"Profile visibility"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Make your profile visible to others"})]}),(0,t.jsx)(n.Switch,{defaultChecked:!0})]}),(0,t.jsx)(n.Separator,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(n.Label,{children:"Show email address"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Allow others to see your email"})]}),(0,t.jsx)(n.Switch,{})]}),(0,t.jsx)(n.Separator,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(n.Label,{children:"Show activity status"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Let others see when you're online"})]}),(0,t.jsx)(n.Switch,{defaultChecked:!0})]})]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Data Management"}),(0,t.jsx)(n.CardDescription,{children:"Manage your personal data"})]}),(0,t.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Export your data"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download all your profile information"})]}),(0,t.jsxs)(n.Button,{variant:"outline",onClick:eN,children:[(0,t.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Export"]})]}),(0,t.jsx)(n.Separator,{}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-red-600 dark:text-red-400",children:"Delete account"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Permanently delete your account and data"})]}),(0,t.jsxs)(n.Button,{variant:"destructive",onClick:()=>W(!0),children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{children:"Account Information"})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"User ID"}),(0,t.jsx)("span",{className:"font-mono",children:k.id})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Email"}),(0,t.jsx)("span",{children:k.email})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Username"}),(0,t.jsx)("span",{children:k.username})]})]})})]})]})]}),(0,t.jsx)(n.Dialog,{open:V,onOpenChange:$,children:(0,t.jsxs)(n.DialogContent,{children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsx)(n.DialogTitle,{children:"Change Password"}),(0,t.jsx)(n.DialogDescription,{children:"Enter your current password and choose a new one"})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"current-password",children:"Current Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(n.Input,{id:"current-password",type:H?"text":"password",value:ep.current,onChange:e=>eh({...ep,current:e.target.value})}),(0,t.jsx)(n.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>K(!H),children:H?(0,t.jsx)(j.Z,{className:"h-4 w-4"}):(0,t.jsx)(g.Z,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"new-password",children:"New Password"}),(0,t.jsx)(n.Input,{id:"new-password",type:"password",value:ep.new,onChange:e=>eh({...ep,new:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"confirm-password",children:"Confirm New Password"}),(0,t.jsx)(n.Input,{id:"confirm-password",type:"password",value:ep.confirm,onChange:e=>eh({...ep,confirm:e.target.value})})]})]}),(0,t.jsxs)(n.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>$(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:ex,disabled:ea,children:"Change Password"})]})]})}),(0,t.jsx)(n.Dialog,{open:ee,onOpenChange:es,children:(0,t.jsxs)(n.DialogContent,{className:"max-w-md",children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsx)(n.DialogTitle,{children:"Disable Two-Factor Authentication"}),(0,t.jsx)(n.DialogDescription,{children:"Enter your password and a code from your authenticator app to disable 2FA."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"disable-2fa-password",children:"Current password"}),(0,t.jsx)(n.Input,{id:"disable-2fa-password",type:"password",placeholder:"Enter your password",autoComplete:"current-password",value:el.password,onChange:e=>ed(s=>({...s,password:e.target.value}))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"disable-2fa-token",children:"Authenticator code"}),(0,t.jsx)(n.Input,{id:"disable-2fa-token",placeholder:"000000",inputMode:"numeric",maxLength:6,value:el.token,onChange:e=>ed(s=>({...s,token:e.target.value.replace(/\D/g,"").slice(0,6)}))})]})]}),(0,t.jsxs)(n.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>es(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{variant:"destructive",onClick:eg,disabled:B.isPending||!el.password||6!==el.token.length,children:B.isPending?"Disabling…":"Disable 2FA"})]})]})}),(0,t.jsx)(n.Dialog,{open:Y,onOpenChange:X,children:(0,t.jsxs)(n.DialogContent,{className:"max-w-md",children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsx)(n.DialogTitle,{children:"password"===en.step?"Enable Two-Factor Authentication":"Verify Two-Factor Authentication"}),(0,t.jsx)(n.DialogDescription,{children:"password"===en.step?"Enter your password to generate a QR code for your authenticator app.":"Scan the QR code and enter the 6-digit code from your authenticator app."})]}),"password"===en.step?(0,t.jsx)("div",{className:"space-y-4 py-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"2fa-password",children:"Current password"}),(0,t.jsx)(n.Input,{id:"2fa-password",type:"password",placeholder:"Enter your password",autoComplete:"current-password",value:en.password,onChange:e=>eo(s=>({...s,password:e.target.value}))})]})}):(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsx)("div",{className:"bg-card p-4 rounded-lg flex justify-center",children:en.qrCode?(0,t.jsx)(i.default,{unoptimized:!0,src:en.qrCode,alt:"2FA QR code",width:192,height:192,className:"h-48 w-48"}):(0,t.jsx)("div",{className:"h-48 w-48 bg-muted rounded flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-muted-foreground",children:"QR Code unavailable"})})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{children:"Manual entry key"}),(0,t.jsx)("code",{className:"block rounded bg-muted px-3 py-2 text-sm",children:en.secret||"—"}),en.provisioningUri&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground break-all",children:en.provisioningUri}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"If you cannot scan the QR code, enter this key manually in your authenticator app."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{children:"Backup codes"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 rounded border border-border/60 bg-card/40 p-3 text-sm font-mono",children:en.backupCodes.map(e=>(0,t.jsx)("span",{children:e},e))}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:ev,children:"Copy backup codes"})}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Store these backup codes securely. They will not be shown again."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"2fa-code",children:"Verification code"}),(0,t.jsx)(n.Input,{id:"2fa-code",placeholder:"000000",inputMode:"numeric",autoComplete:"one-time-code",maxLength:6,value:en.token,onChange:e=>eo(s=>({...s,token:e.target.value.replace(/\D/g,"").slice(0,6)}))})]})]}),(0,t.jsxs)(n.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>X(!1),children:"Cancel"}),"password"===en.step?(0,t.jsx)(n.Button,{onClick:ef,disabled:!en.password||U.isPending,children:U.isPending?"Generating…":"Continue"}):(0,t.jsx)(n.Button,{onClick:ej,disabled:6!==en.token.length||I.isPending,children:I.isPending?"Enabling…":"Enable 2FA"})]})]})}),(0,t.jsx)(n.Dialog,{open:J,onOpenChange:W,children:(0,t.jsxs)(n.DialogContent,{children:[(0,t.jsxs)(n.DialogHeader,{children:[(0,t.jsx)(n.DialogTitle,{children:"Delete Account"}),(0,t.jsx)(n.DialogDescription,{children:"This action cannot be undone. All your data will be permanently deleted."})]}),(0,t.jsxs)("div",{className:"py-4",children:[(0,t.jsx)("div",{className:"bg-red-100 dark:bg-red-950/20 border border-red-200 dark:border-red-900/20 rounded-md p-4",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)(v.Z,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5 mr-3"}),(0,t.jsxs)("div",{className:"text-sm text-red-800 dark:text-red-300",children:[(0,t.jsx)("p",{className:"font-semibold",children:"Warning:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,t.jsx)("li",{children:"All your data will be permanently deleted"}),(0,t.jsx)("li",{children:"You will lose access to all services"}),(0,t.jsx)("li",{children:"This action cannot be reversed"})]})]})]})}),(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"delete-password",children:"Password"}),(0,t.jsx)(n.Input,{id:"delete-password",type:"password",placeholder:"Enter your password",value:ep.current,onChange:e=>eh({...ep,current:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(n.Label,{htmlFor:"confirm-delete",children:["Type ",(0,t.jsx)("span",{className:"font-mono font-semibold",children:"DELETE"})," to confirm"]}),(0,t.jsx)(n.Input,{id:"confirm-delete",placeholder:"Type DELETE",value:ep.confirm,onChange:e=>eh({...ep,confirm:e.target.value})})]})]})]}),(0,t.jsxs)(n.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{variant:"destructive",disabled:_.isPending,onClick:async()=>{try{await _.mutateAsync({confirmation:ep.confirm,password:ep.current})}catch(e){a({title:"Error",description:e instanceof Error?e.message:"Failed to delete account",variant:"destructive"})}},children:"Delete Account"})]})]})})]}):(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"Loading profile..."})})}!function(){var e=Error("Cannot find module '@shared/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}()},28131:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/settings/profile/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[2793,1009,6226,657,6032,4218],()=>a(38685));module.exports=t})();