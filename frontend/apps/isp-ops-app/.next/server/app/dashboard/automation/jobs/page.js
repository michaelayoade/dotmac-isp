(()=>{var e={};e.id=7233,e.ids=[7233],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},99698:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(29687),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),n=t(37922),l=t.n(n),i=t(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let o=["",{children:["dashboard",{children:["automation",{children:["jobs",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,29687)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/automation/jobs/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],c=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/automation/jobs/page.tsx"],u="/dashboard/automation/jobs/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/automation/jobs/page",pathname:"/dashboard/automation/jobs",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},20674:(e,s,t)=>{Promise.resolve().then(t.bind(t,32229))},32229:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(10326),r=t(17577),n=t(44976),l=t(48324),i=t(17010),d=t(48723),o=t(20892),c=t(36607),u=t(30361),x=t(69669),m=t(77506),p=t(48998),h=t(7819),j=t(21405),f=t(66697),b=t(41291),g=t(90960),y=t(90434);function C(){let{toast:e}=(0,d.useToast)(),s=(0,n.NL)(),t=(0,d.useConfirmDialog)(),[o,C]=(0,r.useState)("all"),{data:v=[],isLoading:N}=(0,l.a)({queryKey:["ansible","jobs"],queryFn:async()=>{let e=await fetch(`${c.LM.api.baseUrl}/api/v1/ansible/jobs`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch jobs");return e.json()},refetchInterval:1e4}),w=(0,i.D)({mutationFn:async e=>{let s=await fetch(`${c.LM.api.baseUrl}/api/v1/ansible/jobs/${e}/cancel`,{method:"POST",credentials:"include"});if(!s.ok)throw Error("Failed to cancel job");return s.json()},onSuccess:()=>{s.invalidateQueries({queryKey:["ansible","jobs"]}),e({title:"Success",description:"Job cancellation requested"})},onError:s=>{e({title:"Error",description:s.message,variant:"destructive"})}}),T=async(e,s)=>{await t({title:"Cancel job",description:`Are you sure you want to cancel job "${s}"?`,confirmText:"Cancel job",variant:"destructive"})&&w.mutate(e)},q=(0,r.useMemo)(()=>"all"===o?v:v.filter(e=>e.status===o),[v,o]),P=(0,r.useMemo)(()=>({total:v.length,pending:v.filter(e=>"pending"===e.status).length,running:v.filter(e=>"running"===e.status).length,successful:v.filter(e=>"successful"===e.status).length,failed:v.filter(e=>"failed"===e.status).length,canceled:v.filter(e=>"canceled"===e.status).length}),[v]),S=e=>{let s={successful:{variant:"outline",color:"text-green-600 bg-green-50 border-green-200",icon:u.Z},failed:{variant:"destructive",color:"text-red-600",icon:x.Z},running:{variant:"default",color:"text-blue-600 bg-blue-50 border-blue-200",icon:m.Z},pending:{variant:"secondary",color:"text-yellow-600 bg-yellow-50 border-yellow-200",icon:p.Z},canceled:{variant:"secondary",color:"text-gray-600 bg-gray-50 border-gray-200",icon:h.Z}}[e],t=s.icon;return(0,a.jsxs)(d.Badge,{variant:s.variant,className:s.color,children:[(0,a.jsx)(t,{className:`h-3 w-3 mr-1 ${"running"===e?"animate-spin":""}`}),e]})},Z=e=>{if(!e)return"-";let s=Math.floor(e/60),t=e%60;return s>0?`${s}m ${t}s`:`${t}s`};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Ansible Jobs"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Monitor and manage playbook execution jobs"})]}),(0,a.jsxs)(d.Button,{variant:"outline",onClick:()=>{s.invalidateQueries({queryKey:["ansible","jobs"]}),e({title:"Refreshed",description:"Job data has been refreshed"})},disabled:N,children:[(0,a.jsx)(j.Z,{className:`h-4 w-4 mr-2 ${N?"animate-spin":""}`}),"Refresh"]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-6",children:[(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Jobs"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:P.total})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Pending"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-yellow-600"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:P.pending})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Running"}),(0,a.jsx)(m.Z,{className:"h-4 w-4 text-blue-600 animate-spin"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:P.running})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Successful"}),(0,a.jsx)(u.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:P.successful})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Failed"}),(0,a.jsx)(x.Z,{className:"h-4 w-4 text-red-600"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:P.failed})})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Canceled"}),(0,a.jsx)(h.Z,{className:"h-4 w-4 text-gray-600"})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:P.canceled})})]})]}),(0,a.jsx)(d.Card,{children:(0,a.jsx)(d.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Filter by status:"}),(0,a.jsxs)(d.Select,{value:o,onValueChange:C,children:[(0,a.jsx)(d.SelectTrigger,{className:"w-[180px]",children:(0,a.jsx)(d.SelectValue,{placeholder:"All Status"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(d.SelectItem,{value:"pending",children:"Pending"}),(0,a.jsx)(d.SelectItem,{value:"running",children:"Running"}),(0,a.jsx)(d.SelectItem,{value:"successful",children:"Successful"}),(0,a.jsx)(d.SelectItem,{value:"failed",children:"Failed"}),(0,a.jsx)(d.SelectItem,{value:"canceled",children:"Canceled"})]})]})]})})}),(0,a.jsxs)(d.Card,{children:[(0,a.jsx)(d.CardHeader,{children:(0,a.jsx)(d.CardTitle,{children:"Job Executions"})}),(0,a.jsx)(d.CardContent,{children:N?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(j.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===q.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,a.jsx)(b.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"all"===o?"No jobs found":`No ${o} jobs found`}),"all"!==o&&(0,a.jsx)(d.Button,{variant:"link",onClick:()=>C("all"),className:"mt-2",children:"Clear filter"})]}):(0,a.jsxs)(d.Table,{children:[(0,a.jsx)(d.TableHeader,{children:(0,a.jsxs)(d.TableRow,{children:[(0,a.jsx)(d.TableHead,{children:"Job ID"}),(0,a.jsx)(d.TableHead,{children:"Name"}),(0,a.jsx)(d.TableHead,{children:"Status"}),(0,a.jsx)(d.TableHead,{children:"Started"}),(0,a.jsx)(d.TableHead,{children:"Duration"}),(0,a.jsx)(d.TableHead,{children:"Actions"})]})}),(0,a.jsx)(d.TableBody,{children:q.map(e=>(0,a.jsxs)(d.TableRow,{children:[(0,a.jsx)(d.TableCell,{className:"font-mono text-sm",children:e.id}),(0,a.jsx)(d.TableCell,{children:(0,a.jsx)("div",{className:"font-medium max-w-xs truncate",children:e.name})}),(0,a.jsx)(d.TableCell,{children:S(e.status)}),(0,a.jsx)(d.TableCell,{children:e.started?(0,a.jsx)("div",{className:"text-sm",children:(0,g.Q)(new Date(e.started),{addSuffix:!0})}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,a.jsx)(d.TableCell,{children:Z(e.elapsed)}),(0,a.jsx)(d.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)(y.default,{href:`/dashboard/automation/jobs/${e.id}`,children:"View"})}),("running"===e.status||"pending"===e.status)&&(0,a.jsxs)(d.Button,{variant:"destructive",size:"sm",onClick:()=>{T(e.id,e.name)},disabled:w.isPending,children:[(0,a.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),"Cancel"]})]})})]},e.id))})]})})]})]})}function v(){return(0,a.jsx)(o.eu,{permission:"isp.automation.read",children:(0,a.jsx)(C,{})})}},29687:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/automation/jobs/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(99698));module.exports=a})();