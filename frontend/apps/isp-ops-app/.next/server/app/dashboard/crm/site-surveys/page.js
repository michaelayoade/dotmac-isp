(()=>{var e={};e.id=8989,e.ids=[8989],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},45217:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>o,routeModule:()=>p,tree:()=>c}),t(53799),t(67486),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),l=t(37922),n=t.n(l),i=t(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let c=["",{children:["dashboard",{children:["crm",{children:["site-surveys",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,53799)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/site-surveys/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,67486)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/site-surveys/page.tsx"],u="/dashboard/crm/site-surveys/page",x={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/crm/site-surveys/page",pathname:"/dashboard/crm/site-surveys",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},89606:(e,s,t)=>{Promise.resolve().then(t.bind(t,63647))},63647:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w,dynamic:()=>b,dynamicParams:()=>C});var a=t(10326),r=t(17577),l=t(37358),n=t(94893),i=t(66307),d=t(69669),c=t(30123),o=t(21405),u=t(83855),x=t(48998),p=t(88307),m=t(79635),h=t(39447),j=t(12714),g=t(97505),f=t(48723),y=t(33570),v=t(42198);let b="force-dynamic",C=!0;function w(){let{toast:e}=(0,f.useToast)(),s=(0,f.useConfirmDialog)(),[t,b]=(0,r.useState)(!1),[C,w]=(0,r.useState)(!1),[N,S]=(0,r.useState)(null),[_,P]=(0,r.useState)("all"),[T,q]=(0,r.useState)(""),{surveys:D,isLoading:Z,refetch:H,startSurvey:I,cancelSurvey:U}=(0,g.Dv)({}),k={scheduled:D.filter(e=>"scheduled"===e.status).length,in_progress:D.filter(e=>"in_progress"===e.status).length,completed:D.filter(e=>"completed"===e.status).length,canceled:D.filter(e=>"canceled"===e.status).length,completion_rate:D.length>0?(D.filter(e=>"completed"===e.status).length/D.length*100).toFixed(1):"0.0"},M=D.filter(e=>{let s="all"===_||e.status===_,t=!T||e.survey_number.toLowerCase().includes(T.toLowerCase())||e.lead_id.toLowerCase().includes(T.toLowerCase());return s&&t}),A=e=>{let s={scheduled:{variant:"secondary",icon:l.Z,label:"Scheduled"},in_progress:{variant:"default",icon:n.Z,label:"In Progress"},completed:{variant:"outline",icon:i.Z,label:"Completed"},failed:{variant:"destructive",icon:d.Z,label:"Failed"},canceled:{variant:"outline",icon:c.Z,label:"Canceled"}}[e],t=s.icon;return(0,a.jsxs)(f.Badge,{variant:s.variant,children:[(0,a.jsx)(t,{className:"w-3 h-3 mr-1"}),s.label]})},B=e=>{if(!e)return(0,a.jsx)("span",{className:"text-muted-foreground text-sm",children:"N/A"});let s={serviceable:{color:"bg-green-100 text-green-800",label:"Serviceable"},not_serviceable:{color:"bg-red-100 text-red-800",label:"Not Serviceable"},pending_expansion:{color:"bg-yellow-100 text-yellow-800",label:"Pending Expansion"},requires_construction:{color:"bg-orange-100 text-orange-800",label:"Requires Construction"}}[e];return(0,a.jsx)(f.Badge,{className:s.color,children:s.label})},L=async s=>{await I(s.id)&&(e({title:"Survey Started",description:`Survey ${s.survey_number} is now in progress`}),H())},R=e=>{S(e),w(!0)},E=async t=>{await s({title:"Cancel site survey",description:`Are you sure you want to cancel survey ${t.survey_number}?`,confirmText:"Cancel survey",variant:"destructive"})&&await U(t.id,"Canceled by user")&&(e({title:"Survey Canceled",description:`Survey ${t.survey_number} has been canceled`}),H())};return(0,a.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Site Surveys"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Schedule and manage technical site assessments"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(f.Button,{variant:"outline",onClick:()=>H(),children:[(0,a.jsx)(o.Z,{className:`w-4 h-4 mr-2 ${Z?"animate-spin":""}`}),"Refresh"]}),(0,a.jsxs)(f.Button,{onClick:()=>b(!0),children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Schedule Survey"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,a.jsxs)(f.Card,{children:[(0,a.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Scheduled"}),(0,a.jsx)(l.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(f.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:k.scheduled}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Upcoming surveys"})]})]}),(0,a.jsxs)(f.Card,{children:[(0,a.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"In Progress"}),(0,a.jsx)(n.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(f.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:k.in_progress}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently on-site"})]})]}),(0,a.jsxs)(f.Card,{children:[(0,a.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Completed"}),(0,a.jsx)(i.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(f.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:k.completed}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Finished surveys"})]})]}),(0,a.jsxs)(f.Card,{children:[(0,a.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Canceled"}),(0,a.jsx)(c.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(f.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:k.canceled}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Canceled surveys"})]})]}),(0,a.jsxs)(f.Card,{children:[(0,a.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Completion Rate"}),(0,a.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(f.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[k.completion_rate,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Success rate"})]})]})]}),(0,a.jsxs)(f.Card,{children:[(0,a.jsxs)(f.CardHeader,{children:[(0,a.jsx)(f.CardTitle,{children:"All Surveys"}),(0,a.jsx)(f.CardDescription,{children:"View and manage all scheduled site surveys"})]}),(0,a.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(f.Input,{placeholder:"Search by survey number or lead...",value:T,onChange:e=>q(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(f.Select,{value:_,onValueChange:e=>P(e),children:[(0,a.jsx)(f.SelectTrigger,{className:"w-[180px]",children:(0,a.jsx)(f.SelectValue,{placeholder:"Filter by status"})}),(0,a.jsxs)(f.SelectContent,{children:[(0,a.jsx)(f.SelectItem,{value:"all",children:"All Statuses"}),(0,a.jsx)(f.SelectItem,{value:"scheduled",children:"Scheduled"}),(0,a.jsx)(f.SelectItem,{value:"in_progress",children:"In Progress"}),(0,a.jsx)(f.SelectItem,{value:"completed",children:"Completed"}),(0,a.jsx)(f.SelectItem,{value:"failed",children:"Failed"}),(0,a.jsx)(f.SelectItem,{value:"canceled",children:"Canceled"})]})]})]}),Z?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(o.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===M.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(l.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No surveys found"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:T||"all"!==_?"Try adjusting your filters":"Schedule your first site survey to get started"}),!T&&"all"===_&&(0,a.jsxs)(f.Button,{className:"mt-4",onClick:()=>b(!0),children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Schedule Survey"]})]}):(0,a.jsxs)(f.Table,{children:[(0,a.jsx)(f.TableHeader,{children:(0,a.jsxs)(f.TableRow,{children:[(0,a.jsx)(f.TableHead,{children:"Survey #"}),(0,a.jsx)(f.TableHead,{children:"Lead"}),(0,a.jsx)(f.TableHead,{children:"Scheduled Date"}),(0,a.jsx)(f.TableHead,{children:"Technician"}),(0,a.jsx)(f.TableHead,{children:"Status"}),(0,a.jsx)(f.TableHead,{children:"Serviceability"}),(0,a.jsx)(f.TableHead,{children:"Actions"})]})}),(0,a.jsx)(f.TableBody,{children:M.map(e=>(0,a.jsxs)(f.TableRow,{children:[(0,a.jsx)(f.TableCell,{className:"font-medium",children:e.survey_number}),(0,a.jsx)(f.TableCell,{children:e.lead_id}),(0,a.jsx)(f.TableCell,{children:new Date(e.scheduled_date).toLocaleString()}),(0,a.jsx)(f.TableCell,{children:e.technician_id?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.technician_id})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"Unassigned"})}),(0,a.jsx)(f.TableCell,{children:A(e.status)}),(0,a.jsx)(f.TableCell,{children:B(e.serviceability)}),(0,a.jsx)(f.TableCell,{children:(0,a.jsxs)(f.DropdownMenu,{children:[(0,a.jsx)(f.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(f.Button,{variant:"ghost",size:"sm","aria-label":"Open actions menu",children:(0,a.jsx)(h.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(f.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(f.DropdownMenuItem,{onClick:()=>{},children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"View Details"]}),"scheduled"===e.status&&(0,a.jsxs)(f.DropdownMenuItem,{onClick:()=>L(e),children:[(0,a.jsx)(n.Z,{className:"h-4 w-4 mr-2"}),"Start Survey"]}),"in_progress"===e.status&&(0,a.jsxs)(f.DropdownMenuItem,{onClick:()=>R(e),children:[(0,a.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"Complete Survey"]}),("scheduled"===e.status||"in_progress"===e.status)&&(0,a.jsxs)(f.DropdownMenuItem,{onClick:()=>E(e),className:"text-red-600",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Cancel Survey"]})]})]})})]},e.id))})]})]})]}),(0,a.jsx)(y.D,{open:t,onOpenChange:b,onSuccess:()=>{H(),b(!1)}}),(0,a.jsx)(v.z,{open:C,onOpenChange:w,survey:N,onSuccess:()=>{H(),w(!1),S(null)}})]})}},53799:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n,dynamic:()=>r,dynamicParams:()=>l});var a=t(68570);let r=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/site-surveys/page.tsx#dynamic`),l=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/site-surveys/page.tsx#dynamicParams`),n=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/site-surveys/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,5839,6032,4218,7558,2199],()=>t(45217));module.exports=a})();