(()=>{var e={};e.id=177,e.ids=[177],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},90089:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>l}),t(50297),t(67486),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),i=t(37922),n=t.n(i),d=t(95231),c={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);t.d(s,c);let l=["",{children:["dashboard",{children:["crm",{children:["contacts",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,50297)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/contacts/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,67486)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/contacts/[id]/page.tsx"],m="/dashboard/crm/contacts/[id]/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/crm/contacts/[id]/page",pathname:"/dashboard/crm/contacts/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},67131:(e,s,t)=>{Promise.resolve().then(t.bind(t,32397))},27246:(e,s,t)=>{Promise.resolve().then(t.bind(t,28538))},32397:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var a=t(10326),r=t(17577),i=t(35047),n=t(44976),d=t(48324),c=t(17010),l=t(5932),o=t(42887),m=t(79635),p=t(86333),u=t(98091),h=t(31215),x=t(59734),j=t(37358),f=t(90434),g=t(48723),v=t(59341),y=t(29771),b=t(90960);function N(){let e=(0,i.useParams)(),s=(0,i.useRouter)(),{toast:t}=(0,g.useToast)(),N=(0,n.NL)(),C=e.id,_=(0,g.useConfirmDialog)(),[w,P]=(0,r.useState)(!1),[S,q]=(0,r.useState)({}),{data:L,isLoading:T}=(0,d.a)({queryKey:["contact",C],queryFn:async()=>{try{let e=(await v.x1.get(`/contacts/${C}`)).data;return q(e),e}catch(e){throw y.k.error("Failed to fetch contact",{error:e}),e}}}),{data:D}=(0,d.a)({queryKey:["contact-activities",C],queryFn:async()=>{try{return(await v.x1.get(`/contacts/${C}/activities`)).data}catch(e){return y.k.error("Failed to fetch activities",{error:e}),[]}}}),F=(0,c.D)({mutationFn:async e=>(await v.x1.patch(`/contacts/${C}`,e)).data,onSuccess:()=>{N.invalidateQueries({queryKey:["contact",C]}),N.invalidateQueries({queryKey:["contacts"]}),t({title:"Contact updated",description:"Contact has been updated successfully."}),P(!1)},onError:e=>{t({title:"Error",description:e.response?.data?.detail||"Failed to update contact",variant:"destructive"})}}),B=(0,c.D)({mutationFn:async()=>{await v.x1.delete(`/contacts/${C}`)},onSuccess:()=>{t({title:"Contact deleted",description:"Contact has been deleted successfully."}),s.push("/dashboard/crm/contacts")},onError:e=>{t({title:"Error",description:e.response?.data?.detail||"Failed to delete contact",variant:"destructive"})}}),I=async()=>{await _({title:"Delete contact",description:"Are you sure you want to delete this contact? This action cannot be undone.",confirmText:"Delete contact",variant:"destructive"})&&B.mutate()};if(T)return(0,a.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,a.jsx)("div",{className:"text-muted-foreground",children:"Loading contact..."})});if(!L)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Contact not found"}),(0,a.jsx)(f.default,{href:"/dashboard/crm/contacts",children:(0,a.jsx)(g.Button,{children:"Back to Contacts"})})]});let k=e=>{switch(e){case"email":return(0,a.jsx)(l.Z,{className:"h-4 w-4"});case"phone":case"mobile":return(0,a.jsx)(o.Z,{className:"h-4 w-4"});default:return(0,a.jsx)(m.Z,{className:"h-4 w-4"})}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(f.default,{href:"/dashboard/crm/contacts",children:(0,a.jsx)(g.Button,{variant:"outline",size:"icon",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:L.display_name||`${L.first_name||""} ${L.last_name||""}`.trim()||"Contact Details"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:L.job_title&&L.company?`${L.job_title} at ${L.company}`:L.company||L.job_title||"Contact information"})]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:!w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Button,{variant:"outline",onClick:()=>P(!0),children:"Edit"}),(0,a.jsxs)(g.Button,{variant:"destructive",onClick:()=>{I()},children:[(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(g.Badge,{variant:"default",children:L.status}),(0,a.jsx)(g.Badge,{variant:"outline",children:L.stage}),L.tags?.map(e=>a.jsx(g.Badge,{variant:"secondary",children:e},e))]}),(0,a.jsxs)(g.Tabs,{defaultValue:"details",className:"w-full",children:[(0,a.jsxs)(g.TabsList,{children:[(0,a.jsx)(g.TabsTrigger,{value:"details",children:"Details"}),(0,a.jsx)(g.TabsTrigger,{value:"activities",children:"Activities"})]}),(0,a.jsx)(g.TabsContent,{value:"details",className:"space-y-6",children:w?(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),F.mutate(S)},children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(g.Card,{children:[(0,a.jsx)(g.CardHeader,{children:(0,a.jsx)(g.CardTitle,{children:"Basic Information"})}),(0,a.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"first_name",children:"First Name"}),(0,a.jsx)(g.Input,{id:"first_name",value:S.first_name||"",onChange:e=>q({...S,first_name:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"middle_name",children:"Middle Name"}),(0,a.jsx)(g.Input,{id:"middle_name",value:S.middle_name||"",onChange:e=>q({...S,middle_name:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"last_name",children:"Last Name"}),(0,a.jsx)(g.Input,{id:"last_name",value:S.last_name||"",onChange:e=>q({...S,last_name:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"company",children:"Company"}),(0,a.jsx)(g.Input,{id:"company",value:S.company||"",onChange:e=>q({...S,company:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"job_title",children:"Job Title"}),(0,a.jsx)(g.Input,{id:"job_title",value:S.job_title||"",onChange:e=>q({...S,job_title:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"department",children:"Department"}),(0,a.jsx)(g.Input,{id:"department",value:S.department||"",onChange:e=>q({...S,department:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"status",children:"Status"}),(0,a.jsxs)(g.Select,{value:S.status||"",onValueChange:e=>q({...S,status:e}),children:[(0,a.jsx)(g.SelectTrigger,{children:(0,a.jsx)(g.SelectValue,{})}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"active",children:"Active"}),(0,a.jsx)(g.SelectItem,{value:"inactive",children:"Inactive"}),(0,a.jsx)(g.SelectItem,{value:"lead",children:"Lead"}),(0,a.jsx)(g.SelectItem,{value:"customer",children:"Customer"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"stage",children:"Stage"}),(0,a.jsxs)(g.Select,{value:S.stage||"",onValueChange:e=>q({...S,stage:e}),children:[(0,a.jsx)(g.SelectTrigger,{children:(0,a.jsx)(g.SelectValue,{})}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"lead",children:"Lead"}),(0,a.jsx)(g.SelectItem,{value:"prospect",children:"Prospect"}),(0,a.jsx)(g.SelectItem,{value:"customer",children:"Customer"}),(0,a.jsx)(g.SelectItem,{value:"partner",children:"Partner"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Label,{htmlFor:"notes",children:"Notes"}),(0,a.jsx)(g.Textarea,{id:"notes",value:S.notes||"",onChange:e=>q({...S,notes:e.target.value}),rows:4})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 justify-end",children:[(0,a.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>{P(!1),q(L)},children:"Cancel"}),(0,a.jsxs)(g.Button,{type:"submit",disabled:F.isPending,children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),F.isPending?"Saving...":"Save Changes"]})]})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(g.Card,{children:[(0,a.jsx)(g.CardHeader,{children:(0,a.jsx)(g.CardTitle,{children:"Contact Information"})}),(0,a.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"Full Name"}),(0,a.jsx)("p",{className:"font-medium",children:[L.prefix,L.first_name,L.middle_name,L.last_name,L.suffix].filter(Boolean).join(" ")||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"Display Name"}),(0,a.jsx)("p",{className:"font-medium",children:L.display_name||"—"})]})]}),L.contact_methods&&L.contact_methods.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground mb-2 block",children:"Contact Methods"}),(0,a.jsx)("div",{className:"space-y-2",children:L.contact_methods.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-accent/50 rounded",children:[k(e.type),(0,a.jsxs)("span",{className:"font-medium capitalize",children:[e.type,":"]}),(0,a.jsx)("span",{children:e.value}),e.label&&(0,a.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:e.label}),e.is_primary&&(0,a.jsx)(g.Badge,{variant:"default",className:"text-xs",children:"Primary"}),e.is_verified&&(0,a.jsx)(g.Badge,{variant:"default",className:"text-xs bg-green-500",children:"Verified"})]},e.id))})]})]})]}),(L.company||L.job_title||L.department)&&(0,a.jsxs)(g.Card,{children:[(0,a.jsx)(g.CardHeader,{children:(0,a.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5"}),"Organization"]})}),(0,a.jsx)(g.CardContent,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[L.company&&(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"Company"}),(0,a.jsx)("p",{className:"font-medium",children:L.company})]}),L.job_title&&(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"Job Title"}),(0,a.jsx)("p",{className:"font-medium",children:L.job_title})]}),L.department&&(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"Department"}),(0,a.jsx)("p",{className:"font-medium",children:L.department})]})]})})]}),L.notes&&(0,a.jsxs)(g.Card,{children:[(0,a.jsx)(g.CardHeader,{children:(0,a.jsx)(g.CardTitle,{children:"Notes"})}),(0,a.jsx)(g.CardContent,{children:(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:L.notes})})]}),(0,a.jsxs)(g.Card,{children:[(0,a.jsx)(g.CardHeader,{children:(0,a.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5"}),"Timeline"]})}),(0,a.jsx)(g.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"Created"}),(0,a.jsx)("p",{className:"font-medium",children:(0,b.Q)(new Date(L.created_at),{addSuffix:!0})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"Last Updated"}),(0,a.jsx)("p",{className:"font-medium",children:(0,b.Q)(new Date(L.updated_at),{addSuffix:!0})})]})]})})]})]})}),(0,a.jsx)(g.TabsContent,{value:"activities",children:(0,a.jsxs)(g.Card,{children:[(0,a.jsx)(g.CardHeader,{children:(0,a.jsx)(g.CardTitle,{children:"Activity History"})}),(0,a.jsx)(g.CardContent,{children:D&&D.length>0?(0,a.jsx)("div",{className:"space-y-4",children:D.map(e=>(0,a.jsxs)("div",{className:"border-l-2 pl-4 py-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)(g.Badge,{variant:"outline",children:e.activity_type}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:(0,b.Q)(new Date(e.performed_at),{addSuffix:!0})})]}),e.subject&&(0,a.jsx)("p",{className:"font-medium",children:e.subject}),e.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]},e.id))}):(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No activities recorded yet"})})]})})]})]})}},28538:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var a=t(10326),r=t(90434),i=t(35047),n=t(17577),d=t(24319),c=t(24061),l=t(36283),o=t(6021),m=t(86645),p=t(20892),u=t(48723),h=t(77863);let x=[{href:"/dashboard/crm",label:"Overview",description:"Pipeline health, KPIs, and quick actions",icon:d.Z},{href:"/dashboard/crm/leads",label:"Leads",description:"Capture, qualify, and assign prospective customers",icon:c.Z},{href:"/dashboard/crm/quotes",label:"Quotes",description:"Proposals, pricing, and acceptance tracking",icon:l.Z},{href:"/dashboard/crm/site-surveys",label:"Site Surveys",description:"Schedule field visits and track serviceability",icon:o.Z}];function j({children:e}){return(0,a.jsx)(p.eu,{permission:"customers.read",children:(0,a.jsx)(f,{children:e})})}function f({children:e}){let s=(0,i.usePathname)(),t=(0,n.useMemo)(()=>{if(!s)return"/dashboard/crm";let e=x.find(e=>s===e.href||s.startsWith(`${e.href}/`));return e?.href??"/dashboard/crm"},[s]);return(0,a.jsxs)("div",{className:"container mx-auto space-y-6 px-4 py-8 sm:px-6 lg:px-8",children:[(0,a.jsxs)("header",{className:"flex flex-col gap-4 border-b border-border pb-6 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-2xl font-semibold",children:[(0,a.jsx)(m.Z,{className:"h-7 w-7 text-primary","aria-hidden":"true"}),(0,a.jsx)("span",{children:"Customer Relationship Management"})]}),(0,a.jsx)("p",{className:"max-w-2xl text-sm text-muted-foreground",children:"Guide prospects through the FTTH sales pipeline — manage leads, generate quotes, and verify serviceability to convert opportunities into paying subscribers."})]}),(0,a.jsx)(u.Badge,{variant:"outline",className:"self-start",children:"BSS Journey • Lead → Customer"})]}),(0,a.jsx)(u.Card,{children:(0,a.jsx)(u.CardContent,{className:"p-0",children:(0,a.jsx)("nav",{className:"flex flex-col divide-y divide-border md:grid md:grid-cols-4 md:divide-y-0","aria-label":"CRM navigation",children:x.map(e=>{let s=t===e.href,i=e.icon;return(0,a.jsxs)(r.default,{href:e.href,className:(0,h.cn)("flex flex-1 flex-col gap-2 p-4 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",s?"bg-primary/10 text-primary":"hover:bg-accent hover:text-foreground"),"aria-current":s?"page":void 0,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i,{className:"h-5 w-5","aria-hidden":"true"}),(0,a.jsx)("span",{className:"font-medium",children:e.label})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]},e.href)})})})}),(0,a.jsx)("section",{children:e})]})}},50297:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/contacts/[id]/page.tsx#default`)},67486:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/layout.tsx#default`)}};var s=require("../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(90089));module.exports=a})();