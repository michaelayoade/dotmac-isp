(()=>{var e={};e.id=6221,e.ids=[6221],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},12884:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>o}),t(59220),t(67486),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),n=t(37922),i=t.n(n),l=t(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let o=["",{children:["dashboard",{children:["crm",{children:["contacts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,59220)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/contacts/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,67486)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],d=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/contacts/page.tsx"],m="/dashboard/crm/contacts/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/crm/contacts/page",pathname:"/dashboard/crm/contacts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},18279:(e,s,t)=>{Promise.resolve().then(t.bind(t,70390))},27246:(e,s,t)=>{Promise.resolve().then(t.bind(t,28538))},70390:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var a=t(10326),r=t(17577),n=t(90434),i=t(44976),l=t(48324),c=t(17010),o=t(83855),d=t(24061),m=t(59734),p=t(88307),x=t(5932),u=t(42887),h=t(39447),f=t(69508),j=t(98091),g=t(48723),b=t(59341),v=t(29771);function y(){let[e,s]=(0,r.useState)(""),[t,y]=(0,r.useState)(1),{toast:N}=(0,g.useToast)(),C=(0,i.NL)(),w=(0,g.useConfirmDialog)(),{data:P,isLoading:T}=(0,l.a)({queryKey:["contacts",e,t],queryFn:async()=>{try{return(await b.x1.post("/contacts/search",{query:e||null,page:t,page_size:20,include_deleted:!1})).data}catch(e){throw v.k.error("Failed to fetch contacts",{error:e}),e}}}),q=(0,c.D)({mutationFn:async e=>{await b.x1.delete(`/contacts/${e}`)},onSuccess:()=>{C.invalidateQueries({queryKey:["contacts"]}),N({title:"Contact deleted",description:"The contact has been deleted successfully."})},onError:e=>{N({title:"Error",description:e.response?.data?.detail||"Failed to delete contact",variant:"destructive"})}}),_=e=>e.display_name?e.display_name:[e.first_name,e.last_name].filter(Boolean).join(" ").trim(),D=async e=>{let s=_(e);await w({title:"Delete contact",description:`Are you sure you want to delete contact "${s}"? This action cannot be undone.`,confirmText:"Delete contact",variant:"destructive"})&&q.mutate(e.id)},Z=e=>(0,a.jsx)(g.Badge,{variant:"default",className:{active:"bg-green-500",inactive:"bg-gray-500",lead:"bg-blue-500",customer:"bg-purple-500"}[e.toLowerCase()]||"bg-gray-500",children:e});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Contacts"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage customer contacts and relationships"})]}),(0,a.jsx)(n.default,{href:"/dashboard/crm/contacts/new",children:(0,a.jsxs)(g.Button,{children:[(0,a.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Add Contact"]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(g.Card,{children:[(0,a.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Total Contacts"}),(0,a.jsx)(d.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(g.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:P?.total??0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"All contacts"})]})]}),(0,a.jsxs)(g.Card,{children:[(0,a.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Active Contacts"}),(0,a.jsx)(d.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(g.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:P?.contacts.filter(e=>"active"===e.status).length??0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]}),(0,a.jsxs)(g.Card,{children:[(0,a.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Companies"}),(0,a.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(g.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:new Set(P?.contacts.filter(e=>e.company).map(e=>e.company)).size??0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unique companies"})]})]})]}),(0,a.jsxs)(g.Card,{children:[(0,a.jsx)(g.CardHeader,{children:(0,a.jsx)(g.CardTitle,{children:"Filters"})}),(0,a.jsx)(g.CardContent,{children:(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(g.Input,{placeholder:"Search by name, company, or email...",value:e,onChange:e=>{s(e.target.value),y(1)},className:"pl-10"})]})})})]}),(0,a.jsx)(g.Card,{children:(0,a.jsx)(g.CardContent,{className:"p-0",children:T?(0,a.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Loading contacts..."}):P&&P.contacts.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.Table,{children:[(0,a.jsx)(g.TableHeader,{children:(0,a.jsxs)(g.TableRow,{children:[(0,a.jsx)(g.TableHead,{children:"Name"}),(0,a.jsx)(g.TableHead,{children:"Company"}),(0,a.jsx)(g.TableHead,{children:"Title"}),(0,a.jsx)(g.TableHead,{children:"Contact Info"}),(0,a.jsx)(g.TableHead,{children:"Status"}),(0,a.jsx)(g.TableHead,{children:"Stage"}),(0,a.jsx)(g.TableHead,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(g.TableBody,{children:P.contacts.map(e=>(0,a.jsxs)(g.TableRow,{children:[(0,a.jsx)(g.TableCell,{className:"font-medium",children:e.display_name||`${e.first_name||""} ${e.last_name||""}`.trim()||"Unnamed"}),(0,a.jsx)(g.TableCell,{children:e.company||(0,a.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,a.jsx)(g.TableCell,{children:e.job_title||(0,a.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,a.jsx)(g.TableCell,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[e.email&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)(x.Z,{className:"h-3 w-3 text-muted-foreground"}),(0,a.jsx)("span",{children:e.email})]}),e.phone&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)(u.Z,{className:"h-3 w-3 text-muted-foreground"}),(0,a.jsx)("span",{children:e.phone})]}),!e.email&&!e.phone&&(0,a.jsx)("span",{className:"text-muted-foreground",children:"No contact info"})]})}),(0,a.jsx)(g.TableCell,{children:Z(e.status)}),(0,a.jsx)(g.TableCell,{children:(0,a.jsx)(g.Badge,{variant:"outline",children:e.stage})}),(0,a.jsx)(g.TableCell,{className:"text-right",children:(0,a.jsxs)(g.DropdownMenu,{children:[(0,a.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(g.Button,{variant:"ghost",size:"sm","aria-label":"Open actions menu",children:(0,a.jsx)(h.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,a.jsx)(n.default,{href:`/dashboard/crm/contacts/${e.id}`,children:(0,a.jsxs)(g.DropdownMenuItem,{children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Edit"]})}),(0,a.jsx)(g.DropdownMenuSeparator,{}),(0,a.jsxs)(g.DropdownMenuItem,{onClick:()=>{D(e)},className:"text-destructive",children:[(0,a.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-t",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",P.page," - Showing ",P.contacts.length," of ",P.total," ","contacts"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(g.Button,{variant:"outline",size:"sm",disabled:!P.has_prev,onClick:()=>y(e=>e-1),children:"Previous"}),(0,a.jsx)(g.Button,{variant:"outline",size:"sm",disabled:!P.has_next,onClick:()=>y(e=>e+1),children:"Next"})]})]})]}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(d.Z,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No contacts found"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:e?"No contacts match your search criteria.":"Get started by adding your first contact."}),(0,a.jsx)(n.default,{href:"/dashboard/crm/contacts/new",children:(0,a.jsxs)(g.Button,{children:[(0,a.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Add Contact"]})})]})})})]})}},28538:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var a=t(10326),r=t(90434),n=t(35047),i=t(17577),l=t(24319),c=t(24061),o=t(36283),d=t(6021),m=t(86645),p=t(20892),x=t(48723),u=t(77863);let h=[{href:"/dashboard/crm",label:"Overview",description:"Pipeline health, KPIs, and quick actions",icon:l.Z},{href:"/dashboard/crm/leads",label:"Leads",description:"Capture, qualify, and assign prospective customers",icon:c.Z},{href:"/dashboard/crm/quotes",label:"Quotes",description:"Proposals, pricing, and acceptance tracking",icon:o.Z},{href:"/dashboard/crm/site-surveys",label:"Site Surveys",description:"Schedule field visits and track serviceability",icon:d.Z}];function f({children:e}){return(0,a.jsx)(p.eu,{permission:"customers.read",children:(0,a.jsx)(j,{children:e})})}function j({children:e}){let s=(0,n.usePathname)(),t=(0,i.useMemo)(()=>{if(!s)return"/dashboard/crm";let e=h.find(e=>s===e.href||s.startsWith(`${e.href}/`));return e?.href??"/dashboard/crm"},[s]);return(0,a.jsxs)("div",{className:"container mx-auto space-y-6 px-4 py-8 sm:px-6 lg:px-8",children:[(0,a.jsxs)("header",{className:"flex flex-col gap-4 border-b border-border pb-6 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-2xl font-semibold",children:[(0,a.jsx)(m.Z,{className:"h-7 w-7 text-primary","aria-hidden":"true"}),(0,a.jsx)("span",{children:"Customer Relationship Management"})]}),(0,a.jsx)("p",{className:"max-w-2xl text-sm text-muted-foreground",children:"Guide prospects through the FTTH sales pipeline — manage leads, generate quotes, and verify serviceability to convert opportunities into paying subscribers."})]}),(0,a.jsx)(x.Badge,{variant:"outline",className:"self-start",children:"BSS Journey • Lead → Customer"})]}),(0,a.jsx)(x.Card,{children:(0,a.jsx)(x.CardContent,{className:"p-0",children:(0,a.jsx)("nav",{className:"flex flex-col divide-y divide-border md:grid md:grid-cols-4 md:divide-y-0","aria-label":"CRM navigation",children:h.map(e=>{let s=t===e.href,n=e.icon;return(0,a.jsxs)(r.default,{href:e.href,className:(0,u.cn)("flex flex-1 flex-col gap-2 p-4 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",s?"bg-primary/10 text-primary":"hover:bg-accent hover:text-foreground"),"aria-current":s?"page":void 0,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n,{className:"h-5 w-5","aria-hidden":"true"}),(0,a.jsx)("span",{className:"font-medium",children:e.label})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]},e.href)})})})}),(0,a.jsx)("section",{children:e})]})}},59220:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/contacts/page.tsx#default`)},67486:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/crm/layout.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(12884));module.exports=a})();