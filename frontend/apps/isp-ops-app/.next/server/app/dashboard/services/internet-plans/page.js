(()=>{var e={};e.id=4486,e.ids=[4486],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},66827:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>c}),t(67034),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),l=t(37922),n=t.n(l),i=t(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let c=["",{children:["dashboard",{children:["services",{children:["internet-plans",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,67034)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/services/internet-plans/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/services/internet-plans/page.tsx"],x="/dashboard/services/internet-plans/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/services/internet-plans/page",pathname:"/dashboard/services/internet-plans",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},80851:(e,s,t)=>{Promise.resolve().then(t.bind(t,12174))},12174:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>E});var a=t(10326),r=t(17577),l=t(44976),n=t(48324),i=t(17010),d=t(48723),c=t(30361),o=t(48998),x=t(69669),p=t(21405),u=t(83855),m=t(45091),h=t(17069),j=t(24061),f=t(71821),g=t(88307),b=t(3634),v=t(69508),N=t(98091),C=t(36607),y=t(20892),w=t(90434);function S(){let[e,s]=(0,r.useState)(""),[t,y]=(0,r.useState)("all"),[S,E]=(0,r.useState)("all"),[P,I]=(0,r.useState)("all"),_=(0,l.NL)(),{toast:T}=(0,d.useToast)(),A=(0,d.useConfirmDialog)(),{data:q=[],isLoading:D,refetch:R}=(0,n.a)({queryKey:["internet-plans",t,S,P,e],queryFn:async()=>{let s=new URLSearchParams;"all"!==t&&s.append("plan_type",t),"all"!==S&&s.append("status",S),"all"!==P&&s.append("is_public",P),e&&s.append("search",e);let a=await fetch(`${C.LM.api.baseUrl}/api/v1/services/internet-plans?${s.toString()}`,{credentials:"include"});if(!a.ok)throw Error("Failed to fetch plans");return a.json()}}),B=(0,i.D)({mutationFn:async e=>{if(!(await fetch(`${C.LM.api.baseUrl}/api/v1/services/internet-plans/${e}`,{method:"DELETE",credentials:"include"})).ok)throw Error("Failed to delete plan")},onSuccess:()=>{_.invalidateQueries({queryKey:["internet-plans"]}),T({title:"Plan archived successfully"})},onError:e=>{T({title:"Failed to archive plan",description:e.message,variant:"destructive"})}}),L=q.filter(s=>!e||s.name.toLowerCase().includes(e.toLowerCase())||s.plan_code.toLowerCase().includes(e.toLowerCase())||s.description.toLowerCase().includes(e.toLowerCase())),Z={total:q.length,active:q.filter(e=>"ACTIVE"===e.status).length,residential:q.filter(e=>"RESIDENTIAL"===e.plan_type).length,business:q.filter(e=>"BUSINESS"===e.plan_type).length,totalSubscribers:q.reduce((e,s)=>e+(s.subscriber_count||0),0),totalMRR:q.reduce((e,s)=>e+(s.mrr||0),0)},U=e=>{let s={RESIDENTIAL:{color:"bg-blue-100 text-blue-800",label:"Residential"},BUSINESS:{color:"bg-purple-100 text-purple-800",label:"Business"},ENTERPRISE:{color:"bg-orange-100 text-orange-800",label:"Enterprise"}}[e]||{color:"bg-gray-100 text-gray-800",label:e};return(0,a.jsx)(d.Badge,{className:s.color,children:s.label})},V=e=>{let s={ACTIVE:{icon:c.Z,color:"bg-green-100 text-green-800",label:"Active"},INACTIVE:{icon:o.Z,color:"bg-gray-100 text-gray-800",label:"Inactive"},DEPRECATED:{icon:x.Z,color:"bg-red-100 text-red-800",label:"Deprecated"}},t=s[e]||s.INACTIVE,r=t.icon;return(0,a.jsxs)(d.Badge,{className:t.color,children:[(0,a.jsx)(r,{className:"h-3 w-3 mr-1"}),t.label]})},$=e=>e>=1e3?`${(e/1e3).toFixed(1)} Gbps`:`${e} Mbps`,M=e=>null===e?"Unlimited":e>=1e3?`${(e/1e3).toFixed(1)} TB`:`${e} GB`;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Internet Service Plans"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage internet service plans and packages"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d.Button,{variant:"outline",onClick:()=>R(),children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,a.jsx)(d.Button,{asChild:!0,children:(0,a.jsxs)(w.default,{href:"/dashboard/services/internet-plans/new",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Create Plan"]})})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-6",children:[(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Plans"}),(0,a.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:Z.total}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"All plans"})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Active"}),(0,a.jsx)(c.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:Z.active}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently offered"})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Residential"}),(0,a.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:Z.residential}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Home plans"})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Business"}),(0,a.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:Z.business}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Business plans"})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Subscribers"}),(0,a.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:Z.totalSubscribers.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total"})]})]}),(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"MRR"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",(Z.totalMRR/1e3).toFixed(1),"k"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monthly revenue"})]})]})]}),(0,a.jsx)(d.Card,{children:(0,a.jsx)(d.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(d.Input,{placeholder:"Search plans...",value:e,onChange:e=>s(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(d.Select,{value:t,onValueChange:y,children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"All Types"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"all",children:"All Types"}),(0,a.jsx)(d.SelectItem,{value:"RESIDENTIAL",children:"Residential"}),(0,a.jsx)(d.SelectItem,{value:"BUSINESS",children:"Business"}),(0,a.jsx)(d.SelectItem,{value:"ENTERPRISE",children:"Enterprise"})]})]}),(0,a.jsxs)(d.Select,{value:S,onValueChange:E,children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"All Status"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(d.SelectItem,{value:"ACTIVE",children:"Active"}),(0,a.jsx)(d.SelectItem,{value:"INACTIVE",children:"Inactive"}),(0,a.jsx)(d.SelectItem,{value:"DEPRECATED",children:"Deprecated"})]})]}),(0,a.jsxs)(d.Select,{value:P,onValueChange:I,children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"All Visibility"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"all",children:"All Visibility"}),(0,a.jsx)(d.SelectItem,{value:"true",children:"Public"}),(0,a.jsx)(d.SelectItem,{value:"false",children:"Private"})]})]})]})})}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:D?(0,a.jsx)(d.Card,{className:"col-span-full",children:(0,a.jsx)(d.CardContent,{className:"py-8 text-center text-muted-foreground",children:"Loading plans..."})}):0===L.length?(0,a.jsx)(d.Card,{className:"col-span-full",children:(0,a.jsx)(d.CardContent,{className:"py-8 text-center text-muted-foreground",children:e?"No plans match your search":"No plans found"})}):L.map(e=>(0,a.jsxs)(d.Card,{className:"hover:border-primary transition-colors",children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)(m.Z,{className:"h-8 w-8 text-primary"}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 items-end",children:[U(e.plan_type),V(e.status)]})]}),(0,a.jsx)(d.CardTitle,{className:"mt-2",children:(0,a.jsx)(w.default,{href:`/dashboard/services/internet-plans/${e.id}`,className:"hover:underline",children:e.name})}),(0,a.jsx)(d.CardDescription,{className:"line-clamp-2",children:e.description||"No description"})]}),(0,a.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-accent rounded-lg",children:[(0,a.jsxs)("div",{className:"text-center flex-1",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mx-auto mb-1 text-muted-foreground"}),(0,a.jsx)("div",{className:"text-lg font-bold",children:$(e.download_speed_mbps)}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Download"})]}),(0,a.jsxs)("div",{className:"text-center flex-1 border-l",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mx-auto mb-1 text-muted-foreground"}),(0,a.jsx)("div",{className:"text-lg font-bold",children:$(e.upload_speed_mbps)}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Upload"})]})]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Data Cap:"}),(0,a.jsx)("span",{className:"font-medium",children:M(e.data_cap_gb)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Monthly:"}),(0,a.jsxs)("span",{className:"font-bold text-green-600",children:["$",e.monthly_price.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Setup Fee:"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",e.setup_fee.toFixed(2)]})]}),void 0!==e.subscriber_count&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Subscribers:"}),(0,a.jsx)("span",{className:"font-medium",children:e.subscriber_count.toLocaleString()})]})]}),(0,a.jsxs)("div",{className:"pt-3 border-t flex gap-2 flex-wrap",children:[e.is_public&&(0,a.jsx)(d.Badge,{variant:"outline",className:"text-xs",children:"Public"}),e.is_promotional&&(0,a.jsx)(d.Badge,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200 text-xs",children:"Promo"}),(0,a.jsx)(d.Badge,{variant:"outline",className:"text-xs",children:e.plan_code})]}),(0,a.jsxs)("div",{className:"pt-3 border-t flex gap-2",children:[(0,a.jsx)(d.Button,{variant:"outline",size:"sm",asChild:!0,className:"flex-1",children:(0,a.jsxs)(w.default,{href:`/dashboard/services/internet-plans/${e.id}`,children:[(0,a.jsx)(v.Z,{className:"h-3 w-3 mr-1"}),"Edit"]})}),(0,a.jsx)(d.Button,{variant:"outline",size:"sm",onClick:async()=>{await A({title:"Archive plan",description:`Archive plan "${e.name}"?`,confirmText:"Archive plan",variant:"destructive"})&&B.mutate(e.id)},disabled:B.isPending,className:"text-destructive hover:text-destructive",children:(0,a.jsx)(N.Z,{className:"h-3 w-3"})})]})]})]},e.id))})]})}function E(){return(0,a.jsx)(y.eu,{permission:"isp.plans.read",children:(0,a.jsx)(S,{})})}},67034:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/services/internet-plans/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(66827));module.exports=a})();