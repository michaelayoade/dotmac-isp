(()=>{var e={};e.id=2888,e.ids=[2888],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},20736:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>d}),s(51612),s(13321),s(46366),s(96560);var r=s(23191),a=s(88716),i=s(37922),o=s.n(i),l=s(95231),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);s.d(t,n);let d=["",{children:["dashboard",{children:["operations",{children:["files",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,51612)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/operations/files/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],c=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/operations/files/page.tsx"],p="/dashboard/operations/files/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/operations/files/page",pathname:"/dashboard/operations/files",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7961:(e,t,s)=>{Promise.resolve().then(s.bind(s,66329))},66329:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w,dynamic:()=>v});var r=s(10326),a=s(17577),i=s(44976),o=s(48324),l=s(17010),n=s(71709),d=s(49758),c=s(40900),p=s(36283),u=s(39572),m=s(28932),f=s(63685),x=s(88307),h=s(31540),g=s(98091),y=s(48723),j=s(29771),b=s(74250);let v="force-dynamic";function w(){let[e,t]=(0,a.useState)(""),[s,v]=(0,a.useState)([]),[w,N]=(0,a.useState)(!1),P=(0,i.NL)(),k=(0,y.useConfirmDialog)(),{buildApiUrl:_}=(0,b.L)(),{data:q,isLoading:D,error:S}=(0,o.a)({queryKey:["files"],queryFn:async()=>{let e=_("/files/storage"),t=await fetch(e,{credentials:"include"});if(!t.ok)throw Error("Failed to fetch files");return t.json()}}),U=(0,l.D)({mutationFn:async e=>{let t=new FormData;t.append("file",e);let s=_("/files/storage/upload"),r=await fetch(s,{method:"POST",credentials:"include",body:t});if(!r.ok)throw Error("Upload failed");return r.json()},onSuccess:()=>{P.invalidateQueries({queryKey:["files"]}),j.k.info("File uploaded successfully")},onError:e=>{j.k.error("File upload failed",{error:e})}}),F=(0,l.D)({mutationFn:async e=>{let t=_(`/files/storage/${e}`),s=await fetch(t,{method:"DELETE",credentials:"include"});if(!s.ok)throw Error("Delete failed");if(204===s.status)return null;let r=await s.text();return r?JSON.parse(r):null},onSuccess:()=>{P.invalidateQueries({queryKey:["files"]}),v([]),j.k.info("File deleted successfully")},onError:e=>{j.k.error("File deletion failed",{error:e})}}),E=async e=>{let t=e.target.files;if(t&&0!==t.length){N(!0);try{for(let e of Array.from(t))await U.mutateAsync(e)}finally{N(!1),e.target.value=""}}},C=async e=>{await k({title:"Delete file",description:"Are you sure you want to delete this file?",confirmText:"Delete file",variant:"destructive"})&&await F.mutateAsync(e)},Z=(e,t)=>{let s=_(`/files/storage/${e}/download`);window.open(s,"_blank"),j.k.info("File downloaded",{fileId:e,fileName:t})},A=e=>e.startsWith("image/")?n.Z:e.startsWith("video/")?d.Z:e.includes("zip")||e.includes("archive")?c.Z:e.includes("pdf")||e.includes("document")?p.Z:u.Z,B=e=>e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:e<1073741824?`${(e/1048576).toFixed(1)} MB`:`${(e/1073741824).toFixed(1)} GB`,z=e=>{try{if(!e)return"Unknown";let t=new Date(e);if(isNaN(t.getTime()))return j.k.debug("Invalid timestamp format",{timestamp:e}),"Unknown";return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(t){return j.k.error("Date formatting error",{timestamp:e,error:t}),"Unknown"}},L=q?.files.filter(t=>t.file_name.toLowerCase().includes(e.toLowerCase()))||[];return D?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"text-center py-12",role:"status","aria-live":"polite",children:(0,r.jsx)("div",{className:"text-muted-foreground",children:"Loading files..."})})}):S?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(y.EmptyState.Error,{title:"Failed to load files",description:"Unable to fetch file list. Please try again.",onRetry:()=>P.invalidateQueries({queryKey:["files"]})})}):(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)(y.PageHeader,{title:"File Operations",description:"Upload, download, and manage your files",icon:m.Z,actions:(0,r.jsxs)(y.PageHeader.Actions,{children:[(0,r.jsx)("input",{type:"file",id:"file-upload",multiple:!0,onChange:E,className:"hidden","aria-label":"Upload files"}),(0,r.jsxs)(y.Button,{onClick:()=>document.getElementById("file-upload")?.click(),disabled:w,"aria-label":"Upload new files",children:[(0,r.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),w?"Uploading...":"Upload Files"]})]}),children:(0,r.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,r.jsx)(y.PageHeader.Stat,{label:"Total Files",value:q?.total||0,icon:u.Z}),(0,r.jsx)(y.PageHeader.Stat,{label:"Total Size",value:B(L.reduce((e,t)=>e+t.file_size,0))})]})}),(0,r.jsx)("div",{className:"mb-6 flex gap-4 items-center",children:(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)(x.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)("input",{type:"text",placeholder:"Search files...",value:e,onChange:e=>t(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-accent border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Search files"})]})}),0===L.length?(0,r.jsx)(y.EmptyState.List,{entityName:"files",onCreateClick:()=>document.getElementById("file-upload")?.click(),icon:u.Z}):(0,r.jsx)("div",{className:"bg-card rounded-lg border border-border overflow-hidden",children:(0,r.jsxs)("table",{className:"w-full",role:"table",children:[(0,r.jsx)("thead",{className:"bg-muted/50 border-b border-border",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"File"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Type"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Size"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Uploaded"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-border",children:L.map(e=>{let t=A(e.content_type);return(0,r.jsxs)("tr",{className:"hover:bg-muted/50 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(t,{className:"h-5 w-5 text-muted-foreground","aria-hidden":"true"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-foreground",children:e.file_name}),e.description&&(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)(y.StatusBadge,{variant:"info",size:"sm",children:e.content_type.split("/")[1]?.toUpperCase()||"FILE"})}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:B(e.file_size)}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:z(e.created_at)}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(y.Button,{variant:"ghost",size:"sm",onClick:()=>Z(e.file_id,e.file_name),"aria-label":`Download ${e.file_name}`,children:(0,r.jsx)(h.Z,{className:"h-4 w-4"})}),(0,r.jsx)(y.Button,{variant:"ghost",size:"sm",onClick:()=>{C(e.file_id)},"aria-label":`Delete ${e.file_name}`,children:(0,r.jsx)(g.Z,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]})})]},e.file_id)})})]})})]})}},51612:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i,dynamic:()=>a});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/operations/files/page.tsx#dynamic`),i=(0,r.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/operations/files/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[2793,1009,6226,657,6032,4218],()=>s(20736));module.exports=r})();