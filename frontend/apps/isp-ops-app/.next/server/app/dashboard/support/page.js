(()=>{var e={};e.id=1982,e.ids=[1982],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},8193:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>x,tree:()=>c}),s(55784),s(13321),s(46366),s(96560);var a=s(23191),r=s(88716),i=s(37922),l=s.n(i),n=s(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let c=["",{children:["dashboard",{children:["support",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,55784)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],d=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/page.tsx"],p="/dashboard/support/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/support/page",pathname:"/dashboard/support",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},29656:(e,t,s)=>{Promise.resolve().then(s.bind(s,2551))},2551:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v,dynamic:()=>j,dynamicParams:()=>y});var a=s(10326),r=s(17577),i=s(35047),l=s(21405),n=s(83855),o=s(21985),c=s(53982),d=s(48998),p=s(66307),u=s(41291),x=s(88307),h=s(41137),m=s(69669),g=s(48723),f=s(37570);let j="force-dynamic",y=!0;function v(){let e=(0,i.useRouter)(),[t,s]=(0,r.useState)("all"),[m,j]=(0,r.useState)(""),[y,v]=(0,r.useState)(!0),{tickets:_,loading:w,refetch:S}=(0,f.OG)({status:"all"===t?void 0:t,autoRefresh:y,refreshInterval:3e4}),{stats:C,loading:N}=(0,f.yB)(),P=_.filter(e=>{if(!m)return!0;let t=m.toLowerCase();return e.ticket_number.toLowerCase().includes(t)||e.subject.toLowerCase().includes(t)||(e.service_address??"").toLowerCase().includes(t)});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Support Tickets"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage and track support requests"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(g.Button,{variant:"outline",size:"sm",onClick:()=>S(),disabled:w,children:[(0,a.jsx)(l.Z,{className:`h-4 w-4 mr-2 ${w?"animate-spin":""}`}),"Refresh"]}),(0,a.jsxs)(g.Button,{size:"sm",onClick:()=>e.push("/dashboard/support/new"),children:[(0,a.jsx)(n.Z,{className:"h-4 w-4 mr-2"}),"New Ticket"]})]})]}),!N&&C&&(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,a.jsx)(b,{title:"Total Tickets",value:C.total,icon:o.Z,color:"text-blue-500"}),(0,a.jsx)(b,{title:"Open",value:C.open,icon:c.Z,color:"text-yellow-500"}),(0,a.jsx)(b,{title:"In Progress",value:C.in_progress,icon:d.Z,color:"text-purple-500"}),(0,a.jsx)(b,{title:"Resolved",value:C.resolved,icon:p.Z,color:"text-green-500"}),(0,a.jsx)(b,{title:"SLA Breached",value:C.sla_breached,icon:u.Z,color:"text-red-500"})]}),(0,a.jsx)(g.Card,{children:(0,a.jsx)(g.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(g.Input,{placeholder:"Search by ticket number, subject, or address...",value:m,onChange:e=>j(e.target.value),className:"pl-10"})]})}),(0,a.jsx)("div",{className:"w-full sm:w-48",children:(0,a.jsxs)(g.Select,{value:t,onValueChange:e=>s(e),children:[(0,a.jsxs)(g.SelectTrigger,{children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),(0,a.jsx)(g.SelectValue,{placeholder:"Filter by status"})]}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"all",children:"All Status"}),(0,a.jsx)(g.SelectItem,{value:"open",children:"Open"}),(0,a.jsx)(g.SelectItem,{value:"in_progress",children:"In Progress"}),(0,a.jsx)(g.SelectItem,{value:"waiting",children:"Waiting"}),(0,a.jsx)(g.SelectItem,{value:"resolved",children:"Resolved"}),(0,a.jsx)(g.SelectItem,{value:"closed",children:"Closed"})]})]})})]})})}),(0,a.jsxs)(g.Card,{children:[(0,a.jsxs)(g.CardHeader,{children:[(0,a.jsx)(g.CardTitle,{children:"Tickets"}),(0,a.jsxs)(g.CardDescription,{children:[P.length," ticket",1!==P.length?"s":""," found"]})]}),(0,a.jsx)(g.CardContent,{children:w&&0===_.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Loading tickets..."}):0===P.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No tickets found"}):(0,a.jsx)("div",{className:"space-y-3",children:P.map(t=>(0,a.jsx)(k,{ticket:t,onClick:()=>e.push(`/dashboard/support/${t.id}`)},t.id))})})]})]})}function b({title:e,value:t,icon:s,color:r}){return(0,a.jsxs)(g.Card,{children:[(0,a.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[(0,a.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:e}),(0,a.jsx)(s,{className:`h-4 w-4 ${r}`})]}),(0,a.jsx)(g.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:t})})]})}function k({ticket:e,onClick:t}){return(0,a.jsx)("div",{className:"border rounded-lg p-4 hover:bg-accent/50 cursor-pointer transition-colors",onClick:t,children:(0,a.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-mono text-muted-foreground",children:e.ticket_number}),(0,a.jsx)(_,{status:e.status}),(0,a.jsx)(w,{priority:e.priority}),e.sla_breached&&(0,a.jsx)(g.Badge,{variant:"destructive",className:"text-xs",children:"SLA Breached"})]}),(0,a.jsx)("h3",{className:"font-semibold text-foreground",children:e.subject}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.ticket_type&&(0,a.jsx)("span",{className:"capitalize",children:e.ticket_type.replace(/_/g," ")}),e.service_address&&(0,a.jsxs)("span",{children:["\uD83D\uDCCD ",e.service_address]}),(0,a.jsxs)("span",{children:["Created ",new Date(e.created_at).toLocaleDateString()]}),e.last_response_at&&(0,a.jsxs)("span",{children:["Last update ",new Date(e.last_response_at).toLocaleDateString()]})]})]})})})}function _({status:e}){let t={open:{variant:"default",label:"Open",icon:c.Z},in_progress:{variant:"secondary",label:"In Progress",icon:d.Z},waiting:{variant:"outline",label:"Waiting",icon:d.Z},resolved:{variant:"success",label:"Resolved",icon:p.Z},closed:{variant:"secondary",label:"Closed",icon:m.Z}}[e],s=t.icon;return(0,a.jsxs)(g.Badge,{variant:t.variant,className:"text-xs",children:[(0,a.jsx)(s,{className:"h-3 w-3 mr-1"}),t.label]})}function w({priority:e}){let t={low:{variant:"outline",label:"Low"},normal:{variant:"secondary",label:"Normal"},high:{variant:"default",label:"High"},urgent:{variant:"destructive",label:"Urgent"}}[e];return(0,a.jsx)(g.Badge,{variant:t.variant,className:"text-xs",children:t.label})}},37570:(e,t,s)=>{"use strict";s.d(t,{OG:()=>n,Q$:()=>o,Qr:()=>d,iU:()=>p,ky:()=>c,yB:()=>u});var a=s(17577),r=s(59341),i=s(29771);let l=e=>e instanceof Error?e:Error("string"==typeof e?e:String(e));function n(e={}){let{status:t,priority:s,search:n,autoRefresh:o=!1,refreshInterval:c=3e4}=e,[d,p]=(0,a.useState)([]),[u,x]=(0,a.useState)(!0),[h,m]=(0,a.useState)(null);return{tickets:d,loading:u,error:h,refetch:(0,a.useCallback)(async()=>{try{x(!0);let e={};t&&(e.status=t),s&&(e.priority=s),n&&(e.search=n);let a=await r.x1.get("/tickets",{params:e});p(a.data),m(null)}catch(e){i.k.error("Failed to fetch tickets",l(e),{status:t}),m(e.response?.data?.detail||"Failed to fetch tickets")}finally{x(!1)}},[t])}}function o(e,t=!1){let[s,n]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),[d,p]=(0,a.useState)(null);return{ticket:s,loading:o,error:d,refetch:(0,a.useCallback)(async()=>{if(!e){c(!1);return}try{c(!0);let t=await r.x1.get(`/tickets/${e}`);n(t.data),p(null)}catch(t){i.k.error("Failed to fetch ticket",l(t),{ticketId:e}),p(t.response?.data?.detail||"Failed to fetch ticket")}finally{c(!1)}},[e])}}function c(){let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(null);return{createTicket:(0,a.useCallback)(async e=>{try{return t(!0),n(null),(await r.x1.post("/tickets",e)).data}catch(t){return i.k.error("Failed to create ticket",l(t),{targetType:e.target_type}),n(t.response?.data?.detail||"Failed to create ticket"),null}finally{t(!1)}},[]),loading:e,error:s}}function d(){let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(null);return{updateTicket:(0,a.useCallback)(async(e,s)=>{try{return t(!0),n(null),(await r.x1.patch(`/tickets/${e}`,s)).data}catch(t){return i.k.error("Failed to update ticket",l(t),{ticketId:e}),n(t.response?.data?.detail||"Failed to update ticket"),null}finally{t(!1)}},[]),loading:e,error:s}}function p(){let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(null);return{addMessage:(0,a.useCallback)(async(e,s)=>{try{return t(!0),n(null),(await r.x1.post(`/tickets/${e}/messages`,s)).data}catch(t){return i.k.error("Failed to add ticket message",l(t),{ticketId:e}),n(t.response?.data?.detail||"Failed to add message"),null}finally{t(!1)}},[]),loading:e,error:s}}function u(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!0),[o,c]=(0,a.useState)(null);return{stats:e,loading:s,error:o,refetch:(0,a.useCallback)(async()=>{try{n(!0);let e=(await r.x1.get("/tickets/metrics")).data;t({total:e.total??0,open:e.open??0,in_progress:e.in_progress??0,waiting:e.waiting??0,resolved:e.resolved??0,closed:e.closed??0,by_priority:{low:e.by_priority?.low??0,normal:e.by_priority?.normal??0,high:e.by_priority?.high??0,urgent:e.by_priority?.urgent??0},by_type:e.by_type||{},sla_breached:e.sla_breached??0,avg_resolution_time_minutes:e.avg_resolution_time_minutes??0}),c(null)}catch(e){i.k.error("Failed to fetch ticket stats",l(e)),c(e.response?.data?.detail||"Failed to fetch statistics")}finally{n(!1)}},[])}}},55784:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,dynamic:()=>r,dynamicParams:()=>i});var a=s(68570);let r=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/page.tsx#dynamic`),i=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/page.tsx#dynamicParams`),l=(0,a.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[2793,1009,6226,657,6032,4218],()=>s(8193));module.exports=a})();