(()=>{var e={};e.id=4717,e.ids=[4717],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},68078:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>o}),s(89187),s(13321),s(46366),s(96560);var r=s(23191),a=s(88716),i=s(37922),l=s.n(i),c=s(95231),n={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>c[e]);s.d(t,n);let o=["",{children:["dashboard",{children:["support",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,89187)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/new/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],d=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/new/page.tsx"],p="/dashboard/support/new/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/support/new/page",pathname:"/dashboard/support/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},40158:(e,t,s)=>{Promise.resolve().then(s.bind(s,22445))},22445:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u,dynamic:()=>d,dynamicParams:()=>p});var r=s(10326),a=s(17577),i=s(35047),l=s(86333),c=s(69436),n=s(48723),o=s(37570);let d="force-dynamic",p=!0;function u(){let e=(0,i.useRouter)(),{toast:t}=(0,n.useToast)(),{createTicket:s,loading:d}=(0,o.ky)(),[p,u]=(0,a.useState)({subject:"",message:"",priority:"normal",ticketType:"",targetType:"tenant",serviceAddress:"",affectedServices:[]}),h=async r=>{if(r.preventDefault(),!p.subject.trim()||!p.message.trim()){t({title:"Validation Error",description:"Subject and message are required",variant:"destructive"});return}let a=await s({subject:p.subject,message:p.message,target_type:p.targetType,priority:p.priority,...p.ticketType?{ticket_type:p.ticketType}:{},...p.serviceAddress?{service_address:p.serviceAddress}:{},...p.affectedServices.length>0?{affected_services:p.affectedServices}:{}});a&&(t({title:"Ticket Created",description:`Ticket ${a.ticket_number} has been created successfully`}),e.push(`/dashboard/support/${a.id}`))},m=e=>{u(t=>({...t,affectedServices:t.affectedServices.includes(e)?t.affectedServices.filter(t=>t!==e):[...t.affectedServices,e]}))};return(0,r.jsxs)("div",{className:"space-y-6 max-w-3xl pb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:()=>e.push("/dashboard/support"),children:[(0,r.jsx)(l.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Create New Ticket"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Submit a new support request"})]})]}),(0,r.jsx)("form",{onSubmit:h,children:(0,r.jsxs)(n.Card,{children:[(0,r.jsxs)(n.CardHeader,{children:[(0,r.jsx)(n.CardTitle,{children:"Ticket Details"}),(0,r.jsx)(n.CardDescription,{children:"Provide details about your support request"})]}),(0,r.jsxs)(n.CardContent,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"subject",children:"Subject *"}),(0,r.jsx)(n.Input,{id:"subject",placeholder:"Brief description of the issue",value:p.subject,onChange:e=>u({...p,subject:e.target.value}),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"message",children:"Message *"}),(0,r.jsx)(n.Textarea,{id:"message",placeholder:"Detailed description of the issue...",value:p.message,onChange:e=>u({...p,message:e.target.value}),rows:6,required:!0})]}),(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"priority",children:"Priority"}),(0,r.jsxs)(n.Select,{value:p.priority,onValueChange:e=>u({...p,priority:e}),children:[(0,r.jsx)(n.SelectTrigger,{id:"priority",children:(0,r.jsx)(n.SelectValue,{})}),(0,r.jsxs)(n.SelectContent,{children:[(0,r.jsx)(n.SelectItem,{value:"low",children:"Low"}),(0,r.jsx)(n.SelectItem,{value:"normal",children:"Normal"}),(0,r.jsx)(n.SelectItem,{value:"high",children:"High"}),(0,r.jsx)(n.SelectItem,{value:"urgent",children:"Urgent"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"ticketType",children:"Ticket Type"}),(0,r.jsxs)(n.Select,{value:p.ticketType,onValueChange:e=>u({...p,ticketType:e}),children:[(0,r.jsx)(n.SelectTrigger,{id:"ticketType",children:(0,r.jsx)(n.SelectValue,{placeholder:"Select type..."})}),(0,r.jsxs)(n.SelectContent,{children:[(0,r.jsx)(n.SelectItem,{value:"general_inquiry",children:"General Inquiry"}),(0,r.jsx)(n.SelectItem,{value:"billing_issue",children:"Billing Issue"}),(0,r.jsx)(n.SelectItem,{value:"technical_support",children:"Technical Support"}),(0,r.jsx)(n.SelectItem,{value:"installation_request",children:"Installation Request"}),(0,r.jsx)(n.SelectItem,{value:"outage_report",children:"Outage Report"}),(0,r.jsx)(n.SelectItem,{value:"service_upgrade",children:"Service Upgrade"}),(0,r.jsx)(n.SelectItem,{value:"service_downgrade",children:"Service Downgrade"}),(0,r.jsx)(n.SelectItem,{value:"cancellation_request",children:"Cancellation Request"}),(0,r.jsx)(n.SelectItem,{value:"equipment_issue",children:"Equipment Issue"}),(0,r.jsx)(n.SelectItem,{value:"speed_issue",children:"Speed Issue"}),(0,r.jsx)(n.SelectItem,{value:"network_issue",children:"Network Issue"}),(0,r.jsx)(n.SelectItem,{value:"connectivity_issue",children:"Connectivity Issue"})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"serviceAddress",children:"Service Address (Optional)"}),(0,r.jsx)(n.Input,{id:"serviceAddress",placeholder:"Address where service is provided",value:p.serviceAddress,onChange:e=>u({...p,serviceAddress:e.target.value})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{children:"Affected Services (Optional)"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:["internet","voip","tv","phone"].map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>m(e),className:`px-3 py-1.5 text-sm rounded-md border transition-colors ${p.affectedServices.includes(e)?"bg-primary text-primary-foreground border-primary":"bg-background hover:bg-accent border-input"}`,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"targetType",children:"Send To"}),(0,r.jsxs)(n.Select,{value:p.targetType,onValueChange:e=>u({...p,targetType:e}),children:[(0,r.jsx)(n.SelectTrigger,{id:"targetType",children:(0,r.jsx)(n.SelectValue,{})}),(0,r.jsxs)(n.SelectContent,{children:[(0,r.jsx)(n.SelectItem,{value:"tenant",children:"Tenant Support"}),(0,r.jsx)(n.SelectItem,{value:"partner",children:"Partner Support"}),(0,r.jsx)(n.SelectItem,{value:"platform",children:"Platform Support"})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,r.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>e.push("/dashboard/support"),disabled:d,children:"Cancel"}),(0,r.jsxs)(n.Button,{type:"submit",disabled:d,children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),d?"Creating...":"Create Ticket"]})]})]})]})})]})}},37570:(e,t,s)=>{"use strict";s.d(t,{OG:()=>c,Q$:()=>n,Qr:()=>d,iU:()=>p,ky:()=>o,yB:()=>u});var r=s(17577),a=s(59341),i=s(29771);let l=e=>e instanceof Error?e:Error("string"==typeof e?e:String(e));function c(e={}){let{status:t,priority:s,search:c,autoRefresh:n=!1,refreshInterval:o=3e4}=e,[d,p]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[m,x]=(0,r.useState)(null);return{tickets:d,loading:u,error:m,refetch:(0,r.useCallback)(async()=>{try{h(!0);let e={};t&&(e.status=t),s&&(e.priority=s),c&&(e.search=c);let r=await a.x1.get("/tickets",{params:e});p(r.data),x(null)}catch(e){i.k.error("Failed to fetch tickets",l(e),{status:t}),x(e.response?.data?.detail||"Failed to fetch tickets")}finally{h(!1)}},[t])}}function n(e,t=!1){let[s,c]=(0,r.useState)(null),[n,o]=(0,r.useState)(!0),[d,p]=(0,r.useState)(null);return{ticket:s,loading:n,error:d,refetch:(0,r.useCallback)(async()=>{if(!e){o(!1);return}try{o(!0);let t=await a.x1.get(`/tickets/${e}`);c(t.data),p(null)}catch(t){i.k.error("Failed to fetch ticket",l(t),{ticketId:e}),p(t.response?.data?.detail||"Failed to fetch ticket")}finally{o(!1)}},[e])}}function o(){let[e,t]=(0,r.useState)(!1),[s,c]=(0,r.useState)(null);return{createTicket:(0,r.useCallback)(async e=>{try{return t(!0),c(null),(await a.x1.post("/tickets",e)).data}catch(t){return i.k.error("Failed to create ticket",l(t),{targetType:e.target_type}),c(t.response?.data?.detail||"Failed to create ticket"),null}finally{t(!1)}},[]),loading:e,error:s}}function d(){let[e,t]=(0,r.useState)(!1),[s,c]=(0,r.useState)(null);return{updateTicket:(0,r.useCallback)(async(e,s)=>{try{return t(!0),c(null),(await a.x1.patch(`/tickets/${e}`,s)).data}catch(t){return i.k.error("Failed to update ticket",l(t),{ticketId:e}),c(t.response?.data?.detail||"Failed to update ticket"),null}finally{t(!1)}},[]),loading:e,error:s}}function p(){let[e,t]=(0,r.useState)(!1),[s,c]=(0,r.useState)(null);return{addMessage:(0,r.useCallback)(async(e,s)=>{try{return t(!0),c(null),(await a.x1.post(`/tickets/${e}/messages`,s)).data}catch(t){return i.k.error("Failed to add ticket message",l(t),{ticketId:e}),c(t.response?.data?.detail||"Failed to add message"),null}finally{t(!1)}},[]),loading:e,error:s}}function u(){let[e,t]=(0,r.useState)(null),[s,c]=(0,r.useState)(!0),[n,o]=(0,r.useState)(null);return{stats:e,loading:s,error:n,refetch:(0,r.useCallback)(async()=>{try{c(!0);let e=(await a.x1.get("/tickets/metrics")).data;t({total:e.total??0,open:e.open??0,in_progress:e.in_progress??0,waiting:e.waiting??0,resolved:e.resolved??0,closed:e.closed??0,by_priority:{low:e.by_priority?.low??0,normal:e.by_priority?.normal??0,high:e.by_priority?.high??0,urgent:e.by_priority?.urgent??0},by_type:e.by_type||{},sla_breached:e.sla_breached??0,avg_resolution_time_minutes:e.avg_resolution_time_minutes??0}),o(null)}catch(e){i.k.error("Failed to fetch ticket stats",l(e)),o(e.response?.data?.detail||"Failed to fetch statistics")}finally{c(!1)}},[])}}},89187:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,dynamic:()=>a,dynamicParams:()=>i});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/new/page.tsx#dynamic`),i=(0,r.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/new/page.tsx#dynamicParams`),l=(0,r.createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/support/new/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[2793,1009,6226,657,6032,4218],()=>s(68078));module.exports=r})();