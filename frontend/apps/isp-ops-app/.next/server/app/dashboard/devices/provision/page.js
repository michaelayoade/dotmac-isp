(()=>{var e={};e.id=5257,e.ids=[5257],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},38232:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>o}),r(51676),r(13321),r(46366),r(96560);var i=r(23191),t=r(88716),a=r(37922),l=r.n(a),n=r(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);r.d(s,d);let o=["",{children:["dashboard",{children:["devices",{children:["provision",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,51676)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/devices/provision/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],c=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/devices/provision/page.tsx"],p="/dashboard/devices/provision/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new i.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/dashboard/devices/provision/page",pathname:"/dashboard/devices/provision",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},10297:(e,s,r)=>{Promise.resolve().then(r.bind(r,68133))},68133:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>C});var i=r(10326),t=r(17577),a=r(44976),l=r(48324),n=r(17010),d=r(48723),o=r(48998),c=r(63685),p=r(30361),u=r(41291),x=r(86333),m=r(13961),h=r(31540),v=r(98091),j=r(94893),g=r(36283),b=r(74250),f=r(20892),N=r(90434);function y(){let[e,s]=(0,t.useState)("single"),[r,f]=(0,t.useState)(null),[y,C]=(0,t.useState)([]),[w,P]=(0,t.useState)(""),[k,D]=(0,t.useState)(""),[q,S]=(0,t.useState)(""),[T,F]=(0,t.useState)(""),[_,A]=(0,t.useState)(""),L=(0,a.NL)(),{toast:U}=(0,d.useToast)(),{apiBaseUrl:B}=(0,b.L)(),{data:E=[]}=(0,l.a)({queryKey:["device-presets"],queryFn:async()=>{let e=await fetch(`${B}/api/isp/v1/admin/genieacs/presets`,{credentials:"include"});return e.ok?e.json():[]}}),{data:O=[]}=(0,l.a)({queryKey:["bulk-provision-jobs"],queryFn:async()=>{let e=await fetch(`${B}/api/isp/v1/admin/genieacs/provision/bulk/jobs`,{credentials:"include"});return e.ok?e.json():[]},refetchInterval:5e3}),Z=(0,n.D)({mutationFn:async e=>{let s=await fetch(`${B}/api/isp/v1/admin/genieacs/provision`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error("Failed to provision device");return s.json()},onSuccess:()=>{L.invalidateQueries({queryKey:["genieacs-devices"]}),P(""),D(""),S(""),F(""),U({title:"Device provisioned successfully"})},onError:e=>{U({title:"Provisioning failed",description:e.message,variant:"destructive"})}}),I=(0,n.D)({mutationFn:async e=>{let s=new FormData;s.append("file",e),_&&s.append("presetName",_);let r=await fetch(`${B}/api/isp/v1/admin/genieacs/provision/bulk`,{method:"POST",credentials:"include",body:s});if(!r.ok)throw Error("Failed to start bulk provisioning");return r.json()},onSuccess:()=>{L.invalidateQueries({queryKey:["bulk-provision-jobs"]}),f(null),C([]),A(""),U({title:"Bulk provisioning started"})},onError:e=>{U({title:"Bulk provisioning failed",description:e.message,variant:"destructive"})}}),R=e=>{let s={pending:{icon:o.Z,color:"bg-gray-100 text-gray-800"},processing:{icon:c.Z,color:"bg-blue-100 text-blue-800"},completed:{icon:p.Z,color:"bg-green-100 text-green-800"},failed:{icon:u.Z,color:"bg-red-100 text-red-800"}},{icon:r,color:t}=s[e]||s.pending;return(0,i.jsxs)(d.Badge,{className:t,children:[(0,i.jsx)(r,{className:"h-3 w-3 mr-1"}),e.charAt(0).toUpperCase()+e.slice(1)]})};return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)(d.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,i.jsx)(N.default,{href:"/dashboard/devices",children:(0,i.jsx)(x.Z,{className:"h-4 w-4"})})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:"Device Provisioning"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add new devices individually or in bulk"})]})]})}),(0,i.jsxs)(d.Tabs,{value:e,onValueChange:e=>s(e),children:[(0,i.jsxs)(d.TabsList,{className:"grid w-full max-w-md grid-cols-2",children:[(0,i.jsx)(d.TabsTrigger,{value:"single",children:"Single Device"}),(0,i.jsx)(d.TabsTrigger,{value:"bulk",children:"Bulk Upload"})]}),(0,i.jsxs)(d.TabsContent,{value:"single",className:"space-y-6",children:[(0,i.jsxs)(d.Card,{children:[(0,i.jsxs)(d.CardHeader,{children:[(0,i.jsx)(d.CardTitle,{children:"Provision Single Device"}),(0,i.jsx)(d.CardDescription,{children:"Enter device information to provision a new TR-069 device"})]}),(0,i.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(d.Label,{htmlFor:"serialNumber",children:"Serial Number *"}),(0,i.jsx)(d.Input,{id:"serialNumber",placeholder:"e.g., ABC123456789",value:w,onChange:e=>P(e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(d.Label,{htmlFor:"productClass",children:"Product Class *"}),(0,i.jsx)(d.Input,{id:"productClass",placeholder:"e.g., Device, Router",value:k,onChange:e=>D(e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(d.Label,{htmlFor:"oui",children:"OUI (Organizationally Unique Identifier) *"}),(0,i.jsx)(d.Input,{id:"oui",placeholder:"e.g., 00D09E",value:q,onChange:e=>S(e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(d.Label,{htmlFor:"preset",children:"Configuration Preset (Optional)"}),(0,i.jsxs)("select",{id:"preset",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",value:T,onChange:e=>F(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"No preset"}),E.map(e=>(0,i.jsxs)("option",{value:e.name,children:[e.name," - ",e.description]},e.id))]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,i.jsx)(d.Button,{variant:"outline",onClick:()=>{P(""),D(""),S(""),F("")},children:"Clear"}),(0,i.jsxs)(d.Button,{onClick:()=>{if(!w||!k||!q){U({title:"Missing required fields",description:"Serial number, product class, and OUI are required",variant:"destructive"});return}let e={serialNumber:w,productClass:k,oui:q,...T?{presetName:T}:{}};Z.mutate(e)},disabled:Z.isPending,children:[(0,i.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Provision Device"]})]})]})]}),(0,i.jsx)(d.Card,{className:"border-blue-200 bg-blue-50/50 dark:border-blue-900 dark:bg-blue-950/20",children:(0,i.jsx)(d.CardContent,{className:"pt-6",children:(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)(u.Z,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Device Information"}),(0,i.jsxs)("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-disc list-inside",children:[(0,i.jsx)("li",{children:"Serial Number: Unique identifier from device label"}),(0,i.jsx)("li",{children:"Product Class: Device type (e.g., ONT, Router, Gateway)"}),(0,i.jsx)("li",{children:"OUI: First 6 hex digits of MAC address"}),(0,i.jsx)("li",{children:"Preset: Pre-configured settings to apply to device"})]})]})]})})})]}),(0,i.jsxs)(d.TabsContent,{value:"bulk",className:"space-y-6",children:[(0,i.jsxs)(d.Card,{children:[(0,i.jsxs)(d.CardHeader,{children:[(0,i.jsx)(d.CardTitle,{children:"Bulk Provisioning"}),(0,i.jsx)(d.CardDescription,{children:"Upload a CSV file to provision multiple devices at once"})]}),(0,i.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(d.Label,{children:"CSV File"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(d.Input,{type:"file",accept:".csv",onChange:e=>{let s=e.target.files?.[0];if(!s)return;f(s);let r=new FileReader;r.onload=e=>{C((e.target?.result).split("\n").filter(e=>e.trim()).map(e=>e.split(",").map(e=>e.trim())).slice(0,6))},r.readAsText(s)},className:"flex-1"}),(0,i.jsxs)(d.Button,{variant:"outline",onClick:()=>{let e=new Blob(["serial_number,product_class,oui\nEXAMPLE123,Device,00D09E\nEXAMPLE456,Router,AABBCC"],{type:"text/csv"}),s=URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download="provision-template.csv",r.click(),URL.revokeObjectURL(s)},children:[(0,i.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"CSV format: serial_number, product_class, oui"})]}),y.length>0&&y[0]&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(d.Label,{children:"File Preview (First 5 rows)"}),(0,i.jsx)("div",{className:"border rounded-md overflow-x-auto",children:(0,i.jsxs)("table",{className:"w-full text-sm",children:[(0,i.jsx)("thead",{className:"bg-muted",children:(0,i.jsx)("tr",{children:y[0].map((e,s)=>(0,i.jsx)("th",{className:"px-4 py-2 text-left font-medium",children:e},s))})}),(0,i.jsx)("tbody",{children:y.slice(1).map((e,s)=>(0,i.jsx)("tr",{className:"border-t",children:e.map((e,s)=>(0,i.jsx)("td",{className:"px-4 py-2",children:e},s))},s))})]})}),(0,i.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total rows in file: ",y.length-1," devices"]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(d.Label,{htmlFor:"bulkPreset",children:"Apply Preset to All Devices (Optional)"}),(0,i.jsxs)("select",{id:"bulkPreset",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",value:_,onChange:e=>A(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"No preset"}),E.map(e=>(0,i.jsxs)("option",{value:e.name,children:[e.name," - ",e.description]},e.id))]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,i.jsxs)(d.Button,{variant:"outline",onClick:()=>{f(null),C([]),A("")},disabled:!r,children:[(0,i.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Clear"]}),(0,i.jsxs)(d.Button,{onClick:()=>{if(!r){U({title:"No file selected",description:"Please upload a CSV file",variant:"destructive"});return}I.mutate(r)},disabled:!r||I.isPending,children:[(0,i.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Start Bulk Provisioning"]})]})]})]}),O.length>0&&(0,i.jsxs)(d.Card,{children:[(0,i.jsxs)(d.CardHeader,{children:[(0,i.jsx)(d.CardTitle,{children:"Bulk Provisioning Jobs"}),(0,i.jsx)(d.CardDescription,{children:"Track progress of bulk operations"})]}),(0,i.jsx)(d.CardContent,{children:(0,i.jsx)("div",{className:"space-y-3",children:O.map(e=>(0,i.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,i.jsxs)("span",{className:"font-medium",children:["Job #",e.id.slice(0,8)]})]}),R(e.status)]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,i.jsxs)("span",{children:["Progress: ",e.processedDevices," / ",e.totalDevices," devices"]}),(0,i.jsxs)("span",{className:"font-medium",children:[Math.round(e.processedDevices/e.totalDevices*100),"%"]})]}),(0,i.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,i.jsx)("div",{className:"bg-primary rounded-full h-2 transition-all",style:{width:`${e.processedDevices/e.totalDevices*100}%`}})})]}),(0,i.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(p.Z,{className:"h-3 w-3 text-green-600"}),(0,i.jsxs)("span",{children:["Success: ",e.successCount]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(u.Z,{className:"h-3 w-3 text-red-600"}),(0,i.jsxs)("span",{children:["Failed: ",e.failureCount]})]})]}),(0,i.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Started: ",new Date(e.startedAt).toLocaleString(),e.completedAt&&(0,i.jsxs)(i.Fragment,{children:[" â€¢ Completed: ",new Date(e.completedAt).toLocaleString()]})]}),e.errors&&e.errors.length>0&&(0,i.jsxs)("div",{className:"mt-2 p-2 bg-destructive/10 rounded text-xs",children:[(0,i.jsx)("p",{className:"font-medium mb-1",children:"Errors:"}),(0,i.jsxs)("ul",{className:"space-y-1",children:[e.errors.slice(0,3).map((e,s)=>(0,i.jsxs)("li",{children:[e.serialNumber,": ",e.error]},s)),e.errors.length>3&&(0,i.jsxs)("li",{children:["...and ",e.errors.length-3," more"]})]})]})]},e.id))})})]})]})]})]})}function C(){return(0,i.jsx)(f.eu,{permission:"devices.write",children:(0,i.jsx)(y,{})})}},51676:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>i});let i=(0,r(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/devices/provision/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),i=s.X(0,[2793,1009,6226,657,6032,4218],()=>r(38232));module.exports=i})();