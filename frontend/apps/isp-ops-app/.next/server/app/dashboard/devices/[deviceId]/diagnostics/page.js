(()=>{var e={};e.id=9606,e.ids=[9606],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},93399:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>c}),t(78700),t(13321),t(46366),t(96560);var a=t(23191),d=t(88716),r=t(37922),i=t.n(r),n=t(95231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(s,l);let c=["",{children:["dashboard",{children:["devices",{children:["[deviceId]",{children:["diagnostics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,78700)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/devices/[deviceId]/diagnostics/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/devices/[deviceId]/diagnostics/page.tsx"],m="/dashboard/devices/[deviceId]/diagnostics/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:d.x.APP_PAGE,page:"/dashboard/devices/[deviceId]/diagnostics/page",pathname:"/dashboard/devices/[deviceId]/diagnostics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19679:(e,s,t)=>{Promise.resolve().then(t.bind(t,86030))},86030:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>T});var a=t(10326),d=t(17577),r=t(17010),i=t(48723),n=t(66697),l=t(30361),c=t(69669),o=t(86333),m=t(41291),x=t(45091),u=t(94893),p=t(54014),h=t(3634),j=t(31540),g=t(63685),N=t(48998),v=t(74250),f=t(20892),b=t(90434),y=t(35047);function C(){let e=(0,y.useParams)().deviceId,[s,t]=(0,d.useState)("8.8.8.8"),[f,C]=(0,d.useState)("4"),[T,w]=(0,d.useState)("8.8.8.8"),[P,S]=(0,d.useState)("google.com"),[k,D]=(0,d.useState)("10"),[q,I]=(0,d.useState)(null),[Z,R]=(0,d.useState)(null),[_,B]=(0,d.useState)(null),[$,E]=(0,d.useState)(null),{toast:H}=(0,i.useToast)(),{apiBaseUrl:O}=(0,v.L)(),F=(0,r.D)({mutationFn:async()=>{let t=await fetch(`${O}/api/isp/v1/admin/genieacs/devices/${e}/diagnostics/ping`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:s,count:parseInt(f)})});if(!t.ok)throw Error("Ping test failed");return t.json()},onSuccess:e=>{I(e),H({title:"Ping test completed"})},onError:()=>{H({title:"Ping test failed",variant:"destructive"})}}),L=(0,r.D)({mutationFn:async()=>{let s=await fetch(`${O}/api/isp/v1/admin/genieacs/devices/${e}/diagnostics/traceroute`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:T})});if(!s.ok)throw Error("Traceroute failed");return s.json()},onSuccess:e=>{R(e),H({title:"Traceroute completed"})},onError:()=>{H({title:"Traceroute failed",variant:"destructive"})}}),M=(0,r.D)({mutationFn:async()=>{let s=await fetch(`${O}/api/isp/v1/admin/genieacs/devices/${e}/diagnostics/dns`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:P})});if(!s.ok)throw Error("DNS lookup failed");return s.json()},onSuccess:e=>{B(e),H({title:"DNS lookup completed"})},onError:()=>{H({title:"DNS lookup failed",variant:"destructive"})}}),U=(0,r.D)({mutationFn:async()=>{let s=await fetch(`${O}/api/isp/v1/admin/genieacs/devices/${e}/diagnostics/speedtest`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({duration:parseInt(k)})});if(!s.ok)throw Error("Speed test failed");return s.json()},onSuccess:e=>{E(e),H({title:"Speed test completed"})},onError:()=>{H({title:"Speed test failed",variant:"destructive"})}}),A=e=>e>=1e9?`${(e/1e9).toFixed(2)} Gbps`:e>=1e6?`${(e/1e6).toFixed(2)} Mbps`:e>=1e3?`${(e/1e3).toFixed(2)} Kbps`:`${e} bps`,G=(e,s)=>s?(0,a.jsxs)(i.Badge,{className:"bg-blue-100 text-blue-800 dark:bg-blue-950/20 dark:text-blue-400",children:[(0,a.jsx)(n.Z,{className:"h-3 w-3 mr-1 animate-spin"}),"Running..."]}):e?e.success?(0,a.jsxs)(i.Badge,{className:"bg-green-100 text-green-800 dark:bg-green-950/20 dark:text-green-400",children:[(0,a.jsx)(l.Z,{className:"h-3 w-3 mr-1"}),"Success"]}):(0,a.jsxs)(i.Badge,{className:"bg-red-100 text-red-800 dark:bg-red-950/20 dark:text-red-400",children:[(0,a.jsx)(c.Z,{className:"h-3 w-3 mr-1"}),"Failed"]}):(0,a.jsx)(i.Badge,{variant:"secondary",children:"Not Run"});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,a.jsx)(b.default,{href:`/dashboard/devices/${e}`,children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Device Diagnostics"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Run network diagnostics and connectivity tests"})]})]})}),(0,a.jsx)(i.Card,{className:"border-blue-200 bg-blue-50/50 dark:border-blue-900 dark:bg-blue-950/20",children:(0,a.jsx)(i.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:"These diagnostics are executed directly on the device. Results may take several seconds to complete depending on network conditions."})})]})})}),(0,a.jsxs)(i.Tabs,{defaultValue:"ping",className:"space-y-4",children:[(0,a.jsxs)(i.TabsList,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(i.TabsTrigger,{value:"ping",children:"Ping"}),(0,a.jsx)(i.TabsTrigger,{value:"traceroute",children:"Traceroute"}),(0,a.jsx)(i.TabsTrigger,{value:"dns",children:"DNS Lookup"}),(0,a.jsx)(i.TabsTrigger,{value:"speedtest",children:"Speed Test"})]}),(0,a.jsx)(i.TabsContent,{value:"ping",className:"space-y-4",children:(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5"}),"Ping Test"]}),(0,a.jsx)(i.CardDescription,{children:"Test ICMP connectivity to a host"})]}),G(q,F.isPending)]})}),(0,a.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Target Host"}),(0,a.jsx)(i.Input,{value:s,onChange:e=>t(e.target.value),placeholder:"IP address or hostname"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Packet Count"}),(0,a.jsx)(i.Input,{type:"number",value:f,onChange:e=>C(e.target.value),min:"1",max:"100"})]})]}),(0,a.jsxs)(i.Button,{onClick:()=>F.mutate(),disabled:F.isPending,className:"w-full",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Run Ping Test"]}),q&&(0,a.jsxs)("div",{className:"space-y-3 p-4 rounded-lg bg-muted",children:[(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Packets Sent"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:q.data?.sent||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Packets Received"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:q.data?.received||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Packet Loss"}),(0,a.jsxs)("p",{className:"text-lg font-medium",children:[q.data?.loss||0,"%"]})]})]}),(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Min RTT"}),(0,a.jsxs)("p",{className:"text-lg font-medium",children:[q.data?.min||0,"ms"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Avg RTT"}),(0,a.jsxs)("p",{className:"text-lg font-medium",children:[q.data?.avg||0,"ms"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Max RTT"}),(0,a.jsxs)("p",{className:"text-lg font-medium",children:[q.data?.max||0,"ms"]})]})]}),q.data?.output&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Raw Output:"}),(0,a.jsx)("pre",{className:"text-xs bg-background p-3 rounded border overflow-auto max-h-40",children:q.data.output})]})]})]})]})}),(0,a.jsx)(i.TabsContent,{value:"traceroute",className:"space-y-4",children:(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),"Traceroute"]}),(0,a.jsx)(i.CardDescription,{children:"Trace the network path to a destination"})]}),G(Z,L.isPending)]})}),(0,a.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Target Host"}),(0,a.jsx)(i.Input,{value:T,onChange:e=>w(e.target.value),placeholder:"IP address or hostname"})]}),(0,a.jsxs)(i.Button,{onClick:()=>L.mutate(),disabled:L.isPending,className:"w-full",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Run Traceroute"]}),Z&&(0,a.jsxs)("div",{className:"space-y-3 p-4 rounded-lg bg-muted",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Hops: ",Z.data?.hops?.length||0]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Duration: ",Z.duration,"ms"]})]}),Z.data?.hops&&(0,a.jsx)("div",{className:"space-y-2",children:Z.data.hops.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded bg-background",children:[(0,a.jsx)(i.Badge,{variant:"outline",className:"w-8 justify-center",children:e.number}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.host||"*"}),e.ip&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.ip})]}),(0,a.jsxs)("p",{className:"text-sm",children:[e.rtt||"-","ms"]})]},s))})]})]})]})}),(0,a.jsx)(i.TabsContent,{value:"dns",className:"space-y-4",children:(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),"DNS Lookup"]}),(0,a.jsx)(i.CardDescription,{children:"Resolve a hostname to IP addresses"})]}),G(_,M.isPending)]})}),(0,a.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Hostname"}),(0,a.jsx)(i.Input,{value:P,onChange:e=>S(e.target.value),placeholder:"example.com"})]}),(0,a.jsxs)(i.Button,{onClick:()=>M.mutate(),disabled:M.isPending,className:"w-full",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Run DNS Lookup"]}),_&&(0,a.jsxs)("div",{className:"space-y-3 p-4 rounded-lg bg-muted",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Query: ",_.data?.query]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Duration: ",_.duration,"ms"]})]}),_.data?.addresses&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Resolved Addresses:"}),_.data.addresses.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded bg-background",children:[(0,a.jsxs)(i.Badge,{variant:"outline",children:["IPv",e.includes(":")?"6":"4"]}),(0,a.jsx)("p",{className:"font-mono text-sm",children:e})]},s))]})]})]})]})}),(0,a.jsx)(i.TabsContent,{value:"speedtest",className:"space-y-4",children:(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5"}),"Speed Test"]}),(0,a.jsx)(i.CardDescription,{children:"Measure download and upload speeds"})]}),G($,U.isPending)]})}),(0,a.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Test Duration (seconds)"}),(0,a.jsx)(i.Input,{type:"number",value:k,onChange:e=>D(e.target.value),min:"5",max:"60"})]}),(0,a.jsxs)(i.Button,{onClick:()=>U.mutate(),disabled:U.isPending,className:"w-full",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Run Speed Test"]}),$&&(0,a.jsxs)("div",{className:"space-y-4 p-4 rounded-lg bg-muted",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{className:"pb-3",children:(0,a.jsxs)(i.CardTitle,{className:"text-sm flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 text-green-600"}),"Download Speed"]})}),(0,a.jsx)(i.CardContent,{children:(0,a.jsx)("p",{className:"text-2xl font-bold",children:A($.data?.download||0)})})]}),(0,a.jsxs)(i.Card,{children:[(0,a.jsx)(i.CardHeader,{className:"pb-3",children:(0,a.jsxs)(i.CardTitle,{className:"text-sm flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 text-blue-600"}),"Upload Speed"]})}),(0,a.jsx)(i.CardContent,{children:(0,a.jsx)("p",{className:"text-2xl font-bold",children:A($.data?.upload||0)})})]})]}),(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Latency"}),(0,a.jsxs)("p",{className:"font-medium",children:[$.data?.latency||0,"ms"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Jitter"}),(0,a.jsxs)("p",{className:"font-medium",children:[$.data?.jitter||0,"ms"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Test Duration"}),(0,a.jsxs)("p",{className:"font-medium",children:[($.duration/1e3).toFixed(1),"s"]})]})]})]})]})]})})]}),(0,a.jsxs)(i.Card,{children:[(0,a.jsxs)(i.CardHeader,{children:[(0,a.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5"}),"Recent Tests"]}),(0,a.jsx)(i.CardDescription,{children:"History of diagnostic tests run on this device"})]}),(0,a.jsx)(i.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[[q,Z,_,$].filter(Boolean).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e?.success?(0,a.jsx)(l.Z,{className:"h-4 w-4 text-green-600"}):(0,a.jsx)(c.Z,{className:"h-4 w-4 text-red-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e===q?"Ping Test":e===Z?"Traceroute":e===_?"DNS Lookup":"Speed Test"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleString()})]})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.duration,"ms"]})]},s)),![q,Z,_,$].some(Boolean)&&(0,a.jsx)("p",{className:"text-center py-8 text-muted-foreground",children:"No diagnostic tests have been run yet"})]})})]})]})}function T(){return(0,a.jsx)(f.eu,{permission:"devices.diagnostics",children:(0,a.jsx)(C,{})})}},78700:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/devices/[deviceId]/diagnostics/page.tsx#default`)}};var s=require("../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(93399));module.exports=a})();