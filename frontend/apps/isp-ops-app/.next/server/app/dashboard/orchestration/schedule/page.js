(()=>{var e={};e.id=454,e.ids=[454],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},76972:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c}),t(85888),t(13321),t(46366),t(96560);var r=t(23191),a=t(88716),l=t(37922),n=t.n(l),i=t(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let c=["",{children:["dashboard",{children:["orchestration",{children:["schedule",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,85888)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/orchestration/schedule/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],d=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/orchestration/schedule/page.tsx"],u="/dashboard/orchestration/schedule/page",p={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/orchestration/schedule/page",pathname:"/dashboard/orchestration/schedule",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},56089:(e,s,t)=>{Promise.resolve().then(t.bind(t,60009))},60009:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var r=t(10326),a=t(17577),l=t(41291),n=t(37358),i=t(66307),o=t(77506),c=t(18019),d=t(59341);let u=[{label:"Every day at midnight",value:"0 0 * * *"},{label:"Every day at 2 AM",value:"0 2 * * *"},{label:"Every Sunday at 2 AM",value:"0 2 * * 0"},{label:"Every Monday at 3 AM",value:"0 3 * * 1"},{label:"First day of month at midnight",value:"0 0 1 * *"},{label:"Every 6 hours",value:"0 */6 * * *"}];var p=t(48723),h=t(46502),m=t(29771);function x(){let{toast:e}=(0,p.useToast)(),{hasPermission:s}=(0,h.ss)(),t=s("deployment.schedule.create")||s("admin"),{scheduleDeployment:x,fetchTemplates:g,fetchInstances:j,isLoading:v,error:y}=function(){let[e,s]=(0,a.useState)(!1),[t,r]=(0,a.useState)(null);return{scheduleDeployment:(0,a.useCallback)(async e=>{try{if(s(!0),r(null),"provision"===e.operation&&!e.provision_request)throw Error("provision_request is required for provision operation");if(["upgrade","scale","suspend","resume","destroy"].includes(e.operation)&&!e.instance_id)throw Error(`instance_id is required for ${e.operation} operation`);if("upgrade"===e.operation&&!e.upgrade_request)throw Error("upgrade_request is required for upgrade operation");if("scale"===e.operation&&!e.scale_request)throw Error("scale_request is required for scale operation");return(await d.x1.post("/deployments/schedule",e)).data}catch(s){let e=s instanceof Error?s:Error("Failed to schedule deployment");throw r(e),e}finally{s(!1)}},[]),fetchTemplates:(0,a.useCallback)(async()=>{try{return(await d.x1.get("/deployments/templates?is_active=true")).data}catch(s){let e=s instanceof Error?s:Error("Failed to fetch templates");throw r(e),e}},[]),fetchInstances:(0,a.useCallback)(async()=>{try{return(await d.x1.get("/deployments/instances")).data.instances}catch(s){let e=s instanceof Error?s:Error("Failed to fetch instances");throw r(e),e}},[]),isLoading:e,error:t}}(),[b,f]=(0,a.useState)("upgrade"),[S,_]=(0,a.useState)("one_time"),[N,C]=(0,a.useState)(""),[q,w]=(0,a.useState)(""),[D,I]=(0,a.useState)(""),[E,P]=(0,a.useState)(""),[T,k]=(0,a.useState)(""),[F,A]=(0,a.useState)(""),[L,R]=(0,a.useState)(!0),[M,U]=(0,a.useState)(""),[G,V]=(0,a.useState)(""),[Z,O]=(0,a.useState)(""),[B,z]=(0,a.useState)([]),[H,$]=(0,a.useState)([]),[X,Y]=(0,a.useState)(null),J=async s=>{if(s.preventDefault(),t)try{Y(null);let s={operation:b,scheduled_at:N};"recurring"===S&&(q?s.cron_expression=q:D&&(s.interval_seconds=parseInt(D))),"provision"!==b&&(s.instance_id=parseInt(E)),"provision"===b&&(s.provision_request={template_id:parseInt(T),environment:"production"}),"upgrade"===b&&(s.upgrade_request={to_version:F,rollback_on_failure:L}),"scale"===b&&(s.scale_request={},M&&(s.scale_request.cpu_cores=parseInt(M)),G&&(s.scale_request.memory_gb=parseInt(G)),Z&&(s.scale_request.storage_gb=parseInt(Z)));let t=await x(s);Y(t),m.k.info("Deployment scheduled successfully",{scheduleId:t.schedule_id,operation:b,scheduleType:S,nextRunAt:t.next_run_at}),e({title:"Success",description:`Deployment scheduled successfully (ID: ${t.schedule_id})`}),C(""),w(""),I(""),A(""),U(""),V(""),O("")}catch(s){m.k.error("Failed to schedule deployment",s),e({title:"Error",description:s instanceof Error?s.message:"Failed to schedule deployment. Please try again.",variant:"destructive"})}};return t?(0,r.jsxs)("div",{className:"space-y-8 p-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-foreground flex items-center gap-3",children:[(0,r.jsx)(n.Z,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"}),"Schedule Deployment"]}),(0,r.jsx)("p",{className:"mt-2 text-muted-foreground",children:"Schedule deployment operations for future execution (one-time or recurring)"})]}),X&&(0,r.jsxs)(p.Alert,{className:"border-green-500 bg-green-50 dark:bg-green-950/20",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),(0,r.jsx)(p.AlertTitle,{className:"text-green-600 dark:text-green-400",children:"Deployment Scheduled Successfully"}),(0,r.jsxs)(p.AlertDescription,{className:"text-green-600 dark:text-green-400",children:["Schedule ID: ",X.schedule_id," | Type: ",X.schedule_type,X.next_run_at&&(0,r.jsxs)("div",{children:["Next execution: ",new Date(X.next_run_at).toLocaleString()]})]})]}),y&&(0,r.jsxs)(p.Alert,{variant:"destructive",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)(p.AlertTitle,{children:"Error"}),(0,r.jsx)(p.AlertDescription,{children:y.message})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsxs)(p.CardHeader,{children:[(0,r.jsx)(p.CardTitle,{children:"Schedule Details"}),(0,r.jsx)(p.CardDescription,{children:"Configure deployment operation and schedule"})]}),(0,r.jsx)(p.CardContent,{children:(0,r.jsxs)("form",{onSubmit:J,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.Label,{htmlFor:"operation",children:"Operation *"}),(0,r.jsxs)(p.Select,{value:b,onValueChange:e=>f(e),children:[(0,r.jsx)(p.SelectTrigger,{id:"operation",children:(0,r.jsx)(p.SelectValue,{})}),(0,r.jsxs)(p.SelectContent,{children:[(0,r.jsx)(p.SelectItem,{value:"provision",children:"Provision New Deployment"}),(0,r.jsx)(p.SelectItem,{value:"upgrade",children:"Upgrade Deployment"}),(0,r.jsx)(p.SelectItem,{value:"scale",children:"Scale Resources"}),(0,r.jsx)(p.SelectItem,{value:"suspend",children:"Suspend Deployment"}),(0,r.jsx)(p.SelectItem,{value:"resume",children:"Resume Deployment"}),(0,r.jsx)(p.SelectItem,{value:"destroy",children:"Destroy Deployment"})]})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:{provision:"Create a new deployment instance from a template",upgrade:"Upgrade deployment to a new version",scale:"Scale CPU, memory, or storage resources",suspend:"Temporarily suspend the deployment",resume:"Resume a suspended deployment",destroy:"Permanently destroy the deployment"}[b]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(p.Label,{children:"Schedule Type *"}),(0,r.jsxs)(p.RadioGroup,{value:S,onValueChange:e=>_(e),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(p.RadioGroupItem,{value:"one_time",id:"one_time"}),(0,r.jsx)(p.Label,{htmlFor:"one_time",className:"font-normal cursor-pointer",children:"One-Time (Execute once at specified time)"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(p.RadioGroupItem,{value:"recurring",id:"recurring"}),(0,r.jsx)(p.Label,{htmlFor:"recurring",className:"font-normal cursor-pointer",children:"Recurring (Execute on schedule)"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(p.Label,{htmlFor:"scheduled-at",children:["one_time"===S?"Execute At":"First Execution At"," *"]}),(0,r.jsx)(p.Input,{id:"scheduled-at",type:"datetime-local",value:N,onChange:e=>C(e.target.value),required:!0})]}),"recurring"===S&&(0,r.jsxs)(p.Tabs,{defaultValue:"cron",className:"w-full",children:[(0,r.jsxs)(p.TabsList,{className:"grid w-full grid-cols-2",children:[(0,r.jsx)(p.TabsTrigger,{value:"cron",children:"Cron Expression"}),(0,r.jsx)(p.TabsTrigger,{value:"interval",children:"Interval"})]}),(0,r.jsxs)(p.TabsContent,{value:"cron",className:"space-y-2 mt-4",children:[(0,r.jsx)(p.Label,{htmlFor:"cron",children:"Cron Expression"}),(0,r.jsx)(p.Input,{id:"cron",value:q,onChange:e=>{w(e.target.value),I("")},placeholder:"0 2 * * 0"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Format: minute hour day month weekday"}),(0,r.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:"Examples:"}),u.map(e=>(0,r.jsxs)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{w(e.value),I("")},className:"mr-2 mb-2",children:[e.label,": ",e.value]},e.value))]})]}),(0,r.jsxs)(p.TabsContent,{value:"interval",className:"space-y-2 mt-4",children:[(0,r.jsx)(p.Label,{htmlFor:"interval",children:"Interval (seconds)"}),(0,r.jsx)(p.Input,{id:"interval",type:"number",value:D,onChange:e=>{I(e.target.value),w("")},placeholder:"3600",min:"60",max:"2592000"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Min: 60 (1 minute), Max: 2,592,000 (30 days)"})]})]}),"provision"===b?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.Label,{htmlFor:"template",children:"Deployment Template *"}),(0,r.jsxs)(p.Select,{value:T,onValueChange:k,children:[(0,r.jsx)(p.SelectTrigger,{id:"template",children:(0,r.jsx)(p.SelectValue,{placeholder:"Choose a template..."})}),(0,r.jsx)(p.SelectContent,{children:B.map(e=>(0,r.jsxs)(p.SelectItem,{value:e.id.toString(),children:[e.display_name," (v",e.version,")"]},e.id))})]})]}):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.Label,{htmlFor:"instance",children:"Deployment Instance *"}),(0,r.jsxs)(p.Select,{value:E,onValueChange:P,children:[(0,r.jsx)(p.SelectTrigger,{id:"instance",children:(0,r.jsx)(p.SelectValue,{placeholder:"Choose an instance..."})}),(0,r.jsx)(p.SelectContent,{children:H.map(e=>(0,r.jsxs)(p.SelectItem,{value:e.id.toString(),children:["Instance #",e.id," - ",e.environment," (",e.state,")"]},e.id))})]})]}),"upgrade"===b&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.Label,{htmlFor:"version",children:"Target Version *"}),(0,r.jsx)(p.Input,{id:"version",value:F,onChange:e=>A(e.target.value),placeholder:"2.0.0",pattern:"\\\\d+\\\\.\\\\d+\\\\.\\\\d+",required:!0})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"rollback",checked:L,onChange:e=>R(e.target.checked)}),(0,r.jsx)(p.Label,{htmlFor:"rollback",className:"font-normal cursor-pointer",children:"Rollback on failure"})]})]}),"scale"===b&&(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.Label,{htmlFor:"cpu",children:"CPU Cores"}),(0,r.jsx)(p.Input,{id:"cpu",type:"number",value:M,onChange:e=>U(e.target.value),placeholder:"8",min:"1",max:"128"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.Label,{htmlFor:"memory",children:"Memory (GB)"}),(0,r.jsx)(p.Input,{id:"memory",type:"number",value:G,onChange:e=>V(e.target.value),placeholder:"32",min:"1",max:"512"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.Label,{htmlFor:"storage",children:"Storage (GB)"}),(0,r.jsx)(p.Input,{id:"storage",type:"number",value:Z,onChange:e=>O(e.target.value),placeholder:"500",min:"10",max:"10000"})]})]}),(0,r.jsx)("div",{className:"flex justify-end gap-3 pt-4",children:(0,r.jsx)(p.Button,{type:"submit",disabled:!(N&&("recurring"!==S||(q||D)&&(!q||5===q.trim().split(/\s+/).length))&&("provision"!==b||T)&&("provision"===b||E)&&("upgrade"!==b||F)&&("scale"!==b||M||G||Z))||v,children:v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Scheduling..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Z,{className:"mr-2 h-4 w-4"}),"Schedule Deployment"]})})})]})})]}),(0,r.jsxs)(p.Card,{className:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800",children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsxs)(p.CardTitle,{className:"text-blue-900 dark:text-blue-100 flex items-center gap-2",children:[(0,r.jsx)(c.Z,{className:"h-5 w-5"}),"Scheduling Information"]})}),(0,r.jsxs)(p.CardContent,{className:"text-blue-800 dark:text-blue-200 space-y-2",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"One-Time:"})," Deployment executes once at the specified time"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Recurring:"})," Deployment executes on schedule (cron or interval)"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Retry Policy:"})," Failed deployments retry up to 2 times with 5-minute delays"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Timeout:"})," Operations timeout after 1 hour"]})]})]})]}):(0,r.jsx)("div",{className:"p-8",children:(0,r.jsxs)(p.Alert,{variant:"destructive",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)(p.AlertTitle,{children:"Access Denied"}),(0,r.jsx)(p.AlertDescription,{children:"You don't have permission to schedule deployments."})]})})}},85888:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/orchestration/schedule/page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(76972));module.exports=r})();