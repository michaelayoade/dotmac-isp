(()=>{var e={};e.id=5313,e.ids=[5313],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},23023:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),s(17054),s(13321),s(46366),s(96560);var r=s(23191),a=s(88716),o=s(37922),n=s.n(o),i=s(95231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let d=["",{children:["dashboard",{children:["orchestration",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,17054)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/orchestration/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],c=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/orchestration/page.tsx"],u="/dashboard/orchestration/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/orchestration/page",pathname:"/dashboard/orchestration",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},39919:(e,t,s)=>{Promise.resolve().then(s.bind(s,767))},767:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>q});var r=s(10326),a=s(17577),o=s(66307),n=s(77506),i=s(69669),l=s(54689),d=s(48998),c=s(66697),u=s(17069),m=s(72795),x=s(41291),p=s(12714),f=s(21405),h=s(71059),g=s(94893),w=s(57252);function j(e,t){if(!e)return"N/A";let s=new Date(e).getTime(),r=Math.floor(((t?new Date(t).getTime():Date.now())-s)/1e3);return r<60?`${r}s`:r<3600?`${Math.floor(r/60)}m ${r%60}s`:`${Math.floor(r/3600)}h ${Math.floor(r%3600/60)}m`}function b(e){return e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function N(e){switch(e){case"completed":return"text-green-600 bg-green-50 dark:text-green-400 dark:bg-green-950";case"running":return"text-blue-600 bg-blue-50 dark:text-blue-400 dark:bg-blue-950";case"failed":return"text-red-600 bg-red-50 dark:text-red-400 dark:bg-red-950";case"rolling_back":case"rolled_back":return"text-orange-600 bg-orange-50 dark:text-orange-400 dark:bg-orange-950";default:return"text-gray-600 bg-gray-50 dark:text-gray-400 dark:bg-gray-950"}}function v(e){switch(e){case"completed":return o.Z;case"running":return n.Z;case"failed":return i.Z;case"rolling_back":case"rolled_back":return l.Z;case"pending":return d.Z;default:return c.Z}}function y({title:e,value:t,subtitle:s,icon:a,trend:o}){return(0,r.jsx)("div",{className:"rounded-lg border border-border bg-card p-6",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:e}),(0,r.jsx)("p",{className:"mt-2 text-3xl font-bold text-foreground",children:t}),s&&(0,r.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:s}),void 0!==o&&(0,r.jsxs)("div",{className:`mt-2 flex items-center text-sm ${o>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[(0,r.jsx)(u.Z,{className:`h-4 w-4 mr-1 ${o<0?"rotate-180":""}`}),Math.abs(o).toFixed(1),"%"]})]}),(0,r.jsx)("div",{className:"p-3 bg-muted rounded-lg",children:(0,r.jsx)(a,{className:"h-6 w-6 text-muted-foreground"})})]})})}function k({workflowId:e,onClose:t}){let s=(0,w.DW)(e,!0),a=s.data;if(s.isLoading||!a)return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{className:"bg-card rounded-lg p-8 max-w-4xl w-full mx-4",children:(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)(n.Z,{className:"h-8 w-8 animate-spin text-primary"})})})});let o=v(a.status);return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"bg-card rounded-lg p-6 max-w-5xl w-full mx-4 my-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Workflow Details"}),(0,r.jsx)("button",{onClick:t,className:"p-2 hover:bg-muted rounded-lg transition-colors",children:(0,r.jsx)(m.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Workflow ID"}),(0,r.jsx)("p",{className:"font-mono text-sm mt-1",children:a.workflow_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Type"}),(0,r.jsx)("p",{className:"font-medium mt-1",children:b(a.workflow_type)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,r.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,r.jsxs)("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${N(a.status)}`,children:[(0,r.jsx)(o,{className:`h-3.5 w-3.5 ${"running"===a.status?"animate-spin":""}`}),a.status.toUpperCase()]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Duration"}),(0,r.jsx)("p",{className:"font-medium mt-1",children:j(a.started_at,a.completed_at||a.failed_at)})]})]}),a.error_message&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(x.Z,{className:"h-5 w-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-red-900 dark:text-red-100",children:"Error"}),(0,r.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:a.error_message})]})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Workflow Steps"}),(0,r.jsx)("div",{className:"space-y-3",children:a.steps?.map((e,t)=>{let s=v(e.status);return r.jsxs("div",{className:"flex items-start gap-4 p-4 border border-border rounded-lg",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full ${N(e.status)}`,children:r.jsx(s,{className:`h-4 w-4 ${"running"===e.status?"animate-spin":""}`})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-foreground",children:e.step_name}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.target_system," â€¢ ",e.step_type]})]}),r.jsx("div",{className:"text-sm text-muted-foreground",children:j(e.started_at,e.completed_at||e.failed_at)})]}),e.error_message&&r.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-2",children:e.error_message})]})]},e.id)})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold mb-2",children:"Input Data"}),(0,r.jsx)("pre",{className:"text-xs bg-muted p-3 rounded-lg overflow-x-auto",children:JSON.stringify(a.input_data,null,2)})]}),a.output_data&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold mb-2",children:"Output Data"}),(0,r.jsx)("pre",{className:"text-xs bg-muted p-3 rounded-lg overflow-x-auto",children:JSON.stringify(a.output_data,null,2)})]})]})]})})}function _({workflows:e,loading:t,onViewDetails:s,onRetry:a,onCancel:o}){return t?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)(n.Z,{className:"h-8 w-8 animate-spin text-primary"})}):0===e.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,r.jsx)(c.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("p",{className:"text-lg font-medium text-foreground",children:"No workflows found"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Workflows will appear here once created"})]}):(0,r.jsx)("div",{className:"space-y-3",children:e.map(e=>{let t=v(e.status);return(0,r.jsxs)("div",{className:"flex items-center gap-4 p-4 border border-border rounded-lg hover:border-primary/50 transition-colors",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${N(e.status)}`,children:(0,r.jsx)(t,{className:`h-5 w-5 ${"running"===e.status?"animate-spin":""}`})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"font-medium text-foreground",children:b(e.workflow_type)}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["#",e.workflow_id.slice(0,8)]})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.started_at?(0,r.jsxs)(r.Fragment,{children:["Started ",new Date(e.started_at).toLocaleString()]}):(0,r.jsxs)(r.Fragment,{children:["Created ",new Date(e.created_at).toLocaleString()]})})]}),(0,r.jsxs)("div",{className:"flex-shrink-0 text-right",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-foreground",children:j(e.started_at,e.completed_at||e.failed_at)}),e.steps&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.steps.filter(e=>"completed"===e.status).length,"/",e.steps.length," steps"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>s(e.workflow_id),className:"p-2 hover:bg-muted rounded-lg transition-colors",title:"View details",children:(0,r.jsx)(p.Z,{className:"h-4 w-4"})}),"failed"===e.status&&(0,r.jsx)("button",{onClick:()=>a(e.workflow_id),className:"p-2 hover:bg-muted rounded-lg transition-colors text-orange-600",title:"Retry workflow",children:(0,r.jsx)(f.Z,{className:"h-4 w-4"})}),"running"===e.status&&(0,r.jsx)("button",{onClick:()=>o(e.workflow_id),className:"p-2 hover:bg-muted rounded-lg transition-colors text-red-600",title:"Cancel workflow",children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})})]})]},e.id)})})}function q(){let[e,t]=(0,a.useState)(!0),[s,l]=(0,a.useState)(null),{data:d,isLoading:u,refetch:m}=(0,w.lv)(),{data:x,isLoading:p,refetch:j}=(0,w.D)({status:"running",autoRefresh:e,refreshInterval:3e3}),b=x?.workflows??[],{data:N,isLoading:v,refetch:q}=(0,w.D)({status:"failed",pageSize:10}),D=N?.workflows??[],{retryWorkflow:P}=(0,w.zE)(),{cancelWorkflow:F}=(0,w.el)(),Z=async e=>{await P(e)&&(q(),m())},$=async e=>{await F(e)&&(j(),m())};return(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Orchestration Monitor"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-1",children:"Track multi-system workflow execution in real-time"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:()=>t(!e),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${e?"bg-primary text-primary-foreground":"bg-muted text-foreground hover:bg-muted/80"}`,children:[e?(0,r.jsx)(h.Z,{className:"h-4 w-4"}):(0,r.jsx)(g.Z,{className:"h-4 w-4"}),"Auto-refresh"]}),(0,r.jsxs)("button",{onClick:()=>{m(),j(),q()},className:"flex items-center gap-2 px-4 py-2 bg-muted hover:bg-muted/80 text-foreground rounded-lg transition-colors",children:[(0,r.jsx)(f.Z,{className:"h-4 w-4"}),"Refresh"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)(y,{title:"Total Workflows",value:d?.total||0,icon:c.Z}),(0,r.jsx)(y,{title:"Running",value:d?.running||0,subtitle:`${d?.pending||0} pending`,icon:n.Z}),(0,r.jsx)(y,{title:"Completed",value:d?.completed||0,subtitle:d?.success_rate?`${d.success_rate.toFixed(1)}% success rate`:void 0,icon:o.Z}),(0,r.jsx)(y,{title:"Failed",value:d?.failed||0,subtitle:d?.avg_duration_seconds?`${d.avg_duration_seconds.toFixed(1)}s avg`:void 0,icon:i.Z})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:"Active Workflows"}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:[b.length," running"]})]}),(0,r.jsx)("div",{className:"border border-border rounded-lg p-4 bg-card",children:(0,r.jsx)(_,{workflows:b,loading:p,onViewDetails:l,onRetry:Z,onCancel:$})})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:"Failed Workflows"}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:[D.length," failed"]})]}),(0,r.jsx)("div",{className:"border border-border rounded-lg p-4 bg-card",children:(0,r.jsx)(_,{workflows:D,loading:v,onViewDetails:l,onRetry:Z,onCancel:$})})]}),s&&(0,r.jsx)(k,{workflowId:s,onClose:()=>l(null)})]})}},57252:(e,t,s)=>{"use strict";s.d(t,{D:()=>u,DW:()=>m,el:()=>p,lv:()=>c,zE:()=>x});var r=s(48324),a=s(44976),o=s(17010),n=s(59341),i=s(29771);let l={all:["orchestration"],stats:()=>[...l.all,"stats"],workflows:e=>[...l.all,"workflows",e],workflow:e=>[...l.all,"workflow",e]};function d(e){e.invalidateQueries({predicate:e=>{let t=e.queryKey;return t?.[0]==="orchestration"&&t?.[1]==="workflows"}})}function c(){return(0,r.a)({queryKey:l.stats(),queryFn:async()=>{try{return(await n.x1.get("orchestration/statistics")).data}catch(e){throw i.k.error("Failed to fetch orchestration stats",e),Error(e.response?.data?.detail||"Failed to fetch statistics")}},staleTime:3e4,refetchOnWindowFocus:!0})}function u(e={}){let{status:t,workflowType:s,page:a=1,pageSize:o=20,autoRefresh:d=!1,refreshInterval:c=5e3}=e;return(0,r.a)({queryKey:l.workflows({status:t,workflowType:s,page:a,pageSize:o}),queryFn:async()=>{try{let e={page:a,page_size:o};return t&&(e.status=t),s&&(e.workflow_type=s),(await n.x1.get("orchestration/workflows",{params:e})).data}catch(e){throw i.k.error("Failed to fetch workflows",e),Error(e.response?.data?.detail||"Failed to fetch workflows")}},staleTime:1e4,refetchInterval:!!d&&c,refetchOnWindowFocus:!0})}function m(e,t=!1){return(0,r.a)({queryKey:l.workflow(e??""),queryFn:async()=>{if(!e)return null;try{return(await n.x1.get(`/orchestration/workflows/${e}`)).data}catch(e){throw i.k.error("Failed to fetch workflow",e),Error(e.response?.data?.detail||"Failed to fetch workflow")}},enabled:!!e,staleTime:2e3,refetchInterval:e=>!!t&&!!e.state.data&&!["completed","failed","rolled_back","rollback_failed","timeout","compensated"].includes(e.state.data.status)&&2e3,refetchOnWindowFocus:!0})}function x(){let e=(0,a.NL)(),t=(0,o.D)({mutationFn:async e=>(await n.x1.post(`/orchestration/workflows/${e}/retry`),e),onSuccess:t=>{e.invalidateQueries({queryKey:l.workflow(t)}),d(e),e.invalidateQueries({queryKey:l.stats()})},onError:e=>{i.k.error("Failed to retry workflow",e)}});return{retryWorkflow:t.mutateAsync,loading:t.isPending,error:t.error?String(t.error):null}}function p(){let e=(0,a.NL)(),t=(0,o.D)({mutationFn:async e=>(await n.x1.post(`/orchestration/workflows/${e}/cancel`),e),onSuccess:t=>{e.invalidateQueries({queryKey:l.workflow(t)}),d(e),e.invalidateQueries({queryKey:l.stats()})},onError:e=>{i.k.error("Failed to cancel workflow",e)}});return{cancelWorkflow:t.mutateAsync,loading:t.isPending,error:t.error?String(t.error):null}}},17054:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/orchestration/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[2793,1009,6226,657,6032,4218],()=>s(23023));module.exports=r})();