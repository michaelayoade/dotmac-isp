(()=>{var e={};e.id=4484,e.ids=[4484],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},89075:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>x,tree:()=>d}),t(24864),t(13321),t(46366),t(96560);var r=t(23191),a=t(88716),i=t(37922),n=t.n(i),l=t(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let d=["",{children:["dashboard",{children:["billing-revenue",{children:["pricing",{children:["simulator",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,24864)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/pricing/simulator/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/pricing/simulator/page.tsx"],u="/dashboard/billing-revenue/pricing/simulator/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/billing-revenue/pricing/simulator/page",pathname:"/dashboard/billing-revenue/pricing/simulator",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},69999:(e,s,t)=>{Promise.resolve().then(t.bind(t,36620))},36620:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var r=t(10326),a=t(17577),i=t(17010),n=t(48723),l=t(86333),c=t(54689),d=t(77506),o=t(72257),u=t(40765),m=t(71821),x=t(29163),p=t(25276),h=t(35047),j=t(59341),g=t(93158);function b(){let{toast:e}=(0,n.useToast)(),s=(0,h.useRouter)(),[t,b]=(0,a.useState)(null),{api:f}=(0,g.M)(),N=f.baseUrl,[v,y]=(0,a.useState)({product_id:"",customer_id:"",quantity:"1",customer_segments:"",currency:"USD"}),_=(0,i.D)({mutationFn:async e=>(await j.x1.post(`${N}/api/v1/billing/pricing/calculate`,e)).data,onSuccess:s=>{b(s),e({title:"Success",description:"Price calculated successfully"})},onError:s=>{e({title:"Error",description:s.response?.data?.message||"Failed to calculate price",variant:"destructive"})}}),C=()=>{if(!v.product_id||!v.customer_id||!v.quantity){e({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}let s=parseInt(v.quantity);if(isNaN(s)||s<1){e({title:"Validation Error",description:"Quantity must be a positive number",variant:"destructive"});return}let t=v.customer_segments?v.customer_segments.split(",").map(e=>e.trim()):void 0,r={product_id:v.product_id,customer_id:v.customer_id,quantity:s,currency:v.currency,...t&&{customer_segments:t}};_.mutate(r)},w=(e,s="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:s,minimumFractionDigits:2,maximumFractionDigits:2}).format(e),P=e=>{let{label:s,className:t}={percentage:{label:"Percentage",className:"bg-blue-500"},fixed_amount:{label:"Fixed Amount",className:"bg-green-500"},fixed_price:{label:"Fixed Price",className:"bg-purple-500"}}[e];return(0,r.jsx)(n.Badge,{className:t,children:s})},T=t&&t.subtotal>0?t.total_discount_amount/t.subtotal*100:0;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(n.Button,{variant:"ghost",onClick:()=>s.back(),children:[(0,r.jsx)(l.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Price Simulator"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Test pricing rules and see how discounts are applied"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(n.Button,{variant:"outline",onClick:()=>{y({product_id:"",customer_id:"",quantity:"1",customer_segments:"",currency:"USD"}),b(null)},children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Clear"]}),(0,r.jsx)(n.Button,{onClick:C,disabled:_.isPending,children:_.isPending?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Calculating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Run Simulation"]})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(n.Card,{children:[(0,r.jsx)(n.CardHeader,{children:(0,r.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5"}),"Simulation Parameters"]})}),(0,r.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(n.Label,{htmlFor:"product_id",children:["Product ID ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(n.Input,{id:"product_id",value:v.product_id,onChange:e=>y({...v,product_id:e.target.value}),placeholder:"e.g., prod_123456"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"The unique identifier of the product to price"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(n.Label,{htmlFor:"customer_id",children:["Customer ID ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(n.Input,{id:"customer_id",value:v.customer_id,onChange:e=>y({...v,customer_id:e.target.value}),placeholder:"e.g., cust_123456"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"The customer who will purchase this product"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(n.Label,{htmlFor:"quantity",children:["Quantity ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(n.Input,{id:"quantity",type:"number",min:"1",value:v.quantity,onChange:e=>y({...v,quantity:e.target.value}),placeholder:"1"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Number of units to purchase"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.Label,{htmlFor:"customer_segments",children:"Customer Segments"}),(0,r.jsx)(n.Input,{id:"customer_segments",value:v.customer_segments,onChange:e=>y({...v,customer_segments:e.target.value}),placeholder:"e.g., vip, enterprise"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Comma-separated list of customer segments (optional)"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.Label,{htmlFor:"currency",children:"Currency"}),(0,r.jsxs)(n.Select,{value:v.currency,onValueChange:e=>y({...v,currency:e}),children:[(0,r.jsx)(n.SelectTrigger,{id:"currency",children:(0,r.jsx)(n.SelectValue,{})}),(0,r.jsxs)(n.SelectContent,{children:[(0,r.jsx)(n.SelectItem,{value:"USD",children:"USD - US Dollar"}),(0,r.jsx)(n.SelectItem,{value:"EUR",children:"EUR - Euro"}),(0,r.jsx)(n.SelectItem,{value:"GBP",children:"GBP - British Pound"})]})]})]}),(0,r.jsx)("div",{className:"pt-4 border-t",children:(0,r.jsx)(n.Button,{className:"w-full",onClick:C,disabled:_.isPending,children:_.isPending?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Calculating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Calculate Price"]})})})]})]}),t?(0,r.jsxs)(n.Card,{children:[(0,r.jsx)(n.CardHeader,{children:(0,r.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{className:"h-5 w-5"}),"Calculation Results"]})}),(0,r.jsxs)(n.CardContent,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Base Price"}),(0,r.jsx)("span",{className:"font-medium",children:w(t.base_price,t.currency)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Quantity"}),(0,r.jsxs)("span",{className:"font-medium",children:["\xd7 ",t.quantity]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,r.jsx)("span",{className:"font-semibold",children:w(t.subtotal,t.currency)})]}),t.total_discount_amount>0&&(0,r.jsxs)("div",{className:"flex justify-between items-center text-green-600",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4"}),"Total Discount"]}),(0,r.jsxs)("span",{className:"font-semibold",children:["-",w(t.total_discount_amount,t.currency)]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center pt-3 border-t",children:[(0,r.jsx)("span",{className:"text-lg font-semibold",children:"Final Price"}),(0,r.jsx)("span",{className:"text-2xl font-bold text-primary",children:w(t.final_price,t.currency)})]})]}),t.total_discount_amount>0&&(0,r.jsx)("div",{className:"p-4 bg-green-50 dark:bg-green-950 rounded-lg border border-green-200 dark:border-green-800",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"Total Savings"}),(0,r.jsxs)("div",{className:"text-xs text-green-700 dark:text-green-300 mt-1",children:[T.toFixed(1),"% discount applied"]})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-green-900 dark:text-green-100",children:w(t.total_discount_amount,t.currency)})]})}),(0,r.jsxs)("div",{className:"pt-4 border-t space-y-2 text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Product ID:"}),(0,r.jsx)("span",{className:"font-mono",children:t.product_id})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Customer ID:"}),(0,r.jsx)("span",{className:"font-mono",children:t.customer_id})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Currency:"}),(0,r.jsx)("span",{children:t.currency})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Calculated at:"}),(0,r.jsx)("span",{children:new Date(t.calculation_timestamp).toLocaleString()})]})]})]})]}):(0,r.jsx)(n.Card,{children:(0,r.jsx)(n.CardContent,{className:"flex items-center justify-center h-full min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,r.jsx)(o.Z,{className:"h-16 w-16 mx-auto mb-4 opacity-20"}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"No Calculation Yet"}),(0,r.jsx)("p",{className:"text-sm mt-2",children:'Fill in the parameters and click "Calculate Price" to see results'})]})})})]}),t&&t.applied_adjustments.length>0&&(0,r.jsxs)(n.Card,{children:[(0,r.jsx)(n.CardHeader,{children:(0,r.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,r.jsx)(p.Z,{className:"h-5 w-5"}),"Applied Pricing Rules"]})}),(0,r.jsx)(n.CardContent,{children:(0,r.jsxs)(n.Table,{children:[(0,r.jsx)(n.TableHeader,{children:(0,r.jsxs)(n.TableRow,{children:[(0,r.jsx)(n.TableHead,{children:"Rule Name"}),(0,r.jsx)(n.TableHead,{children:"Discount Type"}),(0,r.jsx)(n.TableHead,{children:"Discount Value"}),(0,r.jsx)(n.TableHead,{children:"Original Price"}),(0,r.jsx)(n.TableHead,{children:"Discount Amount"}),(0,r.jsx)(n.TableHead,{children:"Adjusted Price"})]})}),(0,r.jsx)(n.TableBody,{children:t.applied_adjustments.map((e,s)=>(0,r.jsxs)(n.TableRow,{children:[(0,r.jsxs)(n.TableCell,{children:[(0,r.jsx)("div",{className:"font-medium",children:e.rule_name}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground font-mono",children:e.rule_id})]}),(0,r.jsx)(n.TableCell,{children:P(e.discount_type)}),(0,r.jsx)(n.TableCell,{children:(0,r.jsx)("div",{className:"font-medium",children:"percentage"===e.discount_type?`${e.discount_value}%`:w(e.discount_value,t.currency)})}),(0,r.jsx)(n.TableCell,{children:w(e.original_price,t.currency)}),(0,r.jsx)(n.TableCell,{children:(0,r.jsxs)("span",{className:"text-green-600 font-medium",children:["-",w(e.discount_amount,t.currency)]})}),(0,r.jsx)(n.TableCell,{children:(0,r.jsx)("span",{className:"font-semibold",children:w(e.adjusted_price,t.currency)})})]},`${e.rule_id}-${s}`))})]})})]}),t&&t.total_discount_amount>0&&(0,r.jsxs)(n.Card,{children:[(0,r.jsx)(n.CardHeader,{children:(0,r.jsx)(n.CardTitle,{children:"Price Breakdown"})}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Original Subtotal"}),(0,r.jsxs)("span",{className:"font-medium",children:[w(t.subtotal,t.currency)," (100%)"]})]}),(0,r.jsx)("div",{className:"w-full h-8 bg-gray-300 dark:bg-gray-700 rounded-md"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,r.jsx)("span",{className:"text-green-600",children:"Discount Applied"}),(0,r.jsxs)("span",{className:"font-medium text-green-600",children:["-",w(t.total_discount_amount,t.currency)," ","(",T.toFixed(1),"%)"]})]}),(0,r.jsx)("div",{className:"w-full h-8 bg-green-500 dark:bg-green-600 rounded-md",style:{width:`${T}%`}})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Final Price"}),(0,r.jsxs)("span",{className:"font-bold text-primary",children:[w(t.final_price,t.currency)," (",(100-T).toFixed(1),"%)"]})]}),(0,r.jsx)("div",{className:"w-full h-8 bg-blue-500 dark:bg-blue-600 rounded-md",style:{width:`${100-T}%`}})]})]}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-accent rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm font-medium mb-2",children:"Summary"}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[t.applied_adjustments.length," pricing rule(s) were applied, resulting in a total discount of"," ",w(t.total_discount_amount,t.currency)," (",T.toFixed(1),"% off). The customer saves money while you maintain competitive pricing."]})]})]})]}),t&&0===t.applied_adjustments.length&&(0,r.jsx)(n.Card,{children:(0,r.jsx)(n.CardContent,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(u.Z,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-20"}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"No Pricing Rules Applied"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"The calculated price is the base price with no discounts. This may be because:"}),(0,r.jsxs)("ul",{className:"text-sm text-muted-foreground mt-4 space-y-1 inline-block text-left",children:[(0,r.jsx)("li",{children:"• No active pricing rules match this product"}),(0,r.jsx)("li",{children:"• The customer doesn't meet the eligibility criteria"}),(0,r.jsx)("li",{children:"• Quantity requirements weren't met"}),(0,r.jsx)("li",{children:"• Pricing rules have reached their usage limits"})]})]})})})]})}},24864:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/pricing/simulator/page.tsx#default`)}};var s=require("../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(89075));module.exports=r})();