(()=>{var e={};e.id=357,e.ids=[357],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},34932:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>c}),t(13538),t(13321),t(46366),t(96560);var r=t(23191),a=t(88716),i=t(37922),n=t.n(i),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let c=["",{children:["dashboard",{children:["billing-revenue",{children:["dunning",{children:["campaigns",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,13538)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/dunning/campaigns/[id]/page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/dunning/campaigns/[id]/page.tsx"],x="/dashboard/billing-revenue/dunning/campaigns/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/billing-revenue/dunning/campaigns/[id]/page",pathname:"/dashboard/billing-revenue/dunning/campaigns/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},29311:(e,s,t)=>{Promise.resolve().then(t.bind(t,99622))},99622:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>$});var r=t(10326),a=t(17577),i=t(44976),n=t(48324),l=t(17010),d=t(35047),c=t(48723),o=t(20892),x=t(93158),m=t(5932),u=t(40617),h=t(30123),p=t(69669),j=t(70600),g=t(88378),f=t(3634),v=t(21405),y=t(41291),b=t(86333),N=t(69508),C=t(98295),_=t(85962),w=t(98091),T=t(66697),F=t(17069),D=t(71821),P=t(48998),E=t(90434),A=t(74723),q=t(74064),H=t(770),Z=t(34041),k=t(90960);let S=H.Ry({name:H.Z_().min(1,"Name is required"),description:H.Z_().optional(),trigger_after_days:H.oQ.number().min(1,"Must be at least 1 day"),max_retries:H.oQ.number().min(1,"Must be at least 1"),retry_interval_days:H.oQ.number().min(1,"Must be at least 1 day"),priority:H.oQ.number().min(1).max(100),is_active:H.O7().default(!0)}),I=e=>`$${(e/100).toFixed(2)}`,B=e=>{switch(e){case"email":return(0,r.jsx)(m.Z,{className:"h-4 w-4"});case"sms":return(0,r.jsx)(u.Z,{className:"h-4 w-4"});case"suspend_service":return(0,r.jsx)(h.Z,{className:"h-4 w-4"});case"terminate_service":return(0,r.jsx)(p.Z,{className:"h-4 w-4"});case"webhook":return(0,r.jsx)(j.Z,{className:"h-4 w-4"});case"custom":return(0,r.jsx)(g.Z,{className:"h-4 w-4"});default:return(0,r.jsx)(f.Z,{className:"h-4 w-4"})}},M=e=>{switch(e){case"pending":case"canceled":return"secondary";case"in_progress":default:return"default";case"completed":return"outline";case"failed":return"destructive"}},R=e=>{switch(e){case"pending":return"text-yellow-600";case"in_progress":return"text-blue-600";case"completed":return"text-green-600";case"failed":return"text-red-600";default:return"text-gray-600"}};function U(){let e=(0,d.useParams)(),s=(0,d.useRouter)(),{toast:t}=(0,c.useToast)(),o=(0,i.NL)(),m=e.id,{api:u}=(0,x.M)(),j=u.baseUrl||"",[g,f]=(0,a.useState)(!1),[H,U]=(0,a.useState)(!1),{data:$,isLoading:L}=(0,n.a)({queryKey:["dunning","campaigns",m,j],queryFn:async()=>{let e=await fetch(`${j}/api/v1/billing/dunning/campaigns/${m}`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch campaign");return e.json()},refetchInterval:3e4}),{data:O,isLoading:Q}=(0,n.a)({queryKey:["dunning","campaigns",m,"stats",j],queryFn:async()=>{let e=await fetch(`${j}/api/v1/billing/dunning/campaigns/${m}/stats`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch campaign stats");return e.json()},refetchInterval:3e4}),{data:V=[],isLoading:K}=(0,n.a)({queryKey:["dunning","campaigns",m,"executions",j],queryFn:async()=>{let e=await fetch(`${j}/api/v1/billing/dunning/executions?campaign_id=${m}`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch executions");return e.json()},refetchInterval:3e4}),z=(0,A.cI)({resolver:(0,q.F)(S),...$&&{values:{name:$.name,description:$.description||"",trigger_after_days:$.trigger_after_days,max_retries:$.max_retries,retry_interval_days:$.retry_interval_days,priority:$.priority,is_active:$.is_active}}}),G=(0,l.D)({mutationFn:async e=>{let s=await fetch(`${j}/api/v1/billing/dunning/campaigns/${m}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error("Failed to update campaign");return s.json()},onSuccess:()=>{o.invalidateQueries({queryKey:["dunning","campaigns",m]}),o.invalidateQueries({queryKey:["dunning","campaigns"]}),f(!1),t({title:"Success",description:"Campaign updated successfully"})},onError:()=>{t({title:"Error",description:"Failed to update campaign",variant:"destructive"})}}),J=(0,l.D)({mutationFn:async()=>{if(!(await fetch(`${j}/api/v1/billing/dunning/campaigns/${m}`,{method:"DELETE",credentials:"include"})).ok)throw Error("Failed to delete campaign")},onSuccess:()=>{t({title:"Success",description:"Campaign deleted successfully"}),s.push("/dashboard/billing-revenue/dunning/campaigns")},onError:()=>{t({title:"Error",description:"Failed to delete campaign",variant:"destructive"})}}),W=(0,l.D)({mutationFn:async e=>{let s=await fetch(`${j}/api/v1/billing/dunning/campaigns/${m}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:e})});if(!s.ok)throw Error("Failed to update campaign");return s.json()},onSuccess:()=>{o.invalidateQueries({queryKey:["dunning","campaigns",m]}),o.invalidateQueries({queryKey:["dunning","campaigns"]}),t({title:"Success",description:"Campaign status updated successfully"})},onError:()=>{t({title:"Error",description:"Failed to update campaign status",variant:"destructive"})}});return L?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)(v.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):$?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(c.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,r.jsx)(E.default,{href:"/dashboard/billing-revenue/dunning/campaigns",children:(0,r.jsx)(b.Z,{className:"h-4 w-4"})})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:$.name}),(0,r.jsx)(c.Badge,{variant:$.is_active?"default":"secondary",children:$.is_active?"Active":"Inactive"}),(0,r.jsxs)(c.Badge,{variant:"outline",children:["P",$.priority]})]}),$.description&&(0,r.jsx)("p",{className:"text-muted-foreground",children:$.description})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(c.Button,{variant:"outline",size:"icon",onClick:()=>{o.invalidateQueries({queryKey:["dunning","campaigns",m]}),t({title:"Refreshed",description:"Campaign data has been refreshed"})},children:(0,r.jsx)(v.Z,{className:"h-4 w-4"})})})]}),(0,r.jsxs)(c.Card,{children:[(0,r.jsx)(c.CardHeader,{children:(0,r.jsx)(c.CardTitle,{children:"Quick Actions"})}),(0,r.jsx)(c.CardContent,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(c.Button,{onClick:()=>f(!0),children:[(0,r.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Edit Campaign"]}),(0,r.jsx)(c.Button,{variant:$.is_active?"destructive":"default",onClick:()=>W.mutate(!$.is_active),children:$.is_active?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.Z,{className:"h-4 w-4 mr-2"}),"Deactivate"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Z,{className:"h-4 w-4 mr-2"}),"Activate"]})}),(0,r.jsxs)(c.Button,{variant:"destructive",onClick:()=>U(!0),children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})})]}),(0,r.jsxs)(c.Tabs,{defaultValue:"overview",className:"space-y-4",children:[(0,r.jsxs)(c.TabsList,{children:[(0,r.jsx)(c.TabsTrigger,{value:"overview",children:"Overview"}),(0,r.jsx)(c.TabsTrigger,{value:"actions",children:"Actions"}),(0,r.jsx)(c.TabsTrigger,{value:"statistics",children:"Statistics"}),(0,r.jsx)(c.TabsTrigger,{value:"executions",children:"Executions"})]}),(0,r.jsxs)(c.TabsContent,{value:"overview",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)(c.Card,{children:[(0,r.jsx)(c.CardHeader,{children:(0,r.jsx)(c.CardTitle,{children:"Campaign Information"})}),(0,r.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Name"}),(0,r.jsx)("div",{className:"font-medium",children:$.name})]}),$.description&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Description"}),(0,r.jsx)("div",{className:"font-medium",children:$.description})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Priority"}),(0,r.jsxs)(c.Badge,{variant:"outline",children:["P",$.priority]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Status"}),(0,r.jsx)(c.Badge,{variant:$.is_active?"default":"secondary",children:$.is_active?"Active":"Inactive"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Created"}),(0,r.jsx)("div",{className:"font-medium",children:(0,Z.WU)(new Date($.created_at),"PPP")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Last Updated"}),(0,r.jsx)("div",{className:"font-medium",children:(0,k.Q)(new Date($.updated_at),{addSuffix:!0})})]})]})]}),(0,r.jsxs)(c.Card,{children:[(0,r.jsx)(c.CardHeader,{children:(0,r.jsx)(c.CardTitle,{children:"Trigger & Retry Settings"})}),(0,r.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Trigger After Payment Failure"}),(0,r.jsxs)("div",{className:"font-medium",children:[$.trigger_after_days," days"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Maximum Retries"}),(0,r.jsx)("div",{className:"font-medium",children:$.max_retries})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Retry Interval"}),(0,r.jsxs)("div",{className:"font-medium",children:[$.retry_interval_days," days"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Actions Configured"}),(0,r.jsx)("div",{className:"font-medium",children:$.actions.length})]})]})]})]}),$.exclusion_rules&&Object.keys($.exclusion_rules).length>0&&(0,r.jsxs)(c.Card,{children:[(0,r.jsx)(c.CardHeader,{children:(0,r.jsx)(c.CardTitle,{children:"Exclusion Rules"})}),(0,r.jsxs)(c.CardContent,{className:"space-y-4",children:[$.exclusion_rules.min_lifetime_value&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Minimum Lifetime Value"}),(0,r.jsx)("div",{className:"font-medium",children:I($.exclusion_rules.min_lifetime_value)})]}),$.exclusion_rules.customer_tiers&&$.exclusion_rules.customer_tiers.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Excluded Customer Tiers"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:$.exclusion_rules.customer_tiers.map(e=>(0,r.jsx)(c.Badge,{variant:"outline",children:e},e))})]}),$.exclusion_rules.customer_tags&&$.exclusion_rules.customer_tags.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Excluded Customer Tags"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:$.exclusion_rules.customer_tags.map(e=>(0,r.jsx)(c.Badge,{variant:"outline",children:e},e))})]})]})]})]}),(0,r.jsx)(c.TabsContent,{value:"actions",className:"space-y-4",children:(0,r.jsxs)(c.Card,{children:[(0,r.jsx)(c.CardHeader,{children:(0,r.jsx)(c.CardTitle,{children:"Dunning Actions"})}),(0,r.jsx)(c.CardContent,{children:0===$.actions.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,r.jsx)(y.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"No actions configured for this campaign"})]}):(0,r.jsxs)(c.Table,{children:[(0,r.jsx)(c.TableHeader,{children:(0,r.jsxs)(c.TableRow,{children:[(0,r.jsx)(c.TableHead,{children:"Step"}),(0,r.jsx)(c.TableHead,{children:"Action Type"}),(0,r.jsx)(c.TableHead,{children:"Delay"}),(0,r.jsx)(c.TableHead,{children:"Configuration"})]})}),(0,r.jsx)(c.TableBody,{children:$.actions.map((e,s)=>(0,r.jsxs)(c.TableRow,{children:[(0,r.jsx)(c.TableCell,{children:(0,r.jsx)(c.Badge,{variant:"outline",children:s+1})}),(0,r.jsx)(c.TableCell,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[B(e.type),(0,r.jsx)("span",{className:"capitalize",children:e.type.replace(/_/g," ")})]})}),(0,r.jsxs)(c.TableCell,{children:[e.delay_days," days"]}),(0,r.jsxs)(c.TableCell,{children:[e.template&&(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Template: "}),e.template]}),e.webhook_url&&(0,r.jsx)("div",{className:"text-sm font-mono",children:e.webhook_url}),e.custom_config&&Object.keys(e.custom_config).length>0&&(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Custom configuration"})]})]},s))})]})})]})}),(0,r.jsxs)(c.TabsContent,{value:"statistics",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)(c.Card,{children:[(0,r.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Total Executions"}),(0,r.jsx)(T.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(c.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:O?.total_executions??0}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[O?.active_executions??0," active"]})]})]}),(0,r.jsxs)(c.Card,{children:[(0,r.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Success Rate"}),(0,r.jsx)(F.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(c.CardContent,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[O?.success_rate?.toFixed(1)??0,"%"]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[O?.completed_executions??0," completed"]})]})]}),(0,r.jsxs)(c.Card,{children:[(0,r.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Total Recovered"}),(0,r.jsx)(D.Z,{className:"h-4 w-4 text-green-600"})]}),(0,r.jsxs)(c.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:I(O?.total_recovered_amount??0)}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[O?.recovery_rate?.toFixed(1)??0,"% recovery rate"]})]})]}),(0,r.jsxs)(c.Card,{children:[(0,r.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Avg Completion Time"}),(0,r.jsx)(P.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(c.CardContent,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[O?.average_completion_time_hours?.toFixed(1)??0,"h"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average duration"})]})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,r.jsxs)(c.Card,{children:[(0,r.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Failed Executions"}),(0,r.jsx)(p.Z,{className:"h-4 w-4 text-red-600"})]}),(0,r.jsxs)(c.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:O?.failed_executions??0}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Failed to complete"})]})]}),(0,r.jsxs)(c.Card,{children:[(0,r.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Canceled Executions"}),(0,r.jsx)(h.Z,{className:"h-4 w-4 text-gray-600"})]}),(0,r.jsxs)(c.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:O?.canceled_executions??0}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manually canceled"})]})]}),(0,r.jsxs)(c.Card,{children:[(0,r.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Outstanding Amount"}),(0,r.jsx)(D.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,r.jsxs)(c.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:I(O?.total_outstanding_amount??0)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Still outstanding"})]})]})]})]}),(0,r.jsx)(c.TabsContent,{value:"executions",className:"space-y-4",children:(0,r.jsxs)(c.Card,{children:[(0,r.jsx)(c.CardHeader,{children:(0,r.jsx)(c.CardTitle,{children:"Recent Executions"})}),(0,r.jsx)(c.CardContent,{children:K?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(v.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===V.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,r.jsx)(y.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"No executions found"})]}):(0,r.jsxs)(c.Table,{children:[(0,r.jsx)(c.TableHeader,{children:(0,r.jsxs)(c.TableRow,{children:[(0,r.jsx)(c.TableHead,{children:"Execution ID"}),(0,r.jsx)(c.TableHead,{children:"Customer"}),(0,r.jsx)(c.TableHead,{children:"Status"}),(0,r.jsx)(c.TableHead,{children:"Progress"}),(0,r.jsx)(c.TableHead,{children:"Outstanding"}),(0,r.jsx)(c.TableHead,{children:"Recovered"}),(0,r.jsx)(c.TableHead,{children:"Started"}),(0,r.jsx)(c.TableHead,{children:"Actions"})]})}),(0,r.jsx)(c.TableBody,{children:V.map(e=>(0,r.jsxs)(c.TableRow,{children:[(0,r.jsx)(c.TableCell,{className:"font-mono text-sm",children:e.id.substring(0,8)}),(0,r.jsx)(c.TableCell,{className:"font-mono text-sm",children:e.customer_id.substring(0,8)}),(0,r.jsx)(c.TableCell,{children:(0,r.jsx)(c.Badge,{variant:M(e.status),className:R(e.status),children:e.status})}),(0,r.jsx)(c.TableCell,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm",children:[e.current_step," / ",e.total_steps]}),(0,r.jsx)("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-blue-600",style:{width:`${e.current_step/e.total_steps*100}%`}})})]})}),(0,r.jsx)(c.TableCell,{children:I(e.outstanding_amount)}),(0,r.jsx)(c.TableCell,{children:I(e.recovered_amount)}),(0,r.jsx)(c.TableCell,{children:(0,r.jsx)("div",{className:"text-sm",children:(0,k.Q)(new Date(e.started_at),{addSuffix:!0})})}),(0,r.jsx)(c.TableCell,{children:(0,r.jsx)(c.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,r.jsx)(E.default,{href:`/dashboard/billing-revenue/dunning/executions/${e.id}`,children:"View"})})})]},e.id))})]})})]})})]}),(0,r.jsx)(c.Dialog,{open:g,onOpenChange:f,children:(0,r.jsxs)(c.DialogContent,{className:"max-w-2xl",children:[(0,r.jsxs)(c.DialogHeader,{children:[(0,r.jsx)(c.DialogTitle,{children:"Edit Campaign"}),(0,r.jsx)(c.DialogDescription,{children:"Update campaign settings"})]}),(0,r.jsx)(c.Form,{...z,children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),z.handleSubmit(e=>{G.mutate(e)})(e)},className:"space-y-4",children:[(0,r.jsx)(c.FormField,{control:z.control,name:"name",render:({field:e})=>(0,r.jsxs)(c.FormItem,{children:[(0,r.jsx)(c.FormLabel,{children:"Campaign Name"}),(0,r.jsx)(c.FormControl,{children:(0,r.jsx)(c.Input,{...e})}),(0,r.jsx)(c.FormMessage,{})]})}),(0,r.jsx)(c.FormField,{control:z.control,name:"description",render:({field:e})=>(0,r.jsxs)(c.FormItem,{children:[(0,r.jsx)(c.FormLabel,{children:"Description"}),(0,r.jsx)(c.FormControl,{children:(0,r.jsx)(c.Textarea,{...e})}),(0,r.jsx)(c.FormMessage,{})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(c.FormField,{control:z.control,name:"trigger_after_days",render:({field:e})=>(0,r.jsxs)(c.FormItem,{children:[(0,r.jsx)(c.FormLabel,{children:"Trigger After (Days)"}),(0,r.jsx)(c.FormControl,{children:(0,r.jsx)(c.Input,{type:"number",min:"1",...e})}),(0,r.jsx)(c.FormMessage,{})]})}),(0,r.jsx)(c.FormField,{control:z.control,name:"max_retries",render:({field:e})=>(0,r.jsxs)(c.FormItem,{children:[(0,r.jsx)(c.FormLabel,{children:"Max Retries"}),(0,r.jsx)(c.FormControl,{children:(0,r.jsx)(c.Input,{type:"number",min:"1",...e})}),(0,r.jsx)(c.FormMessage,{})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(c.FormField,{control:z.control,name:"retry_interval_days",render:({field:e})=>(0,r.jsxs)(c.FormItem,{children:[(0,r.jsx)(c.FormLabel,{children:"Retry Interval (Days)"}),(0,r.jsx)(c.FormControl,{children:(0,r.jsx)(c.Input,{type:"number",min:"1",...e})}),(0,r.jsx)(c.FormMessage,{})]})}),(0,r.jsx)(c.FormField,{control:z.control,name:"priority",render:({field:e})=>(0,r.jsxs)(c.FormItem,{children:[(0,r.jsx)(c.FormLabel,{children:"Priority"}),(0,r.jsx)(c.FormControl,{children:(0,r.jsx)(c.Input,{type:"number",min:"1",max:"100",...e})}),(0,r.jsx)(c.FormMessage,{})]})})]}),(0,r.jsx)(c.FormField,{control:z.control,name:"is_active",render:({field:e})=>(0,r.jsxs)(c.FormItem,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(c.FormLabel,{className:"text-base",children:"Active"}),(0,r.jsx)(c.FormDescription,{children:"Enable or disable this campaign"})]}),(0,r.jsx)(c.FormControl,{children:(0,r.jsx)(c.Switch,{checked:e.value,onCheckedChange:e.onChange})})]})}),(0,r.jsxs)(c.DialogFooter,{children:[(0,r.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>f(!1),children:"Cancel"}),(0,r.jsx)(c.Button,{type:"submit",disabled:G.isPending,children:G.isPending?"Updating...":"Update Campaign"})]})]})})]})}),(0,r.jsx)(c.AlertDialog,{open:H,onOpenChange:U,children:(0,r.jsxs)(c.AlertDialogContent,{children:[(0,r.jsxs)(c.AlertDialogHeader,{children:[(0,r.jsx)(c.AlertDialogTitle,{children:"Delete Campaign"}),(0,r.jsx)(c.AlertDialogDescription,{children:"Are you sure you want to delete this campaign? This action cannot be undone."})]}),(0,r.jsxs)(c.AlertDialogFooter,{children:[(0,r.jsx)(c.AlertDialogCancel,{children:"Cancel"}),(0,r.jsx)(c.AlertDialogAction,{onClick:()=>{J.mutate()},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,r.jsx)(y.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Campaign not found"})]})}function $(){return(0,r.jsx)(o.eu,{permission:"billing:write",children:(0,r.jsx)(U,{})})}},13538:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/dunning/campaigns/[id]/page.tsx#default`)},74064:(e,s,t)=>{"use strict";t.d(s,{F:()=>c});var r=t(74723);let a=(e,s,t)=>{if(e&&"reportValidity"in e){let a=(0,r.U2)(t,s);e.setCustomValidity(a&&a.message||""),e.reportValidity()}},i=(e,s)=>{for(let t in s.fields){let r=s.fields[t];r&&r.ref&&"reportValidity"in r.ref?a(r.ref,t,e):r.refs&&r.refs.forEach(s=>a(s,t,e))}},n=(e,s)=>{s.shouldUseNativeValidation&&i(e,s);let t={};for(let a in e){let i=(0,r.U2)(s.fields,a),n=Object.assign(e[a]||{},{ref:i&&i.ref});if(l(s.names||Object.keys(e),a)){let e=Object.assign({},(0,r.U2)(t,a));(0,r.t8)(e,"root",n),(0,r.t8)(t,a,e)}else(0,r.t8)(t,a,n)}return t},l=(e,s)=>e.some(e=>e.startsWith(s+"."));var d=function(e,s){for(var t={};e.length;){var a=e[0],i=a.code,n=a.message,l=a.path.join(".");if(!t[l]){if("unionErrors"in a){var d=a.unionErrors[0].errors[0];t[l]={message:d.message,type:d.code}}else t[l]={message:n,type:i}}if("unionErrors"in a&&a.unionErrors.forEach(function(s){return s.errors.forEach(function(s){return e.push(s)})}),s){var c=t[l].types,o=c&&c[a.code];t[l]=(0,r.KN)(l,s,t,i,o?[].concat(o,a.message):a.message)}e.shift()}return t},c=function(e,s,t){return void 0===t&&(t={}),function(r,a,l){try{return Promise.resolve(function(a,n){try{var d=Promise.resolve(e["sync"===t.mode?"parse":"parseAsync"](r,s)).then(function(e){return l.shouldUseNativeValidation&&i({},l),{errors:{},values:t.raw?r:e}})}catch(e){return n(e)}return d&&d.then?d.then(void 0,n):d}(0,function(e){if(Array.isArray(null==e?void 0:e.errors))return{values:{},errors:n(d(e.errors,!l.shouldUseNativeValidation&&"all"===l.criteriaMode),l)};throw e}))}catch(e){return Promise.reject(e)}}}}};var s=require("../../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2793,1009,6226,657,4723,770,6032,4218],()=>t(34932));module.exports=r})();