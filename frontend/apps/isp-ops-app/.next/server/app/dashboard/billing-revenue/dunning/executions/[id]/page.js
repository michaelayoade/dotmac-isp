(()=>{var e={};e.id=1077,e.ids=[1077],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},79916:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>c}),t(98667),t(13321),t(46366),t(96560);var a=t(23191),r=t(88716),n=t(37922),i=t.n(n),d=t(95231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);t.d(s,l);let c=["",{children:["dashboard",{children:["billing-revenue",{children:["dunning",{children:["executions",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,98667)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/dunning/executions/[id]/page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/dunning/executions/[id]/page.tsx"],x="/dashboard/billing-revenue/dunning/executions/[id]/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/billing-revenue/dunning/executions/[id]/page",pathname:"/dashboard/billing-revenue/dunning/executions/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},86341:(e,s,t)=>{Promise.resolve().then(t.bind(t,92671))},92671:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>I});var a=t(10326),r=t(17577),n=t(44976),i=t(48324),d=t(17010),l=t(35047),c=t(48723),o=t(20892),x=t(93158),u=t(5932),m=t(40617),h=t(30123),j=t(69669),p=t(70600),g=t(88378),f=t(3634),v=t(21405),N=t(41291),b=t(86333),y=t(66697),C=t(30361),_=t(71821),w=t(79635),T=t(28916),P=t(36283),D=t(37358),E=t(48998),Z=t(90434),q=t(74723),S=t(74064),F=t(770),H=t(34041),U=t(90960);let R=F.Ry({reason:F.Z_().min(1,"Reason is required")}),$=e=>`$${(e/100).toFixed(2)}`,k=e=>{switch(e){case"pending":case"canceled":return"secondary";case"in_progress":default:return"default";case"completed":case"success":return"outline";case"failed":case"error":return"destructive"}},A=e=>{switch(e){case"pending":return"text-yellow-600";case"in_progress":return"text-blue-600";case"completed":case"success":return"text-green-600";case"failed":case"error":return"text-red-600";default:return"text-gray-600"}},B=e=>{switch(e){case"email":return(0,a.jsx)(u.Z,{className:"h-4 w-4"});case"sms":return(0,a.jsx)(m.Z,{className:"h-4 w-4"});case"suspend_service":return(0,a.jsx)(h.Z,{className:"h-4 w-4"});case"terminate_service":return(0,a.jsx)(j.Z,{className:"h-4 w-4"});case"webhook":return(0,a.jsx)(p.Z,{className:"h-4 w-4"});case"custom":return(0,a.jsx)(g.Z,{className:"h-4 w-4"});default:return(0,a.jsx)(f.Z,{className:"h-4 w-4"})}};function O(){let e=(0,l.useParams)();(0,l.useRouter)();let{toast:s}=(0,c.useToast)(),t=(0,n.NL)(),o=e.id,{api:u}=(0,x.M)(),m=u.baseUrl||"",[p,g]=(0,r.useState)(!1),f=(0,q.cI)({resolver:(0,S.F)(R),defaultValues:{reason:""}}),{data:F,isLoading:O}=(0,i.a)({queryKey:["dunning","executions",o,m],queryFn:async()=>{let e=await fetch(`${m}/api/v1/billing/dunning/executions/${o}`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch execution");return e.json()},refetchInterval:e=>!!e?.state?.data&&("pending"===e.state.data.status||"in_progress"===e.state.data.status)&&1e4}),{data:I}=(0,i.a)({queryKey:["dunning","campaigns",F?.campaign_id,m],queryFn:async()=>{let e=await fetch(`${m}/api/v1/billing/dunning/campaigns/${F?.campaign_id}`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch campaign");return e.json()},enabled:!!F?.campaign_id}),{data:V=[],isLoading:W}=(0,i.a)({queryKey:["dunning","executions",o,"logs",m],queryFn:async()=>{let e=await fetch(`${m}/api/v1/billing/dunning/executions/${o}/logs`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch action logs");return e.json()},refetchInterval:e=>!!F&&("pending"===F.status||"in_progress"===F.status)&&1e4}),z=(0,d.D)({mutationFn:async e=>{let s=await fetch(`${m}/api/v1/billing/dunning/executions/${o}/cancel`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error("Failed to cancel execution");return s.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["dunning","executions",o]}),g(!1),f.reset(),s({title:"Success",description:"Execution canceled successfully"})},onError:()=>{s({title:"Error",description:"Failed to cancel execution",variant:"destructive"})}}),L=F?.status==="pending"||F?.status==="in_progress";if(O)return(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(v.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!F)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)(N.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Execution not found"})]});let Q=F.current_step/F.total_steps*100;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(c.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,a.jsx)(Z.default,{href:"/dashboard/billing-revenue/dunning",children:(0,a.jsx)(b.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold tracking-tight",children:["Execution ",F.id.substring(0,8)]}),(0,a.jsx)(c.Badge,{variant:k(F.status),className:A(F.status),children:F.status})]}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Campaign: ",I?.name??F.campaign_id]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(c.Button,{variant:"outline",size:"icon",onClick:()=>{t.invalidateQueries({queryKey:["dunning","executions",o]}),s({title:"Refreshed",description:"Execution data has been refreshed"})},children:(0,a.jsx)(v.Z,{className:"h-4 w-4"})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Status"}),(0,a.jsx)(y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold capitalize",children:F.status}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Retry ",F.retry_count]})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Progress"}),(0,a.jsx)(C.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[F.current_step," / ",F.total_steps]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden mt-2",children:(0,a.jsx)("div",{className:"h-full bg-blue-600 transition-all",style:{width:`${Q}%`}})})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Outstanding"}),(0,a.jsx)(_.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,a.jsxs)(c.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:$(F.outstanding_amount)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Remaining balance"})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.CardTitle,{className:"text-sm font-medium",children:"Recovered"}),(0,a.jsx)(_.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(c.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:$(F.recovered_amount)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Payment received"})]})]})]}),L&&(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Quick Actions"})}),(0,a.jsx)(c.CardContent,{children:(0,a.jsxs)(c.Button,{variant:"destructive",onClick:()=>g(!0),children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Cancel Execution"]})})]}),(0,a.jsxs)(c.Tabs,{defaultValue:"overview",className:"space-y-4",children:[(0,a.jsxs)(c.TabsList,{children:[(0,a.jsx)(c.TabsTrigger,{value:"overview",children:"Overview"}),(0,a.jsx)(c.TabsTrigger,{value:"logs",children:"Action Logs"}),(0,a.jsx)(c.TabsTrigger,{value:"timeline",children:"Timeline"})]}),(0,a.jsxs)(c.TabsContent,{value:"overview",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Execution Details"})}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Execution ID"}),(0,a.jsx)("div",{className:"font-mono font-medium",children:F.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Campaign"}),(0,a.jsx)("div",{className:"font-medium",children:(0,a.jsx)(Z.default,{href:`/dashboard/billing-revenue/dunning/campaigns/${F.campaign_id}`,className:"text-blue-600 hover:underline",children:I?.name??F.campaign_id})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Status"}),(0,a.jsx)(c.Badge,{variant:k(F.status),className:A(F.status),children:F.status})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Progress (",Q.toFixed(0),"%)"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"font-medium",children:[F.current_step," / ",F.total_steps]}),(0,a.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-blue-600 transition-all",style:{width:`${Q}%`}})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Retry Count"}),(0,a.jsx)("div",{className:"font-medium",children:F.retry_count})]})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Customer & Subscription"})}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4"}),"Customer ID"]}),(0,a.jsx)("div",{className:"font-mono font-medium",children:F.customer_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(T.Z,{className:"h-4 w-4"}),"Subscription ID"]}),(0,a.jsx)("div",{className:"font-mono font-medium",children:F.subscription_id})]}),F.invoice_id&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(P.Z,{className:"h-4 w-4"}),"Invoice ID"]}),(0,a.jsx)("div",{className:"font-mono font-medium",children:F.invoice_id})]})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Payment Status"})}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Outstanding Amount"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:$(F.outstanding_amount)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Recovered Amount"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:$(F.recovered_amount)})]}),F.outstanding_amount>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Recovery Rate"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[(F.recovered_amount/(F.outstanding_amount+F.recovered_amount)*100).toFixed(1),"%"]})]})]})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Timeline"})}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(D.Z,{className:"h-4 w-4"}),"Started"]}),(0,a.jsx)("div",{className:"font-medium",children:(0,H.WU)(new Date(F.started_at),"PPp")}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,U.Q)(new Date(F.started_at),{addSuffix:!0})})]}),F.next_action_at&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4"}),"Next Action"]}),(0,a.jsx)("div",{className:"font-medium",children:(0,H.WU)(new Date(F.next_action_at),"PPp")}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,U.Q)(new Date(F.next_action_at),{addSuffix:!0})})]}),F.completed_at&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(C.Z,{className:"h-4 w-4"}),"Completed"]}),(0,a.jsx)("div",{className:"font-medium",children:(0,H.WU)(new Date(F.completed_at),"PPp")}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,U.Q)(new Date(F.completed_at),{addSuffix:!0})})]})]})]})]}),"canceled"===F.status&&F.canceled_reason&&(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Cancellation Details"})}),(0,a.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Reason"}),(0,a.jsx)("div",{className:"font-medium",children:F.canceled_reason})]}),F.canceled_by_user_id&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Canceled By"}),(0,a.jsx)("div",{className:"font-mono font-medium",children:F.canceled_by_user_id})]})]})]})]}),(0,a.jsx)(c.TabsContent,{value:"logs",className:"space-y-4",children:(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Action Logs"})}),(0,a.jsx)(c.CardContent,{children:W?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(v.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===V.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,a.jsx)(N.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No action logs recorded yet"})]}):(0,a.jsxs)(c.Table,{children:[(0,a.jsx)(c.TableHeader,{children:(0,a.jsxs)(c.TableRow,{children:[(0,a.jsx)(c.TableHead,{children:"Step"}),(0,a.jsx)(c.TableHead,{children:"Action Type"}),(0,a.jsx)(c.TableHead,{children:"Status"}),(0,a.jsx)(c.TableHead,{children:"Executed At"}),(0,a.jsx)(c.TableHead,{children:"Result"}),(0,a.jsx)(c.TableHead,{children:"External ID"})]})}),(0,a.jsx)(c.TableBody,{children:V.map(e=>(0,a.jsxs)(c.TableRow,{children:[(0,a.jsx)(c.TableCell,{children:(0,a.jsx)(c.Badge,{variant:"outline",children:e.step_number})}),(0,a.jsx)(c.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[B(e.action_type),(0,a.jsx)("span",{className:"capitalize",children:e.action_type.replace(/_/g," ")})]})}),(0,a.jsx)(c.TableCell,{children:(0,a.jsx)(c.Badge,{variant:k(e.status),className:A(e.status),children:e.status})}),(0,a.jsxs)(c.TableCell,{children:[(0,a.jsx)("div",{className:"text-sm",children:(0,H.WU)(new Date(e.executed_at),"PPp")}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,U.Q)(new Date(e.executed_at),{addSuffix:!0})})]}),(0,a.jsx)(c.TableCell,{children:e.error_message?(0,a.jsx)("div",{className:"text-sm text-red-600",children:e.error_message}):(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:Object.keys(e.result).length>0?JSON.stringify(e.result).substring(0,50)+"...":"Success"})}),(0,a.jsx)(c.TableCell,{children:e.external_id&&(0,a.jsx)("div",{className:"font-mono text-sm",children:e.external_id})})]},e.id))})]})})]})}),(0,a.jsx)(c.TabsContent,{value:"timeline",className:"space-y-4",children:(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{children:(0,a.jsx)(c.CardTitle,{children:"Execution Timeline"})}),(0,a.jsx)(c.CardContent,{children:W?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(v.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===V.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,a.jsx)(N.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No timeline events yet"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(y.Z,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsx)("div",{className:"w-0.5 h-full bg-gray-200 mt-2"})]}),(0,a.jsxs)("div",{className:"flex-1 pb-8",children:[(0,a.jsx)("div",{className:"font-medium",children:"Execution Started"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,H.WU)(new Date(F.started_at),"PPp")}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Campaign: ",I?.name??F.campaign_id]})]})]}),V.map((e,s)=>(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${"success"===e.status?"bg-green-100":"error"===e.status||"failed"===e.status?"bg-red-100":"bg-gray-100"}`,children:B(e.action_type)}),s<V.length-1&&(0,a.jsx)("div",{className:"w-0.5 h-full bg-gray-200 mt-2"})]}),(0,a.jsxs)("div",{className:"flex-1 pb-8",children:[(0,a.jsxs)("div",{className:"font-medium capitalize",children:[e.action_type.replace(/_/g," ")," - Step ",e.step_number]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,H.WU)(new Date(e.executed_at),"PPp")}),(0,a.jsx)(c.Badge,{variant:k(e.status),className:`mt-1 ${A(e.status)}`,children:e.status}),e.error_message&&(0,a.jsx)("div",{className:"text-sm text-red-600 mt-2",children:e.error_message})]})]},e.id)),(F.completed_at||"failed"===F.status||"canceled"===F.status)&&(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex flex-col items-center",children:(0,a.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${"completed"===F.status?"bg-green-100":"failed"===F.status?"bg-red-100":"bg-gray-100"}`,children:"completed"===F.status?(0,a.jsx)(C.Z,{className:"h-4 w-4 text-green-600"}):"failed"===F.status?(0,a.jsx)(j.Z,{className:"h-4 w-4 text-red-600"}):(0,a.jsx)(h.Z,{className:"h-4 w-4 text-gray-600"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"font-medium capitalize",children:["Execution ",F.status]}),F.completed_at&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,H.WU)(new Date(F.completed_at),"PPp")}),"canceled"===F.status&&F.canceled_reason&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["Reason: ",F.canceled_reason]})]})]})]})})]})})]}),(0,a.jsx)(c.Dialog,{open:p,onOpenChange:g,children:(0,a.jsxs)(c.DialogContent,{children:[(0,a.jsxs)(c.DialogHeader,{children:[(0,a.jsx)(c.DialogTitle,{children:"Cancel Execution"}),(0,a.jsx)(c.DialogDescription,{children:"Please provide a reason for canceling this dunning execution."})]}),(0,a.jsx)(c.Form,{...f,children:(0,a.jsxs)("form",{onSubmit:f.handleSubmit(e=>{z.mutate(e)}),className:"space-y-4",children:[(0,a.jsx)(c.FormField,{control:f.control,name:"reason",render:({field:e})=>(0,a.jsxs)(c.FormItem,{children:[(0,a.jsx)(c.FormLabel,{children:"Cancellation Reason"}),(0,a.jsx)(c.FormControl,{children:(0,a.jsx)(c.Textarea,{placeholder:"Enter reason for cancellation...",...e})}),(0,a.jsx)(c.FormMessage,{})]})}),(0,a.jsxs)(c.DialogFooter,{children:[(0,a.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Close"}),(0,a.jsx)(c.Button,{type:"submit",variant:"destructive",disabled:z.isPending,children:z.isPending?"Canceling...":"Cancel Execution"})]})]})})]})})]})}function I(){return(0,a.jsx)(o.eu,{permission:"billing:write",children:(0,a.jsx)(O,{})})}},98667:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/dunning/executions/[id]/page.tsx#default`)},74064:(e,s,t)=>{"use strict";t.d(s,{F:()=>c});var a=t(74723);let r=(e,s,t)=>{if(e&&"reportValidity"in e){let r=(0,a.U2)(t,s);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},n=(e,s)=>{for(let t in s.fields){let a=s.fields[t];a&&a.ref&&"reportValidity"in a.ref?r(a.ref,t,e):a.refs&&a.refs.forEach(s=>r(s,t,e))}},i=(e,s)=>{s.shouldUseNativeValidation&&n(e,s);let t={};for(let r in e){let n=(0,a.U2)(s.fields,r),i=Object.assign(e[r]||{},{ref:n&&n.ref});if(d(s.names||Object.keys(e),r)){let e=Object.assign({},(0,a.U2)(t,r));(0,a.t8)(e,"root",i),(0,a.t8)(t,r,e)}else(0,a.t8)(t,r,i)}return t},d=(e,s)=>e.some(e=>e.startsWith(s+"."));var l=function(e,s){for(var t={};e.length;){var r=e[0],n=r.code,i=r.message,d=r.path.join(".");if(!t[d]){if("unionErrors"in r){var l=r.unionErrors[0].errors[0];t[d]={message:l.message,type:l.code}}else t[d]={message:i,type:n}}if("unionErrors"in r&&r.unionErrors.forEach(function(s){return s.errors.forEach(function(s){return e.push(s)})}),s){var c=t[d].types,o=c&&c[r.code];t[d]=(0,a.KN)(d,s,t,n,o?[].concat(o,r.message):r.message)}e.shift()}return t},c=function(e,s,t){return void 0===t&&(t={}),function(a,r,d){try{return Promise.resolve(function(r,i){try{var l=Promise.resolve(e["sync"===t.mode?"parse":"parseAsync"](a,s)).then(function(e){return d.shouldUseNativeValidation&&n({},d),{errors:{},values:t.raw?a:e}})}catch(e){return i(e)}return l&&l.then?l.then(void 0,i):l}(0,function(e){if(Array.isArray(null==e?void 0:e.errors))return{values:{},errors:i(l(e.errors,!d.shouldUseNativeValidation&&"all"===d.criteriaMode),d)};throw e}))}catch(e){return Promise.reject(e)}}}}};var s=require("../../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,4723,770,6032,4218],()=>t(79916));module.exports=a})();