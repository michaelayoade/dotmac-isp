(()=>{var e={};e.id=8404,e.ids=[8404],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},9561:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>r.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>c}),t(55814),t(13321),t(46366),t(96560);var a=t(23191),i=t(88716),n=t(37922),r=t.n(n),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let c=["",{children:["dashboard",{children:["billing-revenue",{children:["reconciliation",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,55814)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/reconciliation/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],o=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/reconciliation/[id]/page.tsx"],x="/dashboard/billing-revenue/reconciliation/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/billing-revenue/reconciliation/[id]/page",pathname:"/dashboard/billing-revenue/reconciliation/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},23119:(e,s,t)=>{Promise.resolve().then(t.bind(t,79692))},79692:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var a=t(10326),i=t(17577),n=t(44976),r=t(48324),l=t(17010),d=t(90960),c=t(34041),o=t(48998),x=t(30361),m=t(32933),h=t(50949),u=t(18019),p=t(77506),j=t(86333),f=t(31540),y=t(37358),g=t(71821),v=t(17069),b=t(83855),N=t(36283),w=t(35047),C=t(20892),_=t(48723),T=t(93158);let D=e=>`${e}/api/v1/billing/reconciliations`,P=async(e,s)=>{let t=await fetch(`${D(e)}/${s}`,{credentials:"include"});if(!t.ok)throw Error("Failed to fetch reconciliation");return t.json()},A=async(e,s,t)=>{let a=await fetch(`${D(e)}/${s}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to add payment to reconciliation");return a.json()},M=async(e,s)=>{let t=await fetch(`${D(e)}/${s}/complete`,{method:"POST",credentials:"include"});if(!t.ok)throw Error("Failed to complete reconciliation");return t.json()},q=async(e,s)=>{let t=await fetch(`${D(e)}/${s}/approve`,{method:"POST",credentials:"include"});if(!t.ok)throw Error("Failed to approve reconciliation");return t.json()},B=e=>`$${(e/100).toFixed(2)}`,Z=e=>{switch(e){case"in_progress":return(0,a.jsxs)(_.Badge,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-300",children:[(0,a.jsx)(o.Z,{className:"mr-1 h-3 w-3"}),"In Progress"]});case"completed":return(0,a.jsxs)(_.Badge,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-300",children:[(0,a.jsx)(x.Z,{className:"mr-1 h-3 w-3"}),"Completed"]});case"approved":return(0,a.jsxs)(_.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:[(0,a.jsx)(m.Z,{className:"mr-1 h-3 w-3"}),"Approved"]});default:return(0,a.jsx)(_.Badge,{variant:"outline",children:e})}},H=e=>{let s=Math.abs(e);return 0===s?"text-green-600":s>1e4?"text-red-600":"text-orange-600"},S=e=>{let s=Math.abs(e);return 0===s?(0,a.jsx)(x.Z,{className:"h-5 w-5 text-green-600"}):s>1e4?(0,a.jsx)(h.Z,{className:"h-5 w-5 text-red-600"}):(0,a.jsx)(u.Z,{className:"h-5 w-5 text-orange-600"})};function k(){let e=(0,w.useRouter)(),s=(0,w.useParams)().id,t=(0,n.NL)(),{toast:u}=(0,_.useToast)(),D=(0,_.useConfirmDialog)(),{api:k}=(0,T.M)(),R=k.baseUrl,[F,U]=(0,i.useState)("overview"),[$,L]=(0,i.useState)(!1),[E,O]=(0,i.useState)({payment_id:0,notes:""}),{data:Q,isLoading:W,refetch:I}=(0,r.a)({queryKey:["reconciliation",R,s],queryFn:()=>P(R,s),refetchInterval:e=>e?.state?.data?.status==="in_progress"&&15e3}),K=(0,l.D)({mutationFn:e=>A(R,s,e),onSuccess:()=>{t.invalidateQueries({queryKey:["reconciliation",s]}),t.invalidateQueries({queryKey:["reconciliations"]}),u({title:"Payment added to reconciliation successfully"}),L(!1),O({payment_id:0,notes:""})},onError:e=>{u({title:`Failed to add payment: ${e.message}`,variant:"destructive"})}}),G=(0,l.D)({mutationFn:()=>M(R,s),onSuccess:()=>{t.invalidateQueries({queryKey:["reconciliation",s]}),t.invalidateQueries({queryKey:["reconciliations"]}),t.invalidateQueries({queryKey:["reconciliation-summary"]}),u({title:"Reconciliation completed successfully"})},onError:e=>{u({title:`Failed to complete reconciliation: ${e.message}`,variant:"destructive"})}}),z=(0,l.D)({mutationFn:()=>q(R,s),onSuccess:()=>{t.invalidateQueries({queryKey:["reconciliation",s]}),t.invalidateQueries({queryKey:["reconciliations"]}),t.invalidateQueries({queryKey:["reconciliation-summary"]}),u({title:"Reconciliation approved successfully"})},onError:e=>{u({title:`Failed to approve reconciliation: ${e.message}`,variant:"destructive"})}}),J=async()=>{await D({title:"Complete reconciliation",description:"Are you sure you want to complete this reconciliation? This will lock the reconciled payments.",confirmText:"Complete"})&&G.mutate()},V=async()=>{await D({title:"Approve reconciliation",description:"Are you sure you want to approve this reconciliation? This action requires finance team authority.",confirmText:"Approve"})&&z.mutate()};if(W)return(0,a.jsx)(C.eu,{permission:["billing:write"],children:(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)(p.Z,{className:"h-8 w-8 animate-spin"})})});if(!Q)return(0,a.jsx)(C.eu,{permission:["billing:write"],children:(0,a.jsx)("div",{className:"container mx-auto p-6",children:(0,a.jsxs)(_.Alert,{variant:"destructive",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)(_.AlertTitle,{children:"Error"}),(0,a.jsx)(_.AlertDescription,{children:"Reconciliation session not found"})]})})});let X=Q.statement_balance?Math.abs(Q.discrepancy_amount)/Q.statement_balance*100:0,Y=Q.reconciled_items.reduce((e,s)=>e+s.amount,0);return(0,a.jsx)(C.eu,{permission:["billing:write"],children:(0,a.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(_.Button,{variant:"ghost",onClick:()=>e.back(),children:(0,a.jsx)(j.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold",children:["Reconciliation #",Q.id]}),Z(Q.status)]}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Created ",(0,d.Q)(new Date(Q.created_at))," ago"]})]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:Q.statement_file_url&&(0,a.jsx)(_.Button,{variant:"outline",asChild:!0,children:(0,a.jsxs)("a",{href:Q.statement_file_url,target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Download Statement"]})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Period Info"}),(0,a.jsx)(y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(_.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Period"}),(0,a.jsxs)("div",{className:"text-sm font-medium",children:[(0,c.WU)(new Date(Q.period_start),"MMM dd")," -"," ",(0,c.WU)(new Date(Q.period_end),"MMM dd, yyyy")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Reconciliation Date"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:(0,c.WU)(new Date(Q.reconciliation_date),"MMM dd, yyyy")})]})]})})]}),(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Balances"}),(0,a.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(_.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Opening:"}),(0,a.jsx)("span",{className:"text-sm font-mono font-medium",children:B(Q.opening_balance)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Closing:"}),(0,a.jsx)("span",{className:"text-sm font-mono font-medium",children:B(Q.closing_balance)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Statement:"}),(0,a.jsx)("span",{className:"text-sm font-mono font-medium",children:B(Q.statement_balance)})]})]})})]}),(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Discrepancy"}),S(Q.discrepancy_amount)]}),(0,a.jsx)(_.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Amount"}),(0,a.jsx)("div",{className:`text-2xl font-bold font-mono ${H(Q.discrepancy_amount)}`,children:B(Q.discrepancy_amount)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Percentage"}),(0,a.jsxs)("div",{className:"text-sm font-medium",children:[X.toFixed(2),"%"]})]})]})})]}),(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(_.CardTitle,{className:"text-sm font-medium",children:"Status"}),(0,a.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(_.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Current Status"}),(0,a.jsx)("div",{className:"mt-1",children:Z(Q.status)})]}),Q.unreconciled_count>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Unreconciled"}),(0,a.jsxs)(_.Badge,{variant:"destructive",className:"mt-1",children:[Q.unreconciled_count," items"]})]})]})})]})]}),Math.abs(Q.discrepancy_amount)>0&&(0,a.jsxs)(_.Alert,{variant:Math.abs(Q.discrepancy_amount)>1e4?"destructive":"default",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)(_.AlertTitle,{children:"Discrepancy Detected"}),(0,a.jsxs)(_.AlertDescription,{children:["There is a discrepancy of ",B(Math.abs(Q.discrepancy_amount))," ","between the calculated closing balance and the statement balance.",Math.abs(Q.discrepancy_amount)>1e4&&" This is a significant discrepancy that requires immediate attention."]})]}),(0,a.jsxs)(_.Tabs,{value:F,onValueChange:U,children:[(0,a.jsxs)(_.TabsList,{children:[(0,a.jsx)(_.TabsTrigger,{value:"overview",children:"Overview"}),(0,a.jsxs)(_.TabsTrigger,{value:"payments",children:["Reconciled Payments",(0,a.jsx)(_.Badge,{variant:"secondary",className:"ml-2",children:Q.reconciled_items.length})]}),(0,a.jsx)(_.TabsTrigger,{value:"actions",children:"Actions"})]}),(0,a.jsxs)(_.TabsContent,{value:"overview",className:"space-y-4",children:[(0,a.jsxs)(_.Card,{children:[(0,a.jsx)(_.CardHeader,{children:(0,a.jsx)(_.CardTitle,{children:"Reconciliation Information"})}),(0,a.jsxs)(_.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Reconciliation ID"}),(0,a.jsxs)("div",{className:"text-lg font-medium",children:["#",Q.id]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Bank Account"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:(0,a.jsxs)(_.Badge,{variant:"outline",children:["Account #",Q.bank_account_id]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Reconciliation Date"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:(0,c.WU)(new Date(Q.reconciliation_date),"MMMM dd, yyyy")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Period"}),(0,a.jsxs)("div",{className:"text-lg font-medium",children:[(0,c.WU)(new Date(Q.period_start),"MMM dd, yyyy")," -"," ",(0,c.WU)(new Date(Q.period_end),"MMM dd, yyyy")]})]})]}),(0,a.jsx)(_.Separator,{}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Opening Balance"}),(0,a.jsx)("div",{className:"text-2xl font-bold font-mono",children:B(Q.opening_balance)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Closing Balance"}),(0,a.jsx)("div",{className:"text-2xl font-bold font-mono",children:B(Q.closing_balance)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Statement Balance"}),(0,a.jsx)("div",{className:"text-2xl font-bold font-mono",children:B(Q.statement_balance)})]})]})]})]}),(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{children:[(0,a.jsx)(_.CardTitle,{children:"Discrepancy Analysis"}),(0,a.jsx)(_.CardDescription,{children:"Breakdown of the balance calculation and discrepancy"})]}),(0,a.jsx)(_.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Total Deposits"}),(0,a.jsxs)("div",{className:"text-xl font-bold font-mono text-green-600",children:["+",B(Q.total_deposits)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"text-muted-foreground",children:"Total Withdrawals"}),(0,a.jsxs)("div",{className:"text-xl font-bold font-mono text-red-600",children:["-",B(Q.total_withdrawals)]})]})]}),(0,a.jsx)(_.Separator,{}),(0,a.jsxs)("div",{className:"bg-muted p-4 rounded-lg space-y-2",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Balance Calculation:"}),(0,a.jsxs)("div",{className:"space-y-1 font-mono text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Opening Balance:"}),(0,a.jsx)("span",{children:B(Q.opening_balance)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,a.jsx)("span",{children:"+ Deposits:"}),(0,a.jsx)("span",{children:B(Q.total_deposits)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,a.jsx)("span",{children:"- Withdrawals:"}),(0,a.jsx)("span",{children:B(Q.total_withdrawals)})]}),(0,a.jsx)(_.Separator,{}),(0,a.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,a.jsx)("span",{children:"Calculated Closing:"}),(0,a.jsx)("span",{children:B(Q.closing_balance)})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-blue-600",children:[(0,a.jsx)("span",{children:"Statement Balance:"}),(0,a.jsx)("span",{children:B(Q.statement_balance)})]}),(0,a.jsx)(_.Separator,{}),(0,a.jsxs)("div",{className:`flex justify-between font-bold text-lg ${H(Q.discrepancy_amount)}`,children:[(0,a.jsx)("span",{children:"Discrepancy:"}),(0,a.jsx)("span",{children:B(Q.discrepancy_amount)})]})]})]}),0===Math.abs(Q.discrepancy_amount)&&(0,a.jsxs)(_.Alert,{children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)(_.AlertTitle,{children:"Perfect Balance"}),(0,a.jsx)(_.AlertDescription,{children:"The calculated closing balance matches the statement balance exactly. No discrepancy detected."})]})]})})]}),Q.notes&&(0,a.jsxs)(_.Card,{children:[(0,a.jsx)(_.CardHeader,{children:(0,a.jsx)(_.CardTitle,{children:"Notes"})}),(0,a.jsx)(_.CardContent,{children:(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:Q.notes})})]})]}),(0,a.jsx)(_.TabsContent,{value:"payments",className:"space-y-4",children:(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_.CardTitle,{children:"Reconciled Payments"}),(0,a.jsx)(_.CardDescription,{children:"Payments that have been matched to this reconciliation"})]}),"in_progress"===Q.status&&(0,a.jsxs)(_.Dialog,{open:$,onOpenChange:L,children:[(0,a.jsx)(_.DialogTrigger,{asChild:!0,children:(0,a.jsxs)(_.Button,{children:[(0,a.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Add Payment"]})}),(0,a.jsxs)(_.DialogContent,{children:[(0,a.jsxs)(_.DialogHeader,{children:[(0,a.jsx)(_.DialogTitle,{children:"Add Payment to Reconciliation"}),(0,a.jsx)(_.DialogDescription,{children:"Link a payment to this reconciliation session"})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"payment_id",children:"Payment ID"}),(0,a.jsx)(_.Input,{id:"payment_id",type:"number",placeholder:"Enter payment ID",value:E.payment_id||"",onChange:e=>O({...E,payment_id:parseInt(e.target.value)||0})})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"payment_notes",children:"Notes (Optional)"}),(0,a.jsx)(_.Textarea,{id:"payment_notes",placeholder:"Add any notes about this payment...",value:E.notes,onChange:e=>O({...E,notes:e.target.value}),rows:3})]})]}),(0,a.jsxs)(_.DialogFooter,{children:[(0,a.jsx)(_.Button,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),(0,a.jsxs)(_.Button,{onClick:()=>{if(!E.payment_id){u({title:"Please enter a valid payment ID",variant:"destructive"});return}K.mutate(E)},disabled:K.isPending,children:[K.isPending&&(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Payment"]})]})]})]})]}),(0,a.jsx)(_.CardContent,{children:0===Q.reconciled_items.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(N.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"No payments reconciled yet"}),"in_progress"===Q.status&&(0,a.jsx)("p",{className:"text-sm mt-2",children:'Click "Add Payment" to start reconciling'})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(_.Table,{children:[(0,a.jsx)(_.TableHeader,{children:(0,a.jsxs)(_.TableRow,{children:[(0,a.jsx)(_.TableHead,{children:"Payment ID"}),(0,a.jsx)(_.TableHead,{children:"Reference"}),(0,a.jsx)(_.TableHead,{className:"text-right",children:"Amount"}),(0,a.jsx)(_.TableHead,{children:"Reconciled At"}),(0,a.jsx)(_.TableHead,{children:"Reconciled By"}),(0,a.jsx)(_.TableHead,{children:"Notes"})]})}),(0,a.jsx)(_.TableBody,{children:Q.reconciled_items.map(e=>(0,a.jsxs)(_.TableRow,{children:[(0,a.jsxs)(_.TableCell,{className:"font-medium",children:["#",e.payment_id]}),(0,a.jsx)(_.TableCell,{children:(0,a.jsx)(_.Badge,{variant:"outline",children:e.payment_reference})}),(0,a.jsx)(_.TableCell,{className:"text-right font-mono font-medium",children:B(e.amount)}),(0,a.jsx)(_.TableCell,{children:(0,c.WU)(new Date(e.reconciled_at),"MMM dd, yyyy HH:mm")}),(0,a.jsx)(_.TableCell,{children:e.reconciled_by}),(0,a.jsx)(_.TableCell,{className:"text-sm text-muted-foreground",children:e.notes||"-"})]},e.payment_id))})]}),(0,a.jsx)(_.Separator,{className:"my-4"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Total: ",Q.reconciled_items.length," payment(s)"]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Amount"}),(0,a.jsx)("div",{className:"text-2xl font-bold font-mono",children:B(Y)})]})]})]})})]})}),(0,a.jsxs)(_.TabsContent,{value:"actions",className:"space-y-4",children:[(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{children:[(0,a.jsx)(_.CardTitle,{children:"Available Actions"}),(0,a.jsx)(_.CardDescription,{children:"Perform actions on this reconciliation session"})]}),(0,a.jsxs)(_.CardContent,{className:"space-y-4",children:["in_progress"===Q.status&&(0,a.jsxs)(_.Alert,{children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)(_.AlertTitle,{children:"Complete Reconciliation"}),(0,a.jsxs)(_.AlertDescription,{className:"mt-2 space-y-2",children:[(0,a.jsx)("p",{children:"This reconciliation is currently in progress. Once you have finished reconciling all payments, you can complete the session."}),(0,a.jsxs)(_.Button,{onClick:J,disabled:G.isPending,className:"mt-2",children:[G.isPending&&(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4 animate-spin"}),(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Complete Reconciliation"]})]})]}),"completed"===Q.status&&(0,a.jsxs)(_.Alert,{children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsx)(_.AlertTitle,{children:"Approve Reconciliation"}),(0,a.jsxs)(_.AlertDescription,{className:"mt-2 space-y-2",children:[(0,a.jsx)("p",{children:"This reconciliation has been completed and is ready for approval. Finance team members can approve this session to finalize it."}),(0,a.jsxs)(_.Button,{onClick:V,disabled:z.isPending,className:"mt-2",children:[z.isPending&&(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4 animate-spin"}),(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Approve Reconciliation"]})]})]}),"approved"===Q.status&&(0,a.jsxs)(_.Alert,{children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)(_.AlertTitle,{children:"Approved"}),(0,a.jsx)(_.AlertDescription,{children:"This reconciliation has been approved and is now finalized. No further actions are available."})]})]})]}),(0,a.jsxs)(_.Card,{children:[(0,a.jsxs)(_.CardHeader,{children:[(0,a.jsx)(_.CardTitle,{children:"Action History"}),(0,a.jsx)(_.CardDescription,{children:"Timeline of actions performed on this reconciliation"})]}),(0,a.jsx)(_.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(b.Z,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsx)("div",{className:"flex-1 w-px bg-border my-2"})]}),(0,a.jsxs)("div",{className:"flex-1 pb-4",children:[(0,a.jsx)("div",{className:"font-semibold",children:"Created"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,c.WU)(new Date(Q.created_at),"MMM dd, yyyy HH:mm")}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,d.Q)(new Date(Q.created_at))," ago"]})]})]}),Q.completed_at&&Q.completed_by&&(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(x.Z,{className:"h-4 w-4 text-blue-600"})}),Q.approved_at&&(0,a.jsx)("div",{className:"flex-1 w-px bg-border my-2"})]}),(0,a.jsxs)("div",{className:"flex-1 pb-4",children:[(0,a.jsx)("div",{className:"font-semibold",children:"Completed"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["By ",Q.completed_by]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,c.WU)(new Date(Q.completed_at),"MMM dd, yyyy HH:mm")}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,d.Q)(new Date(Q.completed_at))," ago"]})]})]}),Q.approved_at&&Q.approved_by&&(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex flex-col items-center",children:(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"h-4 w-4 text-green-600"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold",children:"Approved"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["By ",Q.approved_by]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,c.WU)(new Date(Q.approved_at),"MMM dd, yyyy HH:mm")}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,d.Q)(new Date(Q.approved_at))," ago"]})]})]})]})})]}),Q.statement_file_url&&(0,a.jsxs)(_.Card,{children:[(0,a.jsx)(_.CardHeader,{children:(0,a.jsx)(_.CardTitle,{children:"Statement File"})}),(0,a.jsx)(_.CardContent,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(N.Z,{className:"h-8 w-8 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Bank Statement"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:Q.statement_file_url})]})]}),(0,a.jsx)(_.Button,{variant:"outline",asChild:!0,children:(0,a.jsxs)("a",{href:Q.statement_file_url,target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Download"]})})]})})]})]})]})]})})}},55814:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/billing-revenue/reconciliation/[id]/page.tsx#default`)}};var s=require("../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(9561));module.exports=a})();