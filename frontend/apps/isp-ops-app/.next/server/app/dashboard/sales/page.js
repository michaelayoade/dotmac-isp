(()=>{var e={};e.id=6591,e.ids=[6591],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},53303:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o}),t(98265),t(13321),t(46366),t(96560);var r=t(23191),a=t(88716),l=t(37922),i=t.n(l),d=t(95231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);t.d(s,n);let o=["",{children:["dashboard",{children:["sales",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,98265)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/sales/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],c=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/sales/page.tsx"],x="/dashboard/sales/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/sales/page",pathname:"/dashboard/sales",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},93881:(e,s,t)=>{Promise.resolve().then(t.bind(t,68059))},68059:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>A});var r=t(10326),a=t(17577),l=t(44976),i=t(48324),d=t(17010),n=t(48723),o=t(48998),c=t(3240),x=t(30361),m=t(69669),u=t(41291),p=t(21405),h=t(57671),j=t(71821),g=t(17069),f=t(88307),v=t(48705),N=t(12714),C=t(93158),b=t(20892),y=t(90434),w=t(90960);function P(){let[e,s]=(0,a.useState)(""),[t,b]=(0,a.useState)("all"),P=(0,l.NL)(),{toast:A}=(0,n.useToast)(),_=(0,n.useConfirmDialog)(),{api:S}=(0,C.M)(),I=S.baseUrl||"",{data:T=[],isLoading:D,refetch:q}=(0,i.a)({queryKey:["sales-orders",t,e,I],queryFn:async()=>{let s=new URLSearchParams;"all"!==t&&s.append("status",t),e&&s.append("customer_email",e);let r=await fetch(`${I}/api/v1/orders?${s.toString()}`,{credentials:"include"});if(!r.ok)throw Error("Failed to fetch orders");return r.json()}}),{data:E}=(0,i.a)({queryKey:["sales-stats",I],queryFn:async()=>{let e=await fetch(`${I}/api/v1/orders/stats/summary`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch stats");return e.json()}}),F=(0,d.D)({mutationFn:async e=>{let s=await fetch(`${I}/api/v1/orders/${e}/process`,{method:"POST",credentials:"include"});if(!s.ok)throw Error("Failed to process order");return s.json()},onSuccess:()=>{P.invalidateQueries({queryKey:["sales-orders"]}),P.invalidateQueries({queryKey:["sales-stats"]}),A({title:"Order processing started"})},onError:e=>{A({title:"Failed to process order",description:e.message,variant:"destructive"})}}),L=(0,d.D)({mutationFn:async e=>{let s=await fetch(`${I}/api/v1/orders/${e}`,{method:"DELETE",credentials:"include"});if(!s.ok)throw Error("Failed to cancel order");return s.json()},onSuccess:()=>{P.invalidateQueries({queryKey:["sales-orders"]}),P.invalidateQueries({queryKey:["sales-stats"]}),A({title:"Order cancelled successfully"})},onError:e=>{A({title:"Failed to cancel order",description:e.message,variant:"destructive"})}}),Z=T.filter(s=>!e||s.customer_email.toLowerCase().includes(e.toLowerCase())||s.customer_name.toLowerCase().includes(e.toLowerCase())||s.order_number.toLowerCase().includes(e.toLowerCase())||s.company_name&&s.company_name.toLowerCase().includes(e.toLowerCase())),V=e=>{let s={DRAFT:{icon:o.Z,color:"bg-gray-100 text-gray-800",label:"Draft"},SUBMITTED:{icon:o.Z,color:"bg-blue-100 text-blue-800",label:"Submitted"},VALIDATING:{icon:c.Z,color:"bg-yellow-100 text-yellow-800",label:"Validating"},APPROVED:{icon:x.Z,color:"bg-green-100 text-green-800",label:"Approved"},PROVISIONING:{icon:c.Z,color:"bg-purple-100 text-purple-800",label:"Provisioning"},ACTIVATING:{icon:c.Z,color:"bg-indigo-100 text-indigo-800",label:"Activating"},ACTIVE:{icon:x.Z,color:"bg-green-100 text-green-800",label:"Active"},FAILED:{icon:m.Z,color:"bg-red-100 text-red-800",label:"Failed"},CANCELLED:{icon:u.Z,color:"bg-gray-100 text-gray-800",label:"Cancelled"}},t=s[e]||s.DRAFT,a=t.icon;return(0,r.jsxs)(n.Badge,{className:t.color,children:[(0,r.jsx)(a,{className:"h-3 w-3 mr-1"}),t.label]})};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Sales Orders"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage customer orders and service provisioning"})]}),(0,r.jsxs)(n.Button,{variant:"outline",onClick:()=>q(),children:[(0,r.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),E&&(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-6",children:[(0,r.jsxs)(n.Card,{children:[(0,r.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Total Orders"}),(0,r.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:E.total_orders}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),(0,r.jsxs)(n.Card,{children:[(0,r.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Active"}),(0,r.jsx)(x.Z,{className:"h-4 w-4 text-green-600"})]}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:E.active_orders}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Completed orders"})]})]}),(0,r.jsxs)(n.Card,{children:[(0,r.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Pending"}),(0,r.jsx)(o.Z,{className:"h-4 w-4 text-yellow-600"})]}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:E.pending_orders}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"In progress"})]})]}),(0,r.jsxs)(n.Card,{children:[(0,r.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Failed"}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-red-600"})]}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:E.failed_orders}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Need attention"})]})]}),(0,r.jsxs)(n.Card,{children:[(0,r.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Revenue"}),(0,r.jsx)(j.Z,{className:"h-4 w-4 text-green-600"})]}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["$",(E.total_revenue/1e3).toFixed(1),"k"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total"})]})]}),(0,r.jsxs)(n.Card,{children:[(0,r.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Success Rate"}),(0,r.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[E.success_rate.toFixed(1),"%"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Completion"})]})]})]}),(0,r.jsx)(n.Card,{children:(0,r.jsx)(n.CardContent,{className:"pt-6",children:(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(n.Input,{placeholder:"Search by email, name, or order number...",value:e,onChange:e=>s(e.target.value),className:"pl-10"})]}),(0,r.jsxs)(n.Select,{value:t,onValueChange:b,children:[(0,r.jsx)(n.SelectTrigger,{children:(0,r.jsx)(n.SelectValue,{placeholder:"All Status"})}),(0,r.jsxs)(n.SelectContent,{children:[(0,r.jsx)(n.SelectItem,{value:"all",children:"All Status"}),(0,r.jsx)(n.SelectItem,{value:"DRAFT",children:"Draft"}),(0,r.jsx)(n.SelectItem,{value:"SUBMITTED",children:"Submitted"}),(0,r.jsx)(n.SelectItem,{value:"VALIDATING",children:"Validating"}),(0,r.jsx)(n.SelectItem,{value:"APPROVED",children:"Approved"}),(0,r.jsx)(n.SelectItem,{value:"PROVISIONING",children:"Provisioning"}),(0,r.jsx)(n.SelectItem,{value:"ACTIVATING",children:"Activating"}),(0,r.jsx)(n.SelectItem,{value:"ACTIVE",children:"Active"}),(0,r.jsx)(n.SelectItem,{value:"FAILED",children:"Failed"}),(0,r.jsx)(n.SelectItem,{value:"CANCELLED",children:"Cancelled"})]})]})]})})}),(0,r.jsx)("div",{className:"grid gap-4",children:D?(0,r.jsx)(n.Card,{children:(0,r.jsx)(n.CardContent,{className:"py-8 text-center text-muted-foreground",children:"Loading orders..."})}):0===Z.length?(0,r.jsx)(n.Card,{children:(0,r.jsx)(n.CardContent,{className:"py-8 text-center text-muted-foreground",children:e?"No orders match your search":"No orders found"})}):Z.map(e=>(0,r.jsxs)(n.Card,{className:"hover:border-primary transition-colors",children:[(0,r.jsx)(n.CardHeader,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(v.Z,{className:"h-8 w-8 text-primary"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.CardTitle,{className:"text-lg",children:(0,r.jsx)(y.default,{href:`/dashboard/sales/${e.id}`,className:"hover:underline",children:e.order_number})}),(0,r.jsxs)(n.CardDescription,{children:[e.customer_name," (",e.customer_email,")"]}),e.company_name&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e.company_name})]})]}),V(e.status)]})}),(0,r.jsxs)(n.CardContent,{children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Region"}),(0,r.jsx)("p",{className:"font-medium",children:e.deployment_region||"N/A"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Billing Cycle"}),(0,r.jsx)("p",{className:"font-medium capitalize",children:e.billing_cycle||"N/A"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Source"}),(0,r.jsx)("p",{className:"font-medium capitalize",children:e.source||"N/A"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,r.jsx)("p",{className:"font-medium",children:(0,w.Q)(new Date(e.created_at),{addSuffix:!0})})]})]}),e.status_message&&(0,r.jsx)("div",{className:"mt-3 p-3 bg-accent rounded-lg",children:(0,r.jsx)("p",{className:"text-sm",children:e.status_message})}),(0,r.jsxs)("div",{className:"flex gap-2 mt-4 pt-4 border-t",children:[(0,r.jsx)(n.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsxs)(y.default,{href:`/dashboard/sales/${e.id}`,children:[(0,r.jsx)(N.Z,{className:"h-3 w-3 mr-1"}),"View Details"]})}),("APPROVED"===e.status||"FAILED"===e.status)&&(0,r.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:async()=>{await _({title:"Process order",description:`Process order ${e.order_number}?`,confirmText:"Process"})&&F.mutate(e.id)},disabled:F.isPending,children:[(0,r.jsx)(c.Z,{className:"h-3 w-3 mr-1"}),"Process"]}),("DRAFT"===e.status||"SUBMITTED"===e.status)&&(0,r.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:async()=>{await _({title:"Cancel order",description:`Cancel order ${e.order_number}?`,confirmText:"Cancel order",variant:"destructive"})&&L.mutate(e.id)},disabled:L.isPending,className:"text-destructive hover:text-destructive",children:[(0,r.jsx)(m.Z,{className:"h-3 w-3 mr-1"}),"Cancel"]})]})]})]},e.id))})]})}function A(){return(0,r.jsx)(b.eu,{permission:"order.read",children:(0,r.jsx)(P,{})})}},98265:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/sales/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2793,1009,6226,657,6032,4218],()=>t(53303));module.exports=r})();