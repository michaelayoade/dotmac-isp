(()=>{var e={};e.id=1482,e.ids=[1482],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},19794:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>o}),a(98791),a(13321),a(46366),a(96560);var s=a(23191),i=a(88716),r=a(37922),n=a.n(r),l=a(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(t,c);let o=["",{children:["dashboard",{children:["network",{children:["fiber",{children:["map",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,98791)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/network/fiber/map/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,13321)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,46366)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,96560)),"/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/not-found.tsx"]}],d=["/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/network/fiber/map/page.tsx"],u="/dashboard/network/fiber/map/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/network/fiber/map/page",pathname:"/dashboard/network/fiber/map",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},21815:(e,t,a)=>{Promise.resolve().then(a.bind(a,4344))},4344:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s=a(10326),i=a(17577),r=a(48723),n=a(94935),l=a(41137),c=a(31540),o=a(95858),d=a(77636),u=a(49163),p=a(47546),m=a(41291);!function(){var e=Error("Cannot find module '@dotmac/primitives/maps'");throw e.code="MODULE_NOT_FOUND",e}();let x=({cables:e=[],splicePoints:t=[],distributionPoints:a=[],serviceAreas:r=[],jobs:n=[],technicians:l=[],center:c,zoom:o=13,height:d=600,showCables:u=!0,showSplicePoints:p=!0,showDistributionPoints:m=!0,showServiceAreas:x=!0,showJobs:h=!0,showTechnicians:b=!0,showLegend:g=!0,onCableClick:v,onSplicePointClick:j,onDistributionPointClick:y,onServiceAreaClick:f,onJobClick:N,onTechnicianClick:C,title:_,className:w,loading:k=!1,error:S=null})=>{let P=(0,i.useMemo)(()=>u?e.map(e=>({id:e.id,name:e.cable_name,waypoints:e.path.coordinates,type:"under_construction"===e.status?"installation":"maintenance"===e.status?"maintenance":"installation",status:"active"===e.status?"completed":"under_construction"===e.status?"in_progress":"planned"})):[],[e,u]),T=(0,i.useMemo)(()=>p?t.map(e=>({id:e.id,position:e.coordinates,type:"fiber",status:"operational"===e.status?"active":"fault"===e.status?"error":"maintenance",title:e.name,description:`${e.type} • ${e.splice_count}/${e.capacity} splices`,metadata:e,onClick:()=>j?.(e)})):[],[t,p,j]),D=(0,i.useMemo)(()=>m?a.map(e=>({id:e.id,position:e.coordinates,type:"tower",status:"active",title:e.name,description:`${e.type.toUpperCase()} • ${e.ports_used}/${e.capacity} ports`,metadata:e,onClick:()=>y?.(e)})):[],[a,m,y]),F=(0,i.useMemo)(()=>h?n.map(e=>{let t="completed"===e.status?"active":"running"===e.status?"maintenance":"failed"===e.status?"error":"inactive",a=e.parameters?.priority||"normal",s=e.parameters?.ticket_number||"N/A",i=e.status.replace("_"," ").toUpperCase();return{id:e.id,position:{lat:e.location_lat,lng:e.location_lng},type:"technician",status:t,title:e.title,description:`Status: ${i} • Priority: ${a} • Ticket: ${s}`,metadata:e,onClick:()=>N?.(e)}}):[],[n,h,N]),E=(0,i.useMemo)(()=>b?l.filter(e=>null!==e.latitude&&null!==e.longitude).map(e=>{let t="available"===e.status?"active":"on_job"===e.status?"maintenance":(e.status,"inactive"),a=e.status.replace("_"," ").toUpperCase(),s=e.last_update?new Date(e.last_update).toLocaleTimeString():"Never";return{id:e.technician_id,position:{lat:e.latitude,lng:e.longitude},type:"technician",status:t,title:e.technician_name||"Technician",description:`Status: ${a} • Last Update: ${s}`,metadata:e,onClick:()=>C?.(e)}}):[],[l,b,C]),$=(0,i.useMemo)(()=>[...T,...D,...F,...E],[T,D,F,E]),q=(0,i.useMemo)(()=>x?(r??[]).map(e=>{let t=e.fiber_availability?"fiber":"wireless",a="covered"===e.coverage_status?"full":"partial"===e.coverage_status?"limited":"planned",s={id:e.id,name:e.name,type:t,polygon:e.boundary.coordinates,serviceLevel:a,maxSpeed:1e3,coverage:"covered"===e.coverage_status?100:"partial"===e.coverage_status?50:0,color:"fiber"===t?"#3B82F6":"#8B5CF6"};return"number"==typeof e.active_customers&&(s.customers=e.active_customers),s}):[],[r,x]),U={center:(0,i.useMemo)(()=>{if(c)return c;if(n.length>0&&n[0]?.location_lat&&n[0]?.location_lng)return{lat:n[0].location_lat,lng:n[0].location_lng};if(t.length>0&&t[0]?.coordinates)return t[0].coordinates;if(a.length>0&&a[0]?.coordinates)return a[0].coordinates;if(e.length>0){let t=e[0];if(t?.path?.coordinates&&t.path.coordinates.length>0)return t.path.coordinates[0]}return{lat:6.5244,lng:3.3792}},[c,e,t,a,n]),zoom:o,height:d,markers:$,serviceAreas:q,routes:P,variant:"admin",showLegend:g,showControls:!0,loading:k,onMarkerClick:e=>{if(e.metadata){let t=e.metadata;void 0!==t.splice_count?j?.(t):void 0!==t.job_type?N?.(t):void 0!==t.technician_id&&void 0!==t.status?C?.(t):void 0!==t.capacity&&y?.(t)}},onAreaClick:e=>{let t=r.find(t=>t.id===e.id);t&&f?.(t)}};return _&&(U.title=_),w&&(U.className=w),S&&(U.error=S),(0,s.jsx)(Object(function(){var e=Error("Cannot find module '@dotmac/primitives/maps'");throw e.code="MODULE_NOT_FOUND",e}()),{...U})};var h=a(59341),b=a(48324),g=a(16704);function v(){let[e,t]=(0,i.useState)(null),[a,v]=(0,i.useState)(null),[j,y]=(0,i.useState)(null),[f,N]=(0,i.useState)(null),[C,_]=(0,i.useState)(null),[w,k]=(0,i.useState)(!0),[S,P]=(0,i.useState)({cables:!0,splicePoints:!0,distributionPoints:!0,serviceAreas:!0,jobs:!0,technicians:!0}),{cables:T,isLoading:D}=function(e={}){let{toast:t}=(0,r.useToast)(),[a,s]=(0,i.useState)([]),[n,l]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null),d=(0,i.useCallback)(async()=>{l(!0),o(null);try{let t=new URLSearchParams;e.status&&t.append("status",e.status),e.cable_type&&t.append("cable_type",e.cable_type),e.limit&&t.append("limit",e.limit.toString());let a=await h.x1.get(`/fibermaps/cables?${t.toString()}`);return s(a.data.cables),a.data.cables}catch(a){let e=Error(a.response?.data?.detail||"Failed to fetch fiber cables");return o(e),t({title:"Error",description:e.message,variant:"destructive"}),[]}finally{l(!1)}},[e.status,e.cable_type,e.limit,t]),u=(0,i.useCallback)(async e=>{try{let a=await h.x1.post("/fibermaps/cables",e);return t({title:"Cable Created",description:`Fiber cable ${a.data.cable_name} has been created successfully`}),await d(),a.data}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to create fiber cable",variant:"destructive"}),null}},[d,t]),p=(0,i.useCallback)(async(e,a)=>{try{let s=await h.x1.patch(`/fibermaps/cables/${e}`,a);return t({title:"Cable Updated",description:"Fiber cable has been updated successfully"}),await d(),s.data}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to update fiber cable",variant:"destructive"}),null}},[d,t]),m=(0,i.useCallback)(async e=>{try{return await h.x1.delete(`/fibermaps/cables/${e}`),t({title:"Cable Deleted",description:"Fiber cable has been deleted successfully"}),await d(),!0}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to delete fiber cable",variant:"destructive"}),!1}},[d,t]);return{cables:a,isLoading:n,error:c,refetch:d,createCable:u,updateCable:p,deleteCable:m}}(),{splicePoints:F,isLoading:E}=function(e={}){let{toast:t}=(0,r.useToast)(),[a,s]=(0,i.useState)([]),[n,l]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null),d=(0,i.useCallback)(async()=>{l(!0),o(null);try{let t=new URLSearchParams;e.cable_id&&t.append("cable_id",e.cable_id),e.limit&&t.append("limit",e.limit.toString());let a=await h.x1.get(`/fibermaps/splice-points?${t.toString()}`);return s(a.data.splice_points),a.data.splice_points}catch(a){let e=Error(a.response?.data?.detail||"Failed to fetch splice points");return o(e),t({title:"Error",description:e.message,variant:"destructive"}),[]}finally{l(!1)}},[e.cable_id,e.limit,t]),u=(0,i.useCallback)(async e=>{try{let a=await h.x1.post("/fibermaps/splice-points",e);return t({title:"Splice Point Created",description:`Splice point ${a.data.name} has been created successfully`}),await d(),a.data}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to create splice point",variant:"destructive"}),null}},[d,t]),p=(0,i.useCallback)(async(e,a)=>{try{let s=await h.x1.patch(`/fibermaps/splice-points/${e}`,a);return t({title:"Splice Point Updated",description:"Splice point has been updated successfully"}),await d(),s.data}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to update splice point",variant:"destructive"}),null}},[d,t]),m=(0,i.useCallback)(async e=>{try{return await h.x1.delete(`/fibermaps/splice-points/${e}`),t({title:"Splice Point Deleted",description:"Splice point has been deleted successfully"}),await d(),!0}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to delete splice point",variant:"destructive"}),!1}},[d,t]);return{splicePoints:a,isLoading:n,error:c,refetch:d,createSplicePoint:u,updateSplicePoint:p,deleteSplicePoint:m}}(),{distributionPoints:$,isLoading:q}=function(e={}){let{toast:t}=(0,r.useToast)(),[a,s]=(0,i.useState)([]),[n,l]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null),d=(0,i.useCallback)(async()=>{l(!0),o(null);try{let t=new URLSearchParams;e.type&&t.append("type",e.type),e.limit&&t.append("limit",e.limit.toString());let a=await h.x1.get(`/fibermaps/distribution-points?${t.toString()}`);return s(a.data.distribution_points),a.data.distribution_points}catch(a){let e=Error(a.response?.data?.detail||"Failed to fetch distribution points");return o(e),t({title:"Error",description:e.message,variant:"destructive"}),[]}finally{l(!1)}},[e.type,e.limit,t]),u=(0,i.useCallback)(async e=>{try{let a=await h.x1.post("/fibermaps/distribution-points",e);return t({title:"Distribution Point Created",description:`Distribution point ${a.data.name} has been created successfully`}),await d(),a.data}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to create distribution point",variant:"destructive"}),null}},[d,t]),p=(0,i.useCallback)(async(e,a)=>{try{let s=await h.x1.patch(`/fibermaps/distribution-points/${e}`,a);return t({title:"Distribution Point Updated",description:"Distribution point has been updated successfully"}),await d(),s.data}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to update distribution point",variant:"destructive"}),null}},[d,t]),m=(0,i.useCallback)(async e=>{try{return await h.x1.delete(`/fibermaps/distribution-points/${e}`),t({title:"Distribution Point Deleted",description:"Distribution point has been deleted successfully"}),await d(),!0}catch(e){return t({title:"Error",description:e.response?.data?.detail||"Failed to delete distribution point",variant:"destructive"}),!1}},[d,t]);return{distributionPoints:a,isLoading:n,error:c,refetch:d,createDistributionPoint:u,updateDistributionPoint:p,deleteDistributionPoint:m}}(),{serviceAreas:U,isLoading:L}=function(e={}){let{toast:t}=(0,r.useToast)(),[a,s]=(0,i.useState)([]),[n,l]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null);return{serviceAreas:a,isLoading:n,error:c,refetch:(0,i.useCallback)(async()=>{l(!0),o(null);try{let t=new URLSearchParams;e.coverage_status&&t.append("coverage_status",e.coverage_status),e.limit&&t.append("limit",e.limit.toString());let a=await h.x1.get(`/fibermaps/service-areas?${t.toString()}`);return s(a.data.service_areas),a.data.service_areas}catch(a){let e=Error(a.response?.data?.detail||"Failed to fetch service areas");return o(e),t({title:"Error",description:e.message,variant:"destructive"}),[]}finally{l(!1)}},[e.coverage_status,e.limit,t])}}(),{data:A,isLoading:B}=function(e={}){let{status:t}=e;return(0,b.a)({queryKey:["field-installation-jobs",t],queryFn:async()=>{let e=new URLSearchParams;e.append("job_type","field_installation"),t&&e.append("status",t),e.append("limit","100");let a=await h.x1.get(`/jobs?${e.toString()}`),s=(0,g.uN)(a),i=s.jobs.filter(e=>"field_installation"===e.job_type&&null!=e.location_lat&&null!=e.location_lng);return{...s,jobs:i}},staleTime:5e3,refetchInterval:1e4})}(),{technicians:W,isConnected:M,isConnecting:I,error:R}=function(e={}){let{enabled:t=!0,onConnect:a,onDisconnect:s,onError:r,autoReconnect:n=!0,reconnectInterval:l=5e3,enableNotifications:c=!0}=e,{handleGeofenceEvent:o}=function(e=!0){let t=function(){let[e,t]=(0,i.useState)("default"),[a,s]=(0,i.useState)(()=>{let e=localStorage.getItem("browser_notifications_enabled");return null===e||"true"===e}),r="Notification"in window,n=(0,i.useCallback)(async()=>{if(!r)return"denied";if("granted"===e)return"granted";try{let e=await Notification.requestPermission();return t(e),e}catch(e){return console.error("Failed to request notification permission:",e),"denied"}},[r,e]),l=(0,i.useCallback)(async t=>{if(!a){console.log("[Notifications] Disabled by user");return}if(!r){console.warn("[Notifications] Not supported in this browser");return}if("granted"!==e){console.warn("[Notifications] Permission not granted");return}try{let e={body:t.body,icon:t.icon||"/favicon.ico",requireInteraction:t.requireInteraction||!1,silent:t.silent||!1,data:t.data};t.tag&&(e.tag=t.tag);let a=new Notification(t.title,e);t.onClick&&(a.onclick=()=>{window.focus(),t.onClick?.(),a.close()}),t.requireInteraction||setTimeout(()=>{a.close()},1e4),console.log("[Notifications] Shown:",t.title)}catch(e){console.error("[Notifications] Failed to show:",e)}},[r,e,a]);return{isSupported:r,permission:e,requestPermission:n,showNotification:l,isEnabled:a,setIsEnabled:s}}(),a=(0,i.useCallback)(async a=>{if(!e)return;let s="enter"===a.event_type,i=`${a.technician_name} ${s?"arrived at":"left"} job site
${a.message}`;await t.showNotification({title:s?"\uD83D\uDE80 Technician Arrived":"✅ Technician Departed",body:i,tag:`geofence-${a.job_id}`,requireInteraction:s,data:{jobId:a.job_id,type:"geofence"}})},[e,t]);return{...t,handleGeofenceEvent:a}}(c),[d,u]=(0,i.useState)([]),[p,m]=(0,i.useState)(!1),[x,h]=(0,i.useState)(!1),[b,g]=(0,i.useState)(null),v=(0,i.useRef)(null),j=(0,i.useRef)(null),y=(0,i.useRef)(null),f=(0,i.useCallback)(()=>{let e="https:"===window.location.protocol?"wss:":"ws:",t=(process.env.NEXT_PUBLIC_API_URL||`${window.location.host}`).replace(/^https?:\/\//,"");return`${e}//${t}/api/v1/field-service/ws/technician-locations`},[]),N=(0,i.useCallback)(()=>{if(t&&v.current?.readyState!==WebSocket.OPEN){h(!0),g(null);try{let e=f(),t=new WebSocket(e);t.onopen=()=>{console.log("[WebSocket] Connected to technician locations"),m(!0),h(!1),g(null),a?.(),y.current=setInterval(()=>{t.readyState===WebSocket.OPEN&&t.send("ping")},3e4)},t.onmessage=e=>{try{let t=JSON.parse(e.data);switch(t.type){case"connected":console.log("[WebSocket] Connection confirmed:",t.connection_id);break;case"initial_state":Array.isArray(t.data)&&(u(t.data),console.log("[WebSocket] Received initial state:",t.data.length,"technicians"));break;case"location_update":if(t.data&&!Array.isArray(t.data)){let e=t.data;u(t=>{let a=t.findIndex(t=>t.technician_id===e.technician_id);if(!(a>=0))return[...t,e];{let s=[...t];return s[a]=e,s}}),console.log("[WebSocket] Location update:",e.technician_name),e.geofence_message&&console.log("[WebSocket] Geofence:",e.geofence_message)}break;case"geofence_event":t.data&&(console.log("[WebSocket] Geofence event:",t.data),c&&o({technician_name:t.data.technician_name,job_id:t.data.job_id,event_type:t.data.event_type,message:t.data.message}));break;case"pong":break;default:console.warn("[WebSocket] Unknown message type:",t.type)}}catch(e){console.error("[WebSocket] Failed to parse message:",e)}},t.onerror=e=>{console.error("[WebSocket] Error:",e),g("WebSocket connection error"),r?.(e)},t.onclose=e=>{console.log("[WebSocket] Disconnected:",e.code,e.reason),m(!1),h(!1),s?.(),y.current&&(clearInterval(y.current),y.current=null),n&&1e3!==e.code&&(console.log(`[WebSocket] Reconnecting in ${l}ms...`),j.current=setTimeout(()=>{N()},l))},v.current=t}catch(e){console.error("[WebSocket] Failed to connect:",e),h(!1),g(e instanceof Error?e.message:"Failed to connect")}}},[n,c,t,f,o,a,s,r,l]),C=(0,i.useCallback)(()=>{j.current&&(clearTimeout(j.current),j.current=null),y.current&&(clearInterval(y.current),y.current=null),v.current&&(v.current.close(1e3,"Component unmounted"),v.current=null),m(!1),h(!1)},[]);return{technicians:d,isConnected:p,isConnecting:x,error:b,reconnect:(0,i.useCallback)(()=>{C(),setTimeout(()=>{N()},100)},[N,C])}}({enabled:w,autoReconnect:!0}),{data:O,isLoading:J}=(0,b.a)({queryKey:["technician-locations","active"],queryFn:async()=>{let e=await h.x1.get("/field-service/technicians/locations/active");return(0,g.uN)(e)},staleTime:1e4,refetchInterval:15e3,refetchOnWindowFocus:!0}),Z=w&&M?W:O,z=w?I:J,G=T||[],H=F||[],K=$||[],X=U||[],V=A?.jobs||[],Q=Z||[],Y={totalCables:G.length,activeCables:G.filter(e=>"active"===e.status).length,totalFibers:G.reduce((e,t)=>e+(t.fiber_count||0),0),availableFibers:G.reduce((e,t)=>e+(t.available_fibers||0),0),splicePoints:H.length,distributionPoints:K.length,totalCoverage:X.length,activeJobs:V.filter(e=>["pending","assigned","running"].includes(e.status)).length,completedJobs:V.filter(e=>"completed"===e.status).length,activeTechnicians:Q.filter(e=>"available"===e.status||"on_job"===e.status).length,totalTechnicians:Q.length};return(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[(0,s.jsx)(n.Z,{className:"h-8 w-8 text-blue-600"}),"Fiber Network Map"]}),w&&(0,s.jsx)(r.Badge,{variant:M?"default":I?"secondary":"destructive",className:"ml-2",children:M?"\uD83D\uDFE2 Live":I?"\uD83D\uDFE1 Connecting...":"\uD83D\uDD34 Disconnected"})]}),(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["Interactive visualization of fiber infrastructure",w&&M&&(0,s.jsx)("span",{className:"ml-2 text-green-600 text-sm",children:"• Real-time updates active"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(r.Button,{variant:w?"default":"outline",size:"sm",onClick:()=>k(!w),title:w?"Switch to polling mode":"Switch to real-time WebSocket mode",children:w?"\uD83D\uDD04 Real-time":"⏱️ Polling"}),(0,s.jsxs)(r.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4 mr-2"}),"Filters"]}),(0,s.jsxs)(r.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-11 gap-4",children:[(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:Y.totalCables}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Total Cables"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:Y.activeCables}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Active Cables"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Y.totalFibers}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Total Fibers"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-indigo-600",children:Y.availableFibers}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Available"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:Y.splicePoints}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Splice Points"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:Y.distributionPoints}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Distribution"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-teal-600",children:Y.totalCoverage}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Coverage Areas"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:Y.activeJobs}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Active Jobs"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-emerald-600",children:Y.completedJobs}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Completed"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-500",children:Y.activeTechnicians}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Active Techs"})]})}),(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:Y.totalTechnicians}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Total Techs"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Z,{className:"h-5 w-5"}),"Network Map"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(r.Button,{variant:S.cables?"default":"outline",size:"sm",onClick:()=>P(e=>({...e,cables:!e.cables})),children:[(0,s.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Cables"]}),(0,s.jsxs)(r.Button,{variant:S.splicePoints?"default":"outline",size:"sm",onClick:()=>P(e=>({...e,splicePoints:!e.splicePoints})),children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Splices"]}),(0,s.jsxs)(r.Button,{variant:S.distributionPoints?"default":"outline",size:"sm",onClick:()=>P(e=>({...e,distributionPoints:!e.distributionPoints})),children:[(0,s.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),"Distribution"]}),(0,s.jsxs)(r.Button,{variant:S.jobs?"default":"outline",size:"sm",onClick:()=>P(e=>({...e,jobs:!e.jobs})),children:[(0,s.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Jobs"]}),(0,s.jsxs)(r.Button,{variant:S.technicians?"default":"outline",size:"sm",onClick:()=>P(e=>({...e,technicians:!e.technicians})),children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Technicians"]})]})]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)(x,{cables:G,splicePoints:H,distributionPoints:K,serviceAreas:X,jobs:V,technicians:Q,showCables:S.cables,showSplicePoints:S.splicePoints,showDistributionPoints:S.distributionPoints,showServiceAreas:S.serviceAreas,showJobs:S.jobs,showTechnicians:S.technicians,height:700,onCableClick:t,onSplicePointClick:v,onDistributionPointClick:y,onJobClick:N,onTechnicianClick:_,loading:D||E||q||L||B||z,error:null})})]})}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)(r.Card,{className:"sticky top-4",children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"Selection Details"})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsxs)(r.Tabs,{defaultValue:"overview",className:"w-full",children:[(0,s.jsxs)(r.TabsList,{className:"grid w-full grid-cols-4",children:[(0,s.jsx)(r.TabsTrigger,{value:"overview",children:"Overview"}),(0,s.jsx)(r.TabsTrigger,{value:"cables",children:"Cables"}),(0,s.jsx)(r.TabsTrigger,{value:"points",children:"Points"}),(0,s.jsx)(r.TabsTrigger,{value:"jobs",children:"Jobs"})]}),(0,s.jsx)(r.TabsContent,{value:"overview",className:"space-y-4",children:e||a||j||f||C?(0,s.jsxs)("div",{className:"space-y-4",children:[e&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Selected Cable"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Name:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:e.cable_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Type:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"outline",children:e.cable_type})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"active"===e.status?"default":"secondary",children:e.status})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Fibers:"}),(0,s.jsxs)("span",{className:"ml-2 font-medium",children:[e.available_fibers,"/",e.fiber_count," ","available"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Length:"}),(0,s.jsxs)("span",{className:"ml-2 font-medium",children:[(e.length_meters/1e3).toFixed(2)," km"]})]})]})]}),a&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Selected Splice Point"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Name:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:a.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Type:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"outline",children:a.type})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"operational"===a.status?"default":"destructive",children:a.status})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Capacity:"}),(0,s.jsxs)("span",{className:"ml-2 font-medium",children:[a.splice_count,"/",a.capacity]})]})]})]}),j&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Selected Distribution Point"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Name:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:j.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Type:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"outline",children:j.type.toUpperCase()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Capacity:"}),(0,s.jsxs)("span",{className:"ml-2 font-medium",children:[j.ports_used,"/",j.capacity," ports"]})]})]})]}),f&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Selected Job"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Title:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:f.title})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"completed"===f.status?"default":"failed"===f.status?"destructive":"running"===f.status?"default":"secondary",children:f.status.toUpperCase()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Priority:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"outline",children:f.parameters?.priority||"normal"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Address:"}),(0,s.jsx)("span",{className:"ml-2 font-medium text-xs",children:f.service_address})]}),f.parameters?.ticket_number&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Ticket:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:f.parameters.ticket_number})]}),f.assigned_to&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Assigned:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"outline",children:"Technician"})]}),f.scheduled_start&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Scheduled:"}),(0,s.jsx)("span",{className:"ml-2 font-medium text-xs",children:new Date(f.scheduled_start).toLocaleString()})]})]})]}),C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Selected Technician"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Name:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:C.technician_name||"Technician"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,s.jsx)(r.Badge,{className:"ml-2",variant:"available"===C.status?"default":"on_job"===C.status?"default":"on_break"===C.status?"secondary":"outline",children:C.status.replace("_"," ").toUpperCase()})]}),C.latitude&&C.longitude&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Location:"}),(0,s.jsxs)("span",{className:"ml-2 font-medium text-xs",children:[C.latitude.toFixed(4),","," ",C.longitude.toFixed(4)]})]}),C.last_update&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Last Update:"}),(0,s.jsx)("span",{className:"ml-2 font-medium text-xs",children:new Date(C.last_update).toLocaleString()})]}),(0,s.jsx)("div",{className:"pt-2 text-xs text-gray-500",children:"Live location updates every 15 seconds"})]})]})]}):(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(m.Z,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"Select an item on the map to view details"})]})}),(0,s.jsx)(r.TabsContent,{value:"cables",className:"space-y-2",children:(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2",children:G.map(e=>(0,s.jsxs)("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:()=>t(e),children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:e.cable_name||e.name}),(0,s.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[e.cable_type||"Unknown"," • ",e.status]})]},e.id))})}),(0,s.jsx)(r.TabsContent,{value:"points",className:"space-y-2",children:(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2",children:H.map(e=>(0,s.jsxs)("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:()=>v(e),children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[e.type||"Unknown"," • ",e.status]})]},e.id))})}),(0,s.jsx)(r.TabsContent,{value:"jobs",className:"space-y-2",children:(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2",children:0===V.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(p.Z,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"No field installation jobs"})]}):V.map(e=>(0,s.jsxs)("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:()=>N(e),children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)(r.Badge,{variant:"completed"===e.status?"default":"failed"===e.status?"destructive":"outline",className:"text-xs",children:e.status}),(0,s.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.parameters?.ticket_number||e.id.slice(0,8)})]}),e.service_address&&(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1 truncate",children:e.service_address})]},e.id))})})]})})]})})]})]})}a(47101)},98791:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(68570).createProxy)(String.raw`/Users/michaelayoade/Downloads/Projects/dotmac-ftth-ops/split-staging/dotmac-isp/frontend/apps/isp-ops-app/app/dashboard/network/fiber/map/page.tsx#default`)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[2793,1009,6226,657,6032,4218],()=>a(19794));module.exports=s})();